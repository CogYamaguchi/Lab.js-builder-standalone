(this["webpackJsonplab.js.builder"]=this["webpackJsonplab.js.builder"]||[]).push([[6],{837:function(e,t,a){"use strict";t.a={root:"rgb(33, 37, 41)",outline:"rgba(0, 0, 0, 0.125)",buttonBorder:"#ced4da",gray:"#f8f9fa",active:"#0275d7",muted:"#6c757d"}},912:function(e,t,a){"use strict";var n=a(0),i=a.n(n),r=a(92),o=a.n(r),l=a(800),s=a(28),c=a(837);const m=(e,t)=>0===t?"".concat(e,"ms"):"".concat(e/1e3,"s"),d=({gridWidth:e=100},{range:t,height:a,toX:n,zoom:r})=>{return i.a.createElement(l.Layer,null,Object(s.range)((o=t.min-e*Math.pow(10,r),d=r+2,Math.floor(o/Math.pow(10,d))*Math.pow(10,d)),t.max+e,e*Math.pow(10,r)).map((t,o)=>i.a.createElement(l.Group,{key:"t-".concat(t)},i.a.createElement(l.Rect,{x:n(t)+.5,y:0,width:e,height:a,fill:o%2===0?"white":c.a.gray}),i.a.createElement(l.Text,{text:m(t,r),x:n(t)+6,y:a-15,fontFamily:"Fira Sans",fontSize:10,fill:c.a.muted,align:"left",verticalAlign:"bottom"}),i.a.createElement(l.Line,{x:n(t)+.5,y:0,stroke:c.a.gray,strokeWidth:1,points:[0,0,0,a]}))));var o,d};d.contextTypes={range:o.a.object,zoom:o.a.number,toX:o.a.func,height:o.a.number,padding:o.a.number},t.a=d},913:function(e,t,a){"use strict";var n=a(119),i=a(26),r=a(0),o=a.n(r),l=a(38),s=a(92),c=a.n(s),m=a(749),d=a(24),h=a(757),u=a(914),p=a(785),g=a(774),E=a(775),y=a(319),f=a(756),b=a(754),v=a(755),x=a(325),w=a(786),C=a(768),I=a(736),k=a(28),j=a(30),O=a(328),T=a(35),D=a(265);const S={gain:"",pan:"",rampUp:"",rampDown:""},z=({add:e,duplicateCurrent:t,deleteCurrent:a,activeItem:n},{zoom:r,setZoom:l})=>o.a.createElement("div",{style:{position:"absolute",right:"0"}},o.a.createElement(h.a,null,o.a.createElement(u.a,{direction:"up"},o.a.createElement(p.a,{outline:!0,color:"secondary"},o.a.createElement(j.a,{icon:"plus",fixedWidth:!0,style:{position:"relative",top:"0.5px"}})),o.a.createElement(g.a,null,o.a.createElement(E.a,{header:!0},"Audio"),o.a.createElement(E.a,{onClick:()=>e(Object(i.a)({type:"sound",payload:{src:"",loop:!1}},S))},"Sound file"),o.a.createElement(E.a,{onClick:()=>e(Object(i.a)({type:"oscillator",payload:{type:"sine",frequency:"",detune:""}},S))},"Oscillator"),o.a.createElement(E.a,{divider:!0}),o.a.createElement(E.a,{header:!0},"From selected"),o.a.createElement(E.a,{onClick:()=>t()},"Duplicate"))),o.a.createElement(y.a,{outline:!0,color:"secondary",disabled:void 0===n,onClick:a},o.a.createElement(j.a,{icon:"trash",fixedWidth:!0,style:{position:"relative",top:"0.5px"}}))),o.a.createElement(h.a,{className:"ml-2"},o.a.createElement(y.a,{outline:!0,color:"secondary",disabled:0===r,onClick:()=>l(0)},o.a.createElement(j.a,{icon:"search-plus",fixedWidth:!0,style:{position:"relative",top:"0.5px"}})),o.a.createElement(y.a,{outline:!0,color:"secondary",disabled:1===r,onClick:()=>l(1)},o.a.createElement(j.a,{icon:"search-minus",fixedWidth:!0,style:{position:"relative",top:"0.5px"}}))));z.contextTypes={zoom:c.a.number,setZoom:c.a.func};const M=({firstComponentId:e},{id:t})=>e===t?o.a.createElement(f.a,{color:"warning"},o.a.createElement("h3",{className:"h6 mt-2"},"Adding audio to the first component in a study"),"Many browsers don't allow a website to play media until a user has interacted with the page. To make sure that you participants can hear the sounds you're adding, please ask for user input on your study's first screen."):null;M.contextTypes={id:c.a.oneOfType([c.a.string,c.a.number])};const P=Object(l.c)(e=>({firstComponentId:e.components.root.children[0]}))(M),A=({activeItem:e,item:t,add:a,duplicateCurrent:n,deleteCurrent:i})=>o.a.createElement(o.a.Fragment,null,o.a.createElement(b.a,{form:!0,className:"clearfix"},o.a.createElement(v.a,{style:{position:"relative"}},o.a.createElement(z,{add:a,duplicateCurrent:n,deleteCurrent:i,activeItem:e}),void 0!==e?o.a.createElement("h3",{className:"h5 mt-2"},Object(k.capitalize)(t.type)):o.a.createElement("div",{className:"text-muted text-center"},o.a.createElement("small",null,"Please add or select a timeline item")))),void 0!==e?o.a.createElement(b.a,null,o.a.createElement(v.a,null,o.a.createElement("hr",null),o.a.createElement(P,null))):null),L=({icon:e,fallbackIcon:t,tooltip:a,unit:n})=>{const i=Object(r.createRef)();return(o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"input-group-prepend",ref:i},o.a.createElement(x.a,null,o.a.createElement(j.a,{fixedWidth:!0,icon:e,fallback:t}))),a?o.a.createElement(w.a,{target:i,placement:"left",delay:{show:0,hide:150}},a,n&&o.a.createElement("span",{className:"text-muted"}," (",n,")")):null))},F=e=>{let t=e.model,a=Object(n.a)(e,["model"]);return(o.a.createElement(d.b,Object.assign({name:t,component:T.c,className:"text-monospace"},a)))},X=({activeItem:e})=>o.a.createElement(o.a.Fragment,null,o.a.createElement(b.a,{form:!0},o.a.createElement(v.a,null,o.a.createElement(C.a,null,o.a.createElement(I.a,null,o.a.createElement(L,{icon:"arrow-from-left",fallbackIcon:"play-circle",tooltip:"Start",unit:"ms"}),o.a.createElement(F,{model:"timeline[".concat(e,"].start"),pattern:D.b}),o.a.createElement(L,{icon:"arrow-to-right",fallbackIcon:"stop-circle",tooltip:"End",unit:"ms"}),o.a.createElement(F,{model:"timeline[".concat(e,"].stop"),pattern:D.b}),o.a.createElement(L,{icon:"volume",tooltip:"Gain",unit:"fraction"}),o.a.createElement(F,{model:"timeline[".concat(e,"].gain"),placeholder:"gain",pattern:D.b})))),o.a.createElement(v.a,null,o.a.createElement(C.a,null,o.a.createElement(I.a,null,o.a.createElement(L,{icon:"location-arrow",tooltip:"Panning",unit:"-1 \u2026 +1"}),o.a.createElement(F,{model:"timeline[".concat(e,"].pan"),placeholder:"pan",pattern:D.b}),o.a.createElement(L,{icon:"plane-departure",tooltip:"Ramp up duration",unit:"ms"}),o.a.createElement(F,{model:"timeline[".concat(e,"].rampUp"),placeholder:"0",pattern:D.b}),o.a.createElement(L,{icon:"plane-arrival",tooltip:"Ramp down duration",unit:"ms"}),o.a.createElement(F,{model:"timeline[".concat(e,"].rampDown"),placeholder:"0",pattern:D.b})))))),N=({activeItem:e},{id:t})=>o.a.createElement(o.a.Fragment,null,o.a.createElement(X,{activeItem:e}),o.a.createElement(b.a,{form:!0},o.a.createElement(v.a,null,o.a.createElement(C.a,null,o.a.createElement(O.a,{name:"timeline[".concat(e,"].payload.src"),accept:"audio/*,video/ogg",icon:"file-audio",component:t}))),o.a.createElement(v.a,null,o.a.createElement(C.a,null,o.a.createElement(I.a,null,o.a.createElement(L,{icon:"repeat",fallbackIcon:"redo",tooltip:"Loop audio",unit:"boolean"}),o.a.createElement(d.b,{name:"timeline[".concat(e,"].payload.loop"),as:"select",className:"form-control custom-select text-monospace"},o.a.createElement("option",{value:"false"},"Play sound once"),o.a.createElement("option",{value:"true"},"Repeat continuously")))))),o.a.createElement(b.a,null,o.a.createElement(v.a,null,o.a.createElement("small",{className:"text-muted"},"Please note that, for security reasons, audio files must be either embedded in the study, hosted on the same server on which the study is running, or on a server with ",o.a.createElement("a",{href:"https://enable-cors.org/server.html",target:"_blank",rel:"noopener noreferrer"},"cross-origin resource sharing")," enabled. Please also note that Chrome and Safari do not support loading sounds offline; please consider hosting the study on a server instead."))));N.contextTypes={id:c.a.oneOfType([c.a.string,c.a.number])};const R=({activeItem:e})=>o.a.createElement(o.a.Fragment,null,o.a.createElement(X,{activeItem:e}),o.a.createElement(b.a,{form:!0},o.a.createElement(v.a,null,o.a.createElement(C.a,null,o.a.createElement(I.a,null,o.a.createElement(L,{icon:"integral",fallbackIcon:"water",tooltip:"Waveform"}),o.a.createElement(d.b,{name:"timeline[".concat(e,"].payload.type"),as:"select",className:"text-monospace form-control custom-select"},o.a.createElement("option",{value:"sine"},"Sine wave"),o.a.createElement("option",{value:"square"},"Square wave"),o.a.createElement("option",{value:"sawtooth"},"Sawtooth"),o.a.createElement("option",{value:"triangle"},"Triangle"))))),o.a.createElement(v.a,null,o.a.createElement(C.a,null,o.a.createElement(I.a,null,o.a.createElement(L,{icon:"music",tooltip:"Frequency",unit:"Hz"}),o.a.createElement(F,{model:"timeline[".concat(e,"].payload.frequency"),placeholder:"frequency (Hz)",pattern:D.b}),o.a.createElement(L,{icon:"tachometer-average",tooltip:"Detune",unit:"cents"}),o.a.createElement(F,{model:"timeline[".concat(e,"].payload.detune"),placeholder:"detune (cents)",pattern:D.b})))))),W=({activeItem:e,item:t,handleChange:a})=>{switch(t.type){case"oscillator":return o.a.createElement(R,{activeItem:e,item:t,handleChange:a});case"sound":return o.a.createElement(N,{activeItem:e,item:t,handleChange:a});default:return null}};t.a=({timeline:e,activeItem:t,handleChange:a,add:n,duplicateCurrent:i,deleteCurrent:r})=>o.a.createElement(m.a,null,o.a.createElement(A,{activeItem:t,item:void 0!==t?e[t]:void 0,add:n,duplicateCurrent:i,deleteCurrent:r}),void 0!==t?o.a.createElement(W,{activeItem:t,item:e[t],handleChange:a}):null)},921:function(e,t,a){"use strict";var n=a(0),i=a.n(n),r=a(92),o=a.n(r),l=a(800),s=a(28),c=a(837);const m=({label:e,priority:t,start:a,stop:r,active:o,onClick:m,update:d},{range:h,calcPosition:u,closestLayerY:p,setCursor:g})=>{const E=u(a,r,t),y=E.x,f=E.y,b=E.w,v=E.lockStart,x=E.lockStop,w=!v&&!x;let C=0;const I=e=>{const t=e.getAbsolutePosition().x,a=e.getPosition().x;C=t-a},k=()=>{C=0},j=Object(n.createRef)(),O=Object(n.createRef)(),T=Object(n.createRef)();return i.a.createElement(l.Group,{ref:j,x:y,y:f,draggable:w,dragBoundFunc:({x:e,y:t})=>({x:Object(s.clamp)(e-C,0,h.max-b)+C,y:p(t)}),onDragStart:function(){g("grabbing"),O.current.shadowEnabled(!0),I(this)},onDragEnd:()=>{O.current.shadowEnabled(o),g("grab"),k();const e=j.current.position(),t=e.x,a=e.y,n=O.current.width();d({x:t,y:a,width:n})}},i.a.createElement(l.Rect,{ref:O,x:.5,y:.5,height:36,width:Math.max(b,10),cornerRadius:4,fill:o?c.a.active:"white",stroke:o?"white":c.a.buttonBorder,strokeWidth:1,onClick:m,onMouseEnter:()=>w&&g("grab"),onMouseLeave:()=>g("default"),shadowColor:"rgba(0, 0, 0, 0.125)",shadowBlur:8,shadowEnabled:o}),i.a.createElement(l.Text,{listening:!1,x:12,y:12,text:e,fontFamily:"Fira Sans",fontSize:14,fill:o?"white":c.a.root}),i.a.createElement(l.Circle,{visible:o&&!v,listening:o&&!v,x:0,y:18,radius:6,offsetX:-.5,fill:c.a.active,stroke:"white",strokeWidth:2,draggable:!v,dragBoundFunc:({x:e})=>({x:Object(s.clamp)(e-C,0,y+b-10)+C,y:p(f)+18}),onDragStart:function(){I(this)},onDragMove:e=>{const t=e.target.getAbsolutePosition().x,a=b-(t-C-y);j.current.position({x:t-C,y:f}),O.current.width(a),T.current.position({x:a,y:18})},onDragEnd:()=>{k()},onMouseEnter:()=>g("ew-resize"),onMouseLeave:()=>g("default")}),i.a.createElement(l.Circle,{ref:T,visible:o&&!x,listening:o&&!x,x:b,y:18,radius:6,offsetX:-.5,fill:c.a.active,stroke:"white",strokeWidth:2,draggable:!x,dragBoundFunc:({x:e})=>({x:Object(s.clamp)(e-C,y+10,h.max)+C,y:p(f)+18}),onDragStart:function(){I(this)},onDragMove:e=>{O.current.width(e.target.getAbsolutePosition().x-C-y)},onDragEnd:()=>{k()},onMouseEnter:()=>g("ew-resize"),onMouseLeave:()=>g("default")}))};m.contextTypes={range:o.a.object,width:o.a.number,calcPosition:o.a.func,closestLayerY:o.a.func,setCursor:o.a.func};var d=m;const h=({timeline:e,activeItem:t,setActive:a,updateItem:n},{width:r,height:o})=>i.a.createElement(l.Layer,null,i.a.createElement(l.Rect,{x:0,y:0,width:r,height:o,onClick:()=>a(void 0)}),e.map((e,r)=>i.a.createElement(d,{key:"timelineitem-".concat(r),label:e.type?Object(s.capitalize)(e.type):"?",start:e.start,stop:e.stop,priority:e.priority,active:t===r,onClick:()=>a(r),update:e=>n(r,e)})));h.contextTypes={width:o.a.number,height:o.a.number};t.a=h},923:function(e,t,a){"use strict";a.r(t),function(e){var n=a(26),i=a(0),r=a.n(i),o=a(92),l=a.n(o),s=a(28),c=a(800),m=a(912),d=a(921),h=a(913),u=a(38);class p extends i.Component{constructor(e){super(e),this.state={width:0,offset:0,activeItem:void 0,zoom:e.zoom},this.calcPosition=this.calcPosition.bind(this),this.toX=this.toX.bind(this),this.closestLayerY=this.closestLayerY.bind(this),this.setActive=this.setActive.bind(this),this.setCursor=this.setCursor.bind(this),this.setZoom=this.setZoom.bind(this),this.handleChange=this.handleChange.bind(this),this.updateItem=this.updateItem.bind(this),this.handleAdd=this.handleAdd.bind(this),this.handleDuplicateCurrent=this.handleDuplicateCurrent.bind(this),this.handleDeleteCurrent=this.handleDeleteCurrent.bind(this),this.stage=Object(i.createRef)(),this.wrapper=Object(i.createRef)()}componentDidMount(){this.setState({width:this.wrapper.current.clientWidth})}getChildContext(){return{range:this.props.range,zoom:this.state.zoom,toX:this.toX,width:this.state.width,height:this.props.height,padding:this.props.padding,calcPosition:this.calcPosition,closestLayerY:this.closestLayerY,setCursor:this.setCursor,setZoom:this.setZoom}}toX(e,t=this.state.zoom){return e/Math.pow(10,t)}toTime(e,t=this.state.zoom){return e*Math.pow(10,t)}calcPosition(e,t,a){return{x:this.toX(parseInt(e)||0),y:this.layerY(a),w:this.toX(parseInt(t)-parseInt(e)||100),lockStart:"string"===typeof e&&e.includes("$"),lockStop:"string"===typeof t&&t.includes("$")}}closestLayer(e){const t=Object(s.clamp)(e,this.props.padding,this.props.height-3*this.props.padding);return Math.round((t-this.props.padding)/(this.props.layerHeight+this.props.layerGutter))}closestLayerY(e){return this.layerY(this.closestLayer(e))}layerY(e){return e*(this.props.layerHeight+this.props.layerGutter)+this.props.padding}suggestPosition(e,t=100){const a=Object(s.sortBy)(this.props.data,[e=>e.start,e=>e.priority]),i=this.closestLayer(this.props.height)+1,r=a.length>0?a[a.length-1]:{stop:0,priority:-1};return Object(n.a)({},e,{start:e.start||r.stop,stop:e.stop||r.stop+t,priority:e.priority||(r.priority+1)%i})}setActive(e){e!==this.state.activeItem&&this.setState({activeItem:e})}setCursor(e){this.stage.current.container().style.cursor=e}setZoom(e){const t=this.toTime(-1*(this.stage.current.x()-this.state.width/2))-this.toTime(this.state.width/2,e),a=Object(s.clamp)(this.toX(t,e),this.toX(0,e),this.toX(this.props.range.max,e)-this.state.width);this.setState({zoom:e,offset:-a})}handleChange(e,t){this.props.formikContext.setFieldValue("timeline[".concat(this.state.activeItem,"].").concat(e),t)}updateItem(e,{x:t,y:a,width:n}){this.props.updateTimelineItem(this.context.id,e,{start:this.toTime(t),stop:this.toTime(t+n),priority:this.closestLayer(a)})}handleAdd(t){this.props.formikContext.setFieldValue("timeline",[...this.props.data,this.suggestPosition(t)]),e(()=>this.setState({activeItem:this.props.data.length-1}))}handleDuplicateCurrent(){if(void 0!==this.state.activeItem){const e=this.props.data[this.state.activeItem];this.handleAdd(Object(n.a)({},e,{start:void 0,stop:void 0,priority:void 0,payload:Object(n.a)({},e.payload)}))}}handleDeleteCurrent(){void 0!==this.state.activeItem&&(this.setState({activeItem:void 0}),this.props.formikContext.setFieldValue("timeline",this.props.data.filter((e,t)=>t!==this.state.activeItem)))}render(){const e=this.state,t=e.width,a=e.offset,n=this.props,i=n.data,o=n.range,l=n.height,u=n.padding;return r.a.createElement("div",{ref:this.wrapper},r.a.createElement(c.Stage,{ref:this.stage,width:t,height:l,x:a,offsetX:-u,draggable:!0,onDragEnd:()=>null,dragBoundFunc:({x:e})=>({x:Object(s.clamp)(e,-(this.toX(o.max)-t+u),-(this.toX(o.min,0)+u)),y:0}),className:"border-bottom"},r.a.createElement(m.a,{listening:!1}),r.a.createElement(d.a,{timeline:i||[],activeItem:this.state.activeItem,updateItem:this.updateItem,setActive:this.setActive})),r.a.createElement(h.a,{timeline:i||[],handleChange:this.handleChange,updateItem:this.updateItem,activeItem:this.state.activeItem,setActive:this.setActive,add:this.handleAdd,duplicateCurrent:this.handleDuplicateCurrent,deleteCurrent:this.handleDeleteCurrent}))}}p.defaultProps={height:200,padding:20,layerHeight:30,layerGutter:20,range:{min:-100,max:3e4},zoom:0},p.contextTypes={id:l.a.oneOfType([l.a.string,l.a.number])},p.childContextTypes={range:l.a.object,zoom:l.a.number,toX:l.a.func,width:l.a.number,height:l.a.number,padding:l.a.number,calcPosition:l.a.func,closestLayerY:l.a.func,setCursor:l.a.func,setZoom:l.a.func};t.default=Object(u.c)(null,{updateTimelineItem:(e,t,{start:a,stop:n,priority:i})=>({type:"UPDATE_TIMELINE_ITEM",id:e,item:t,data:{start:a,stop:n,priority:i}})})(p)}.call(this,a(287).setImmediate)}}]);
//# sourceMappingURL=6.6c193b71.chunk.js.map