(this["webpackJsonplab.js.builder"]=this["webpackJsonplab.js.builder"]||[]).push([[0],{114:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return m}));var n=a(0),r=a.n(n),l=a(438),o=a(800),c=a(23),s=a.n(c);const i=({id:e,activeId:t,setId:a,children:n})=>r.a.createElement(l.a,null,r.a.createElement(o.a,{className:s()({active:t===e}),onClick:()=>a(e)},n)),m=({onClick:e})=>r.a.createElement(l.a,{className:"ml-auto",style:{padding:"0.25em 0"}},r.a.createElement("button",{type:"button",className:"close","aria-label":"Close",onClick:e},r.a.createElement("span",{"aria-hidden":"true"},"\xd7")))},160:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return s}));var n=a(29),r=a(427),l=a.n(r);const o=e=>{const t=Object.entries(e).map(([e,{files:t}])=>(null===t||void 0===t?void 0:t.rows)||[]).filter(e=>e.length>0);return Object(n.flatMap)(t,e=>e.map(e=>e[0].poolPath))},c=(e,t=[])=>{const a=t.map(e=>{if(!(e.poolPath&&e.data&&e.data.content)&&!(e.component&&e.localPath&&e.poolPath)&&!(e.component&&e.localPath&&e.data&&e.data.content))throw console.log("Incomplete data for file",e),Error("Incomplete data for file",e);let t=void 0,a=void 0;if(e.data&&e.data.content){const n=l()().update(e.data.content).digest("hex"),r=(e.localPath||e.poolPath).split(".").pop();t="embedded/".concat(n,".").concat(r),a={content:e.data.content,source:e.data.source||"embedded",checkSum:n}}return{poolPath:e.poolPath||t,localPath:e.localPath,component:e.component,data:a}});return e.dispatch({type:"ADD_FILES",files:a}),a},s=(e,t,a)=>{const n=e.getState();if(n.components[t].files){const e=n.components[t].files.rows.map(e=>e[0]).filter(e=>e.localPath===a).pop();if(e)return{localPath:a,poolPath:e.poolPath,file:n.files.files[e.poolPath]}}}},162:function(e,t,a){"use strict";var n=a(0),r=a.n(n),l=a(285),o=a.n(l);class c extends n.Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this),this.handleDrop=this.handleDrop.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.inputField=r.a.createRef()}handleClick(){this.inputField.current.click()}handleInputChange(){const e=Array.from(this.inputField.current.files).filter(e=>this.checkFile(e));this.handleFiles(e)}handleDrop(e){if(e.stopPropagation(),e.preventDefault(),e.dataTransfer.items){const t=Array.from(e.dataTransfer.items).filter(e=>"file"===e.kind).map(e=>e.getAsFile()).filter(e=>this.checkFile(e));this.handleFiles(t),e.dataTransfer.items.clear()}}handleDragOver(e){e.stopPropagation(),e.preventDefault()}checkFile(e){return e.size>this.props.maxSize&&alert("This file is too large to be opened. Please contact support for assistance!"),e.size<=this.props.maxSize&&e.size>=this.props.minSize&&o()({name:e.name,type:e.type},this.props.accept)}handleFiles(e){Promise.all(e.map(e=>new Promise(t=>{const a=new FileReader;a.onload=a=>t([a.target.result,e]),"text"===this.props.decodeAs?a.readAsText(e):"dataURL"===this.props.decodeAs&&a.readAsDataURL(e)}))).then(e=>{this.props.onUpload(e)})}render(){const e=this.props.tag||"div";return(r.a.createElement(r.a.Fragment,null,r.a.createElement(e,{className:this.props.className,onClick:this.handleClick,onDrop:this.handleDrop,onDragOver:this.handleDragOver},this.props.children),r.a.createElement("input",{type:"file",accept:this.props.accept,multiple:this.props.multiple,style:{display:"none"},ref:this.inputField,onChange:this.handleInputChange,onClick:e=>e.target.value=null})))}}c.defaultProps={minSize:0,maxSize:2.5*Math.pow(1024,2),accept:"",multiple:!0,decodeAs:"text"},t.a=c},170:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return l}));const n=(e,t)=>{const a=t[e];if(a.children&&Array.isArray(a.children)){const e=a.children.map(e=>n(e,t));return a.children.concat(...e)}return[]},r=(e,t)=>{const a=Object.entries(t).filter(([t,a])=>a.children&&Array.isArray(a.children)&&a.children.includes(e)).map(([e,t])=>e);return a.concat(...a.map(e=>r(e,t)))},l=(e,t="root",a=0)=>{const n=[];return e[t].children&&e[t].children.forEach(t=>n.push([t,a,e[t]],...l(e,t,a+1))),n}},186:function(e,t,a){"use strict";var n=a(0),r=a.n(n),l=a(429),o=a.n(l),c=a(23),s=a.n(c);a(581);t.a=({isOpen:e,onRequestClose:t,modalProps:a={},children:n})=>r.a.createElement(o.a,{appElement:document.getElementById("root"),isOpen:e,onRequestClose:t,className:s()({"modal-dialog":!0,"modal-lg":"lg"===a.size,"modal-xl":"xl"===a.size}),overlayClassName:"modal fade show",contentLabel:"App Modal",style:{overlay:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",opacity:"1",overflowX:"hidden",overflowY:"auto"}}},n)},218:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return o}));var n=a(71),r=a(51);const l=(e="")=>{const t=e.split("/"),a=Object(n.a)(t,1)[0];return["image","audio","video"].includes(a)?"file-"+a:["text/html","text/css","application/javascript","application-json"].includes(e)?"file-code":"text/plain"===e?"file-alt":"file"},o=e=>l(Object(r.c)(e))},258:function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var n=a(37),r=a.n(n),l=a(54),o=a(0),c=a.n(o),s=a(33),i=a(830),m=a(831),d=a(160),p=a(186),u=a(30),h=a(114),b=a(162),E=({handleUpload:e,accept:t=""})=>c.a.createElement(b.a,{accept:t,decodeAs:"dataURL",onUpload:e},c.a.createElement("div",{className:"btn btn-outline-secondary btn-block text-center p-5"},c.a.createElement(u.a,{icon:"file-upload",className:"d-block text-muted p-3",style:{fontSize:"3.5rem"}}),c.a.createElement("small",{className:"text-muted"},"Please ",c.a.createElement("strong",null,"drop a file")," here to add,",c.a.createElement("br",null),"or ",c.a.createElement("strong",null,"click to choose")," one from your computer"))),f=a(26),g=a(71),y=a(854),w=a(823),v=a(824),x=a(29),O=a(285),k=a.n(O),C=a(170),j=a(51),N=a(218);var T=({accept:e,handleImport:t,initialComponent:a})=>{const n=Object(o.useState)(a),r=Object(g.a)(n,2),l=r[0],i=r[1],m=Object(s.useStore)().getState(),d=m.components,p=m.files.files,h=d[l].files?d[l].files.rows.map(e=>Object(f.a)({type:p[e[0].poolPath]?Object(j.c)(p[e[0].poolPath].content):""},e[0])):[];return c.a.createElement(c.a.Fragment,null,c.a.createElement(y.a,{type:"select",id:"component",bsSize:"lg",className:"mb-2 font-weight-bold",defaultValue:l,onChange:e=>i(e.target.value)},Object(C.b)(d).map(([e,t,a],n)=>c.a.createElement("option",{value:e,key:n},t>0?Object(x.repeat)("\u2003",t-1)+"\u2219 ":"",a.title))),c.a.createElement(w.a,null,h.map((a,n)=>c.a.createElement(v.a,{action:!0,key:n,tag:"a",href:"#",className:"d-flex justify-content-between align-items-center",disabled:!k()({type:a.type,name:a.poolPath},e),onClick:()=>t(l,a.localPath)},c.a.createElement("span",{style:{fontFamily:"Fira Mono",overflow:"hidden",textOverflow:"ellipsis"}},a.localPath),c.a.createElement(u.a,{icon:Object(N.b)(a.type),fixedWidth:!0,className:"ml-2"})))))};class P extends o.Component{constructor(e){super(e),this.state={active:!1,activeTab:this.props.tab},this.promiseHandlers={},this.handleUpload=this.handleUpload.bind(this),this.handleImport=this.handleImport.bind(this),this.select=this.select.bind(this),this.toggle=this.toggle.bind(this),this.setTab=this.setTab.bind(this)}toggle(){this.setState(e=>(e.active&&this.promiseHandlers.reject&&this.promiseHandlers.reject("FileSelector hidden"),{active:!e.active}))}setTab(e){this.setState({activeTab:e})}handleUpload(e){const t=Object(d.a)(this.context.store,e.map(([e,t])=>({localPath:t.name,component:this.props.component,data:{content:e}})));return this.promiseHandlers.resolve&&this.promiseHandlers.resolve(t),t}handleImport(e,t){const a=Object(d.c)(this.context.store,e,t).poolPath,n=[{localPath:t,poolPath:a}];return this.props.component&&this.props.addToComponent&&this.props.component!==e&&Object(d.a)(this.context.store,[{component:this.props.component,localPath:n[0].localPath,poolPath:a}]),this.promiseHandlers.resolve&&this.promiseHandlers.resolve(n),n}select(){var e=this;return Object(l.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.toggle(),t.abrupt("return",new Promise((t,a)=>{e.promiseHandlers={resolve:a=>(e.setState({active:!1}),t(a)),reject:a}}));case 2:case"end":return t.stop()}}),t)})))()}renderTab(){switch(this.state.activeTab){case"pool":return c.a.createElement(T,{initialComponent:this.props.component,accept:this.props.accept,handleImport:this.handleImport});default:return c.a.createElement(E,{accept:this.props.accept,handleUpload:this.handleUpload})}}render(){return c.a.createElement(p.a,{isOpen:this.state.active},c.a.createElement("div",{className:"modal-content"},c.a.createElement(i.a,{tabs:!0},c.a.createElement(h.b,{id:"new",activeId:this.state.activeTab,setId:this.setTab},c.a.createElement(u.a,{icon:"plus",weight:"s"})),c.a.createElement(h.b,{id:"pool",activeId:this.state.activeTab,setId:this.setTab},c.a.createElement(u.a,{icon:"folder"})),c.a.createElement(h.a,{onClick:this.toggle})),c.a.createElement(m.a,null,this.renderTab())))}}P.contextType=s.ReactReduxContext,P.defaultProps={addToComponent:!0,accept:"",tab:"new"}},284:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));const n="(\\d+(\\.\\d+)?)|(\\$\\{.*\\})",r="(\\d+)|(\\$\\{.*\\})"},30:function(e,t,a){"use strict";var n=a(0),r=a.n(n),l=a(23),o=a.n(l);a.e(10).then(a.t.bind(null,803,7)),a.e(9).then(a.t.bind(null,804,7)),a.e(7).then(a.t.bind(null,805,7)),a.e(8).then(a.t.bind(null,806,7));const c="".concat("free"),s={"alarm-clock":"clock","arrows-v":"arrows-alt-v","arrows-h":"arrows-alt-h","bullseye-pointer":"hand-pointer","comment-alt-minus":"comment-alt","comment-alt-lines":"comment-alt","ellipsis-h-alt":"ellipsis-h",expand:"square","file-exclamation":"exclamation-circle","flask-potion":"flask","heart-circle":"heart","long-arrow-down":"long-arrow-alt-down","long-arrow-right":"long-arrow-alt-right",repeat:"redo","spinner-third":"spinner",tachometer:"tachometer-alt","tachometer-average":"tachometer-alt",volume:"volume-up"},i=({icon:e,fixedWidth:t,weight:a,fallback:n,fallbackWeight:l,id:i,className:m,title:d,style:p})=>r.a.createElement("i",Object.assign({className:o()("fa".concat("pro"===c?a:l," "),"fa-".concat("pro"===c?e:s[e]||n||e),t?"fa-fw":null,m),"aria-hidden":!0},{id:i,title:d,style:p}));i.defaultProps={weight:"r",fallbackWeight:"s"},t.a=i},435:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAJOgAACToB8GSSSgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAZMSURBVGiB1ZrrbxRlFMZ/Z/bSVooKxAuRaFSu6e5SUqS10NaimIgfFDEhqBg1UVQ0MQT/ANTEDxASNUYJURMxaOWDxmgVFAu7RQoUKb2EIiCaeAEJLVLaWnZ3jh92tuz2Ojc1Pl92Z/ac5zln57wz73nfEXyANpRcT8hYjEo5qrOBWxCmAMWWyUWUc8CPiHQCTaTSDVLbcdqrtrgOev/sKVwKPgyyCpjvjoSDoFspSG2T8s5zbigcJ6ANsWkEzXUgTwJXuBEdAb0oWwgaG6XyyK9OHG0noM1lIfqTz4K+wuXS8Bt9IBvo6XtVlp4YsONgKwFtjM1CtQ6Y6yk825AWkBVSdeSH8SyN8Qw0HluOajP/WvAAWgpmsyYiy8azHDMBjUcfQ/Qj/rmSGQsTQbZrY+TpsYxGTUAbo6sR3gOCvodmHwFU3tJ45PnRDEYcAxqPLUe0Dgi4EO0C2lB+QrAGohaC3ATEgEkuONMoD0p126dDfxiWgDVgm3FaNsKfoE8wST+Xko5LI5loR0mYLuM+4B1goiN+6MEMlElNy/F82eECB3A3YHdJVdtddgw1Ed0N1DhWEA5TGC6X+YeS2VP5Y6DbWIv7u82d2hh7YTwjy6balYIyj75knsbgFdDv5t5A2jwGTHBFnkGPVLVdOWYMiegFnJdPLi6iqZlSffR3yL0C6fSLeAv+30IxElyXPTDAmphl5jb/F6zOxJy9AgPBh/BnYtaf/aKJ6CSNR+7VjpLwaDYeMIFkaCVkExB51AdSUGnIOapD5HO6jJfGsPGgpasADI3PmQqU+UIq1Od878sIWZ9ZGHzpixZymzZFrgtiBGtR941NDkxC5o7BI6N4JeneGFWtB/KtAvVIysTGRHIcCCnuMFAp90iUxUGpaD8zyF65r1+qWveTiER1T2yxaiZgqT58Fjjoi6IpFYbVw3qH5pRP9lRj9DlEWjB0F3sjH+f84k8ZCbMMhOm+kBk6LAGUZ8g+LFWWa1PkOkv4C180lRkGcLUPVKdZ2H5o2FnhVM5RN11/nQewbH/zrCp6tYE/zUq9CDpcILUG+AQhjpjLs32uZbtjmL1jyER/mhWV4eUDyMKjPwMPjOoj+rhX6SBwEZjsgSPJQOibsQy0oaSYAHMxjKsQPSYL208S7ttJsugSMPRJ7QDaEwS68ZSANMqSQ38CaCK6E+QoaAuKIswGWQS6AAihgMoRoFQqTlzQRGwvaK37+OV8EOUkwq3uEzC/AGvBC70LdEkmr0GVoQ4xbYhNk9rWXxCzHhX3CQjHDWut0j1M6/4f1KXYW2cSAnoPAGmPt1PlmAE0eaA4JTXtR62wltr2smwt35Ou1Q3dZxAyv2WE62wLmvkHtaMkjLLYgecSrZ9eYH3/ypU2KEH2GFLRfgal2RWFYZVPt9TgrE2cwMSiKsDLU3m/VLSfsWaEutUFQT+F4T0AmGK/fLLIlpxRvBuGTLntEWyF7JS2ILUN6HXkrzTI/EN9ecE488+Mg8p9/Si7HXr3Er5UB1YCUt55DmWLMw45AqCNJTcCMx0GADDL8gWh1aH229kNkctNRdDYiJOrIGamhzbNJJByFgAAKZJYK3jipB/vIZXemD0YTMDaGXnZPo/cA5BZn5F1gOkgCBPVtZf3yPRu+666PndvLb+tKwpvQjhsk2mmJqJPAUhV62uYlAKbQX4e1UP4CdiMSalUt78B1io42G2qvqeo4PV8yiHQxNyZYDZj77b4F+gaqWp/N4+jafqVpK6Yimpmqi5yEQZ+k0XHevK1Ik+AvAkU2tC6QMAsk8qOE2MmYBEvA9mO/eX1XQibKAx/nbvwOiJ3c1mIvoG7MWStg4dfGpEHZFHrZ0N/GHXuYpXHZpsCWfQDzUAnmX2Cbuv8JGAy6ByQMqDIAaeirJbqthHvkmNOvjJbTGzhv9ulSSOskUVto/6R484eNR69H+F9vK0ou8EFRFaNVDa5sLfNuqd0BoF0Hco8f2IbF98TMFcMHbAjwdbqmNS0HCc5ZQHIC0DPuA7u0Qeynsnm7XaCBzevGsTnTMUIvojyFP7tJ/QCm0mZG5y+AOLtZY9kaCXKI8ACF1wK7Ac+IGB+KJUdXW7i8GNRF90buxY1azGlItPIczNwDbmv28BZ4BRKJ4Y2IUaDLGz9w6v23wYTMruD+wugAAAAAElFTkSuQmCC"},439:function(e,t,a){e.exports=a(782)},51:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return c})),a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return i})),a.d(t,"f",(function(){return m}));var n=a(71);const r=(e,t="")=>"data:".concat(t,",").concat(encodeURIComponent(e)),l=/^\s*data:([-+.\w\d]+\/[-+.\w\d]+)?(;base64)?,(.*)$/,o=e=>{const t=l.exec(e),a=Object(n.a)(t,4),r=a[1],o=a[2],c=a[3],s=";base64"===o;return{data:s?c:decodeURIComponent(c),mime:r,base64:s}},c=e=>{var t;return null===(t=l.exec(e))||void 0===t?void 0:t[1]},s=e=>{const t=o(e),a=t.data,n=t.mime;if(t.base64){const e=window.atob(a),t=new Uint8Array(e.length);for(var r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return new Blob([t],{type:n})}return new Blob([a],{type:n})},i=e=>Math.ceil(.75*(e.length-e.indexOf(",")-1)/1e3),m=(e,t,...a)=>{const n=o(e),l=n.data,c=n.mime,s=t(l,...a);return r(s,c)}},572:function(e,t,a){},574:function(e,t,a){},581:function(e,t,a){},582:function(e,t,a){},583:function(e,t,a){},712:function(e,t,a){},713:function(e,t,a){},719:function(e,t){},721:function(e,t){},768:function(e,t,a){},771:function(e,t,a){},772:function(e,t,a){},773:function(e,t,a){},774:function(e,t,a){},775:function(e,t,a){},776:function(e,t,a){},777:function(e,t,a){},778:function(e,t,a){},779:function(e,t,a){},780:function(e,t,a){},781:function(e,t,a){},782:function(e,t,a){"use strict";a.r(t);var n=a(37),r=a.n(n),l=a(54),o=a(0),c=a.n(o),s=a(141),i=a.n(s),m=a(33),d=a(152),p=a(422);const u=[20,1,1];var h=a(26),b=a(153),E=a(156);function f(){const e=Object(b.a)(['\n        <form>\n          <input name="variable">\n          <button type="submit">Submit</button>\n        </form>\n      ']);return f=function(){return e},e}const g={root:{id:"root",title:"root",type:"lab.flow.Sequence",children:[],parameters:{rows:[[{name:"",value:"",type:"string"}]]},plugins:[{type:"lab.plugins.Metadata"}],metadata:{title:"",description:"",repository:"",contributors:""}}},y=["Content","Behavior","Scripts","Files","Plugins","Parameters","More"],w={files:{rows:[]},responses:{rows:[["","","",""]]},parameters:{rows:[[{name:"",value:"",type:"string"}]]},messageHandlers:{rows:[[{title:"",message:"",code:""}]]}},v={"lab.flow.Loop":{name:"Loop",description:"Repeat a component",category:"Flow",icon:"repeat",minChildren:1,maxChildren:1,tabs:y,defaultTab:"Content",defaults:Object(h.a)({type:"lab.flow.Loop",children:[],templateParameters:{columns:[{name:"",type:"string"},{name:"",type:"string"}],rows:[["",""]]},sample:{mode:"draw-shuffle"}},w)},"lab.flow.Sequence":{name:"Sequence",description:"Show components sequentially",category:"Flow",icon:"sort-amount-down",minChildren:1,maxChildren:1/0,tabs:y,defaultTab:"Content",defaults:Object(h.a)({type:"lab.flow.Sequence",children:[]},w)},"lab.html.Form":{name:"Form",description:"Collect HTML form data",category:"HTML",icon:"list-alt",iconWeight:"r",iconFallbackWeight:"r",minChildren:0,maxChildren:0,tabs:y,defaultTab:"Content",defaults:Object(h.a)({type:"lab.html.Form",content:Object(E.a)(f()),scrollTop:!0},w)},"lab.html.Frame":{name:"Frame",description:"Create a common frame around nested content",category:"HTML",icon:"expand-wide",minChildren:1,maxChildren:1,tabs:y,defaultTab:"Content",defaults:Object(h.a)({type:"lab.html.Frame",context:'<main data-labjs-section="frame">\n  \x3c!-- Content gets inserted here --\x3e\n</main>',contextSelector:'[data-labjs-section="frame"]'},w)},"lab.html.Screen":{name:"Screen",description:"Show content using HTML",category:"HTML",icon:"window-maximize",iconWeight:"r",iconFallbackWeight:"r",minChildren:0,maxChildren:0,tabs:y,defaultTab:"Content",defaults:Object(h.a)({type:"lab.html.Screen"},w)},"lab.html.Page":{name:"Page",description:"Graphical page builder",category:"HTML",icon:"clipboard-list",iconWeight:"r",iconFallbackWeight:"s",minChildren:0,maxChildren:0,tabs:y,defaultTab:"Content",defaults:Object(h.a)({type:"lab.html.Page",items:{rows:[[{type:"text"}]]},scrollTop:!0,submitButtonText:"Continue \u2192",submitButtonPosition:"right"},w)},"lab.canvas.Frame":{name:"Frame",description:"Provide a common canvas for nested components",category:"Canvas",icon:"expand-wide",minChildren:1,maxChildren:1,tabs:y,defaultTab:"Content",defaults:Object(h.a)({type:"lab.canvas.Frame",context:"\x3c!-- Nested components use this canvas --\x3e\n<canvas />",contextSelector:"canvas"},w)},"lab.canvas.Screen":{name:"Screen",description:"Show content using a canvas",category:"Canvas",icon:"image",iconWeight:"r",iconFallbackWeight:"r",minChildren:0,maxChildren:0,tabs:y,defaultTab:"Content",defaults:Object(h.a)({type:"lab.canvas.Screen",content:[],viewport:[800,600]},w)}},x=(e,t)=>e&&v[t].tabs.includes(e)?e:t?v[t].defaultTab:void 0,O=["lab.canvas.Screen","lab.html.Page","lab.flow.Sequence","lab.flow.Loop"];var k=a(29);let C=0;const j=function(e={}){const t=Object.entries(e).map(([e,t])=>e);let a;do{a=(++C).toString()}while(t.includes(a));return a};const N={viewType:"COMPONENT_DETAIL",viewProps:{id:"welcome"}};var T=a(51);const P={files:{"index.html":{content:Object(T.b)('<!doctype html>\n<html>\n<head>\n  <meta charset="utf-8">\n  <title>Experiment</title>\n  \x3c!-- viewport setup --\x3e\n  <meta name="viewport" content="width=device-width, initial-scale=1">\n  \x3c!-- lab.js library and experiment code --\x3e\n  ${ header }\n</head>\n<body>\n  \x3c!-- If you\'d rather have a container with a fixed width\n       and variable height, try removing the fullscreen class below --\x3e\n  <div class="container fullscreen" data-labjs-section="main">\n    <main class="content-vertical-center content-horizontal-center">\n      <div>\n        <h2>Loading Experiment</h2>\n        <p>The experiment is loading and should start in a few seconds</p>\n      </div>\n    </main>\n  </div>\n</body>\n</html>\n',"text/html"),source:"library"},"style.css":{content:Object(T.b)("/* Please define your custom styles here */","text/css"),source:"library"}},bundledFiles:{"lib/lab.js":{type:"application/javascript"},"lib/lab.js.map":{type:"text/plain"},"lib/lab.fallback.js":{type:"application/javascript"},"lib/lab.legacy.js":{type:"application/javascript"},"lib/lab.legacy.js.map":{type:"text/plain"},"lib/lab.css":{type:"text/css"},"lib/loading.svg":{type:"image/svg+xml"}}};const S={modalType:null,modalProps:{}};var D,I,F=(D=Object(d.combineReducers)({version:(e=u,t)=>e,components:(e=g,t)=>{switch(t.type){case"MOVE_COMPONENT":if(t.oldParent===t.newParent){const a=[...e[t.newParent].children.slice(0,t.oldIndex),...e[t.newParent].children.slice(t.oldIndex+1)],n=[...a.slice(0,t.newIndex),t.id,...a.slice(t.newIndex)];return Object(h.a)({},e,{[t.newParent]:Object(h.a)({},e[t.newParent],{children:n})})}return Object(h.a)({},e,{[t.newParent]:Object(h.a)({},e[t.newParent],{children:e[t.newParent].children?[...e[t.newParent].children.slice(0,t.newIndex),t.id,...e[t.newParent].children.slice(t.newIndex)]:[t.id]}),[t.oldParent]:Object(h.a)({},e[t.oldParent],{children:[...e[t.oldParent].children.slice(0,t.oldIndex),...e[t.oldParent].children.slice(t.oldIndex+1)]})});case"ADD_COMPONENT":const a=Object(h.a)({id:t.id||j(e)},t.data);return Object(h.a)({},e,{[a.id]:a,[t.parent]:Object(h.a)({},e[t.parent],{children:e[t.parent].children?[...e[t.parent].children.slice(0,t.index),a.id,...e[t.parent].children.slice(t.index)]:[a.id]})});case"DELETE_COMPONENT":const n=1<Object.entries(e).reduce((e,[a,n])=>e+(n.children?n.children.filter(e=>e===t.id).length:0),0),r=Object(h.a)({},e,{[t.parent]:Object(h.a)({},e[t.parent],{children:e[t.parent].children.filter((e,a)=>!(e===t.id&&a===t.index))})});return n||delete r[t.id],r;case"CLONE_COMPONENT":return Object(h.a)({},e,{[t.parent]:Object(h.a)({},e[t.parent],{children:e[t.parent].children?[...e[t.parent].children.slice(0,t.index),t.id,...e[t.parent].children.slice(t.index)]:[t.id]})});case"COPY_COMPONENT":const l=Object(h.a)({},e),o=e=>{const t=Object(h.a)({},l[e]),a=j(l);return t.id&&(t.id=a),t.children&&(t.children=t.children.map(o)),l[a]=t,a};return l[t.parent]=Object(h.a)({},l[t.parent],{children:l[t.parent].children?[...l[t.parent].children.slice(0,t.index),o(t.id),...l[t.parent].children.slice(t.index)]:[o(t.id)]}),l;case"IMPORT_COMPONENT":const c=Object(h.a)({},e),s=e=>{const a=Object(h.a)({},t.source[e]),n=j(c);return a.id&&(a.id=n),a.children&&(a.children=a.children.map(s)),c[n]=a,n};return c[t.parent]=Object(h.a)({},c[t.parent],{children:c[t.parent].children?[...c[t.parent].children.slice(0,t.index),s(t.id),...c[t.parent].children.slice(t.index)]:[s(t.id)]}),c;case"COLLAPSE_COMPONENT":return e[t.id].children&&e[t.id].children.length>0?Object(h.a)({},e,{[t.id]:Object(h.a)({},e[t.id],{_collapsed:!e[t.id]._collapsed})}):e;case"UPDATE_COMPONENT":return e[t.id]?Object(h.a)({},e,{[t.id]:Object(h.a)({},e[t.id],{},t.data)}):(console.log("Skipping update to missing component ".concat(t.id)),e);case"ADD_FILES":return Object(k.fromPairs)(Object.entries(e).map(([a,n])=>{const r=t.files.filter(e=>e.component===a);if(r.length>0){const t=e[a].files||{rows:[]};return[a,Object(h.a)({},e[a],{files:{rows:[...t.rows,...r.map(e=>[{localPath:e.localPath,poolPath:e.poolPath}])]}})]}return[a,n]}));case"UPDATE_TIMELINE_ITEM":return Object(h.a)({},e,{[t.id]:Object(h.a)({},e[t.id],{timeline:e[t.id].timeline.map((e,a)=>a===t.item?Object(h.a)({},e,{},t.data):e)})});case"ADD_PLUGIN":return Object(h.a)({},e,{[t.id]:Object(h.a)({},e[t.id],{plugins:[...e[t.id].plugins||[],{type:t.pluginType}]})});case"DELETE_PLUGIN":return Object(h.a)({},e,{[t.id]:Object(h.a)({},e[t.id],{plugins:(e[t.id].plugins||[]).filter((e,a)=>a!==t.index)})});case"RESET_STATE":return g;default:return e}},componentDetail:(e=N,t)=>{switch(t.type){case"SHOW_COMPONENT_DETAIL":return{viewType:"COMPONENT_DETAIL",viewProps:{id:t.id}};case"RESET_STATE":return N;default:return e}},files:(e=P,t)=>{switch(t.type){case"ADD_FILES":return Object(h.a)({},e,{files:Object(h.a)({},e.files,{},Object(k.fromPairs)(t.files.filter(e=>e.data).map(e=>[e.poolPath,e.data])))});case"UPDATE_FILE":return Object(h.a)({},e,{files:Object(h.a)({},e.files,{[t.file]:Object(h.a)({},e.files[t.file],{},t.data)})});case"DELETE_FILE":const a=Object(h.a)({},e,{files:Object(h.a)({},e.files)});return delete a.files[t.file],a;case"MERGE_FILES":return Object(h.a)({},e,{files:Object(h.a)({},t.files,{},e.files)});case"RESET_STATE":return P;default:return e}},modal:(e=S,t)=>{switch(t.type){case"SHOW_MODAL":return{modalType:t.modalType,modalProps:t.modalProps};case"HIDE_MODAL":case"RESET_STATE":return S;default:return e}}}),I="HYDRATE",function(e,t){switch(t.type){case I:return D(t.state,t);default:return D(e,t)}}),A=a(423);function _(){const e=Object(b.a)(["\n      \x3c!-- lab.js library and experiment code --\x3e\n      ${ header }\n    "],["\n      \x3c!-- lab.js library and experiment code --\x3e\n      \\${ header }\n    "]);return _=function(){return e},e}function M(){const e=Object(b.a)(['\n      ^\\s+\x3c!-- lab.js library and default styles --\x3e$\n      ^\\s+<script [^>]* data-labjs-script="library"><\/script>$\n      ^\\s+<script [^>]* data-labjs-script="fallback"><\/script>$\n      ^\\s+<link rel="stylesheet" href="lib/lab.css">$\n      ^\\s+\x3c!-- study code and styles --\x3e$\n      ^\\s+<script defer src="script.js"><\/script>$\n      ^\\s+<link rel="stylesheet" href="style.css">$\n    '],['\n      ^\\\\s+\x3c!-- lab.js library and default styles --\x3e$\n      ^\\\\s+<script [^>]* data-labjs-script="library"><\/script>$\n      ^\\\\s+<script [^>]* data-labjs-script="fallback"><\/script>$\n      ^\\\\s+<link rel="stylesheet" href="lib/lab.css">$\n      ^\\\\s+\x3c!-- study code and styles --\x3e$\n      ^\\\\s+<script defer src="script.js"><\/script>$\n      ^\\\\s+<link rel="stylesheet" href="style.css">$\n    ']);return M=function(){return e},e}const R={"2017.0.1":e=>Object(h.a)({},e,{version:[2017,0,2],components:Object(k.mapValues)(e.components,e=>Object(h.a)({messageHandlers:{rows:[[{title:"",message:"",code:""}]]}},e))}),"2017.0.2":e=>Object(h.a)({},e,{version:[2017,0,3],components:Object(k.mapValues)(e.components,e=>"lab.flow.Loop"===e.type?Object(h.a)({},e,{templateParameters:Object(h.a)({},e.templateParameters,{columns:e.templateParameters.columns.map(e=>({name:e,type:"string"}))})}):Object(h.a)({},e))}),"2017.0.3":e=>Object(h.a)({},e,{version:[2017,0,4],components:Object(k.mapValues)(e.components,e=>{const t={space:"Space",enter:"Enter",tab:"Tab",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"};return e.responses&&e.responses.rows&&(e.responses.rows=e.responses.rows.map(e=>{if("keypress"===e[1]){const a=e[3].split(",").map(e=>e.trim()).map(e=>t[e]||e).join(", "),n=e;return n[3]=a,n}return e})),e})}),"2017.0.4":e=>(e.files.files["index.html"]&&(e.files.files["index.html"].content=e.files.files["index.html"].content.replace('id="labjs-content"','data-labjs-section="main"')),e.version=[2017,0,5],e),"2017.0.5":e=>Object(h.a)({},e,{version:[2017,1,0]}),"2017.1.0":e=>(e.files.files["index.html"]&&(e.files.files["index.html"].content=e.files.files["index.html"].content.replace('src="lib/lab.min.js"','src="lib/lab.js"')),e.files.bundledFiles["lib/lab.min.js"]&&delete e.files.bundledFiles["lib/lab.min.js"],e.files.bundledFiles["lib/lab.js"]={type:"application/javascript"},e.files.bundledFiles["lib/lab.js.map"]={type:"text/plain"},e.version=[2017,1,1],e),"2017.1.1":e=>(Object.entries(e.files.files).forEach(([t,a])=>{e.files.files[t]={content:Object(T.b)(a.content,a.type)},["index.html","style.css"].includes(t)&&(e.files.files[t].permanent=!0)}),e.version=[2017,1,2],e),"2017.1.2":e=>(e.components.root.plugins=[{type:"lab.plugins.Metadata"}],e.version=[2017,1,3],e),"2017.1.3":e=>Object(h.a)({},e,{version:[2017,1,4],components:Object(k.mapValues)(e.components,e=>"lab.canvas.Screen"===e.type?Object(h.a)({},e,{viewport:[800,600]}):e)}),"2017.1.4":e=>(e.components.root.metadata=e.components.root.metadata||{title:"",description:"",repository:"",contributors:""},e.version=[2017,1,5],e),"2017.1.5":e=>(e.components=Object(k.mapValues)(e.components,e=>(e.messageHandlers&&e.messageHandlers.rows&&(e.messageHandlers.rows=e.messageHandlers.rows.map(e=>[Object(h.a)({},e[0],{message:"prepare"===e[0].message?"after:prepare":e[0].message})])),e)),e.version=[2017,1,6],e),"2017.1.6":e=>Object(h.a)({},e,{version:[2017,1,7],components:Object(k.mapValues)(e.components,e=>Object(h.a)({},e,{parameters:{rows:[[{name:"",value:"",type:"string"}]]}}))}),"2017.1.7":e=>(e.version=[2018,0,1],e.files.files["index.html"]&&(e.files.files["index.html"].content=Object(T.f)(e.files.files["index.html"].content,e=>e.replace(/^(\s*)<script src="lib\/lab\.js"><\/script>/gm,'$&\n$1<script src="lib/lab.fallback.js" data-labjs-script="fallback"><\/script>')),e.files.files["index.html"].content=Object(T.f)(e.files.files["index.html"].content,e=>e.replace('<script src="lib/lab.js"><\/script>','<script src="lib/lab.js" data-labjs-script="library"><\/script>'))),e),"2018.0.1":e=>(e.version=[2018,0,2],e.files.bundledFiles["lib/lab.fallback.js"]={type:"application/javascript"},e.files.bundledFiles["lib/lab.legacy.js"]={type:"application/javascript"},e.files.bundledFiles["lib/lab.legacy.js.map"]={type:"text/plain"},e),"2018.0.2":e=>(e.version=[2018,0,3],e.components=Object(k.mapValues)(e.components,e=>(e._tab&&"Responses"===e._tab&&(e._tab="Behavior"),e)),e),"2018.0.3":e=>{e.version=[2018,0,4];const t=new RegExp(Object(E.a)(M()),"gm"),a=Object(E.a)(_()).split("\n").map(e=>"  ".concat(e)).join("\n");return e.files.files["index.html"].content=Object(T.f)(e.files.files["index.html"].content,e=>e.replace(t,a)),e},"2018.0.4":e=>Object(h.a)({},e,{version:[2018,1,0],components:Object(k.mapValues)(e.components,e=>Object(h.a)({},e,{files:e.files||{rows:[]}}))}),"2018.1.0":e=>(Object.entries(e.files.files).forEach(([t,a])=>{a.permanent?(e.files.files[t].source="library",delete e.files.files[t].permanent):e.files.files[t].source="embedded-global"}),e.version=[2018,1,1],e),"2018.1.1":e=>Object(h.a)({},e,{version:[2018,1,2],components:Object(k.mapValues)(e.components,e=>Object(h.a)({},e,{files:e.files?{rows:e.files.rows.map(e=>[{localPath:e[0].path,poolPath:e[0].file}])}:void 0}))}),"2018.1.2":e=>Object(h.a)({},e,{version:[19,0,0],components:Object(k.mapValues)(e.components,e=>"lab.flow.Loop"===e.type?(e.sample=e.sample||{},["",void 0].includes(e.sample.n)?e.shuffle?e.sample.mode="draw-shuffle":e.sample.mode="sequential":e.sample.replace?e.sample.mode="draw-replace":e.sample.mode="draw-shuffle",delete e.sample.replace,delete e.shuffle,e):e)}),"19.0.0":e=>Object(h.a)({},e,{version:[19,0,1],components:Object(k.mapValues)(e.components,e=>(e.timeline&&Array.isArray(e.timeline)&&(e.timeline=e.timeline.map(e=>({type:e.type,start:e.start,stop:e.stop,priority:e.priority,payload:Object(k.omit)(Object(h.a)({},e,{},e.options),["type","start","stop","priority","options"])}))),e))}),"19.0.1":e=>Object(h.a)({},e,{version:[19,1,0]}),"19.1.0":e=>Object(h.a)({},e,{version:[19,1,1],components:Object(k.mapValues)(e.components,(e,t)=>("root"===t&&e.messageHandlers&&e.messageHandlers.rows&&(e.messageHandlers.rows=e.messageHandlers.rows.filter(e=>"JATOS integration"!==e[0].title&&"epilogue"!==e[0].message)),e))}),"19.1.1":e=>Object(h.a)({},e,{version:[19,1,2],components:Object(k.mapValues)(e.components,e=>"lab.canvas.Screen"===e.type?Object(h.a)({},e,{content:e.content.map(e=>"i-text"===e.type&&"Times New Roman"===e.fontFamily?Object(h.a)({},e,{fontFamily:"serif"}):e)}):Object(h.a)({},e))}),"19.1.2":e=>Object(h.a)({},e,{version:[20,0,0]}),"20.0.0":e=>Object(h.a)({},e,{version:[20,0,1]}),"20.0.1":e=>Object(h.a)({},e,{version:[20,1,0]}),"20.0.2":e=>Object(h.a)({},e,{version:[20,1,0]}),"20.1.0":e=>Object(h.a)({},e,{version:[20,1,1]})};const L=e=>(e=>{let t=e;for(;t.version.join(".")in R;){console.log("Updating file from ".concat(t.version.join(".")));try{t=R[t.version.join(".")](t)}catch(a){console.log("found error",a)}console.log("update complete")}return t})(Object(h.a)({version:[2017,1,7]},e)),H=e=>L(JSON.parse(e)),W=["keys and/or value are too large","value is too large","QuotaExceededError"],B=a.n(A).a.createInstance({name:"lab.js"}),U=function(){var e=Object(l.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.subscribe(Object(k.debounce)(()=>{B.setItem("state:latest",t.getState()).catch(e=>{if(!W.some(t=>e.message.includes(t)))throw e})}),500),!navigator.storage||!navigator.storage.persist){e.next=11;break}return e.next=4,navigator.storage.persisted();case 4:if(!e.sent){e.next=8;break}console.log("Persistent storage enabled"),e.next=9;break;case 8:console.log("Persistent storage not permitted");case 9:e.next=12;break;case 11:console.log("No support for persistent storage");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(l.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.getItem("state:latest");case 2:return t=e.sent,e.abrupt("return",t?L(t):void 0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(l.a)(r.a.mark((function e(){var t,a,n,l,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=new URL(window.location.href))&&t.searchParams){e.next=3;break}return e.abrupt("return");case 3:if(!(a=t.searchParams.get("url"))||!window.confirm("Would you like to load the study from ".concat(a,"?"))){e.next=31;break}return e.prev=5,e.next=8,fetch(a);case 8:n=e.sent,e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(5),alert("Connection error while trying to load remote study: ".concat(e.t0)),e.abrupt("return");case 15:if(n.ok){e.next=18;break}return alert("Invalid response while loading remote study, code ".concat(n.status,": ").concat(n.statusText)),e.abrupt("return");case 18:return e.prev=18,e.next=21,n.json();case 21:l=e.sent,e.next=28;break;case 24:return e.prev=24,e.t1=e.catch(18),alert("Couldn't decode study data: ".concat(e.t1)),e.abrupt("return");case 28:return o=L(l),window.history.pushState({},document.title,"/"),e.abrupt("return",o);case 31:case"end":return e.stop()}}),e,null,[[5,11],[18,24]])})));return function(){return e.apply(this,arguments)}}();var z=function(){var e=Object(l.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=d.createStore,e.t1=F,e.t3=t,e.t3){e.next=7;break}return e.next=6,q();case 6:e.t3=e.sent;case 7:if(e.t2=e.t3,e.t2){e.next=12;break}return e.next=11,V();case 11:e.t2=e.sent;case 12:return e.t4=e.t2,e.t5=Object(p.composeWithDevTools)(),e.abrupt("return",(0,e.t0)(e.t1,e.t4,e.t5));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=a(161),G=a(424),K=a.n(G),X=a(135),Q=a(71),J=a(818),$=a(819),Z=a(820),ee=a(821),te=a(428),ae=a(822),ne=a(425),re=a.n(ne),le=a(185),oe=a(170),ce=a(426),se=a.n(ce);const ie=e=>se()(e).toLowerCase(),me=e=>ie(e.components.root&&e.components.root.metadata&&e.components.root.metadata.title&&e.components.root.metadata.title.trim()||"study");var de=a(160);const pe=(e,t="root",{removeInternals:a=!1}={})=>{const n=e.version,r=e.components,l=e.files,o=l.files,c=l.bundledFiles,s=Object(k.cloneDeep)(Object(k.pick)(r,["root",t,...Object(oe.a)(t,r)]));s.root.children="root"===t?r.root.children:[t];const i=a?Object(k.mapValues)(s,e=>Object(k.omitBy)(e,(e,t)=>t.startsWith("_"))):s,m=Object(de.b)(i),d=Object(k.pickBy)(o,(e,t)=>"embedded"!==e.source||m.includes(t));return JSON.stringify({components:i,version:n,files:{files:d,bundledFiles:c}},null,2)},ue=(e,{exportedComponent:t="root",filenameOverride:a=null,removeInternals:n=!1}={})=>{const r=pe(e,t,{removeInternals:n});let l;if(a)l=a;else{const a="root"===t?me(e):me(e)+"-"+e.components[t].title.toLowerCase(),n=re()().format("YYYY-MM-DD--HH:mm");l="".concat(a,"-").concat(n,".study.json")}const o=new Blob([r],{type:"application/json;charset=utf-8"});return Object(le.saveAs)(o,l)};var he=a(814),be=a(815),Ee=a(816),fe=a(817),ge=a(23),ye=a.n(ge);class we extends o.Component{constructor(e){super(e),this.state={isOpen:!1!==e.open}}render(){const e=this.props,t=e.title,a=e.badge,n=e.children,r=e.className,l=e.collapsable,o=!1!==e.wrapContent?c.a.createElement(he.a,null,n):n;return c.a.createElement(be.a,{style:this.props.style,className:ye()("my-1",r)},t?c.a.createElement(Ee.a,{style:{borderBottomStyle:this.state.isOpen?"solid":"none"},onClick:()=>{l&&this.setState({isOpen:!this.state.isOpen})}},t,a&&c.a.createElement(c.a.Fragment,null,"\xa0",c.a.createElement(fe.a,{color:"secondary"},a))):null,this.state.isOpen?o:null)}}var ve=we;const xe=["Well, crikey","Dangnabbit!","What the cabbage?","What a total cluster-cuss.","Belgium!"],Oe=["https://media.giphy.com/media/XsUtdIeJ0MWMo/giphy.mp4","https://media.giphy.com/media/155lQxHOx9Bni/giphy.mp4","https://media.giphy.com/media/FYenMRUx3LGy4/giphy.mp4","https://media.giphy.com/media/p3RblYx4T7vmU/giphy.mp4","https://media.giphy.com/media/8QIgBwVvZVrG0/giphy.mp4","https://media.giphy.com/media/pPhyAv5t9V8djyRFJH/giphy.mp4","https://media.giphy.com/media/APqEbxBsVlkWSuFpth/giphy.mp4","https://media.giphy.com/media/Rhkq4ehWqVX56/giphy.mp4","https://media.giphy.com/media/fOVGTYyYtV6Ra/giphy.mp4"],ke=({reset:e,error:t,errorInfo:a,eventId:n})=>{const r=Object(o.useState)(!1),l=Object(Q.a)(r,2),s=l[0],i=l[1],d=Object(m.useStore)();return c.a.createElement(J.a,null,c.a.createElement($.a,null,c.a.createElement(Z.a,{sm:{size:4,offset:4},className:"text-center my-4"},c.a.createElement("video",{autoPlay:!0,loop:!0,className:"rounded-circle shadow",style:{width:"300px",height:"300px",marginTop:"10vh",objectFit:"cover"}},c.a.createElement("source",{src:Object(k.sample)(Oe),type:"video/mp4"})))),c.a.createElement($.a,null,c.a.createElement(Z.a,{sm:{size:6,offset:3}},c.a.createElement(ee.a,{color:"danger",className:"my-4"},c.a.createElement("h4",{className:"alert-heading mt-2"},Object(k.sample)(xe)),c.a.createElement("hr",null),c.a.createElement("p",{className:"mb-1"},c.a.createElement("strong",null,"We're really, really sorry, something just went badly wrong.")," In a nutshell, ",c.a.createElement("code",null,"lab.js")," encountered an error it couldn't recover from, and the application can't run or restart. The team has been alerted.")),c.a.createElement(ee.a,{color:"light",style:{background:"white",border:"none"}},c.a.createElement("p",null,c.a.createElement("strong",null,"We want to help you get back to work as quickly as possible.")," Here are a few things to speed up that process:"),c.a.createElement("p",null,"First of all, please make sure you ",c.a.createElement("strong",null,"download a backup")," of the study you've been working on. We can almost certainly help you recover your last change, even if the file doesn't load."),c.a.createElement(te.a,{outline:!0,color:"primary",block:!0,size:"lg",onClick:e=>{ue(d.getState()),i(!0)}},"Download study backup"),c.a.createElement("p",{className:"mt-3"},c.a.createElement("strong",null,"With the backup in hand, you're safe for the moment.")," Please ",c.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://lab.js.org/resources/support/"}," join the support channel")," where we would be happy to help you track down and fix the bug. We make mistakes sometimes, but also love to learn how we can improve things, and would be glad to make things better for everyone!"),c.a.createElement("p",null,"There are two more things you can try. ",c.a.createElement("strong",null,"We recommend to only attempt these in consultation with support.")," You'll need to download a backup of your current study first."),c.a.createElement(ae.a,{className:"w-100"},c.a.createElement(te.a,{outline:!0,className:"w-50 py-3",disabled:!s,onClick:()=>{d.dispatch({type:"SHOW_COMPONENT_DETAIL",id:void 0}),e()}},"Close currently",c.a.createElement("br",null),"open component"),c.a.createElement(te.a,{outline:!0,className:"w-50 py-3",disabled:!s,onClick:()=>{window.confirm("This will discard the currently active study. Are you sure?")&&d.dispatch({type:"RESET_STATE"}),e()}},"Start from scratch",c.a.createElement("br",null),"with an empty study")),c.a.createElement(ve,{title:"Guru meditation / technical details",className:"mt-3",collapsable:!0,open:!1},c.a.createElement("dl",null,c.a.createElement("dt",null,"Error message"),c.a.createElement("dd",null,t&&t.toString()||c.a.createElement("em",null,"(unavailable)")),c.a.createElement("dt",null,"Component stack"),c.a.createElement("dd",{style:{whiteSpace:"pre-wrap"}},a.componentStack||c.a.createElement("em",null,"(unavailable)")),c.a.createElement("dt",null,"EventId"),c.a.createElement("dd",null,n||c.a.createElement("em",null,"(unavailable)"))))))))};ke.defaultProps={error:void 0,errorInfo:{}};var Ce=ke,je=(a(572),a(573),a(574),({sidebar:e,footer:t,children:a})=>c.a.createElement("div",{className:"grid-wrapper"},c.a.createElement("div",{className:"grid-sidebar"},e),c.a.createElement("div",{className:"grid-footer"},t),c.a.createElement("div",{className:"grid-contents"},c.a.createElement(J.a,{fluid:!0,className:"h-100 d-flex flex-column",style:{minWidth:"510px",maxWidth:"1200px",minHeight:"600px",padding:"0"}},a)))),Ne=a(186),Te=a(184),Pe=a(830),Se=a(831),De=a(832),Ie=a(30),Fe=a(114),Ae=a(823),_e=a(824),Me=a(825);a(582);const Re=(e,t,a,n)=>{e.dispatch({type:"ADD_COMPONENT",parent:a,index:n,data:Object(h.a)({},v[t].defaults,{title:v[t].name})}),e.dispatch({type:"SHOW_COMPONENT_DETAIL",id:e.getState().components[a].children[n]}),e.dispatch({type:"HIDE_MODAL"})},Le=({type:e,parent:t,index:a})=>{const n=Object(m.useStore)();return(c.a.createElement(be.a,{className:"add-component-card",onClick:()=>Re(n,e,t,a)},c.a.createElement(Ee.a,{className:"text-center"},c.a.createElement(Ie.a,{icon:v[e].icon,weight:v[e].iconWeight,fallbackWeight:v[e].iconFallbackWeight})),c.a.createElement(he.a,{className:"text-center"},c.a.createElement("h5",{className:"card-title"},v[e].name),c.a.createElement("h6",{className:"card-subtitle mb-2 text-muted",style:{fontWeight:"400"}},v[e].category))))},He=({parent:e,index:t})=>{const a=Object(m.useStore)();return Object.entries(Object.entries(v).reduce((e,[t,a])=>(e[a.category]=[...e[a.category]||[],t],e),{})).map(([n,r])=>c.a.createElement(ve,{key:n,title:n,open:!1,collapsable:!0,wrapContent:!1},c.a.createElement(Ae.a,{className:"list-group-flush"},r.map(n=>c.a.createElement(_e.a,{key:n,tag:"a",href:"#",action:!0,className:"d-flex justify-content-between",onClick:()=>Re(a,n,e,t)},c.a.createElement("span",null,c.a.createElement("strong",null,v[n].name),"\xa0",c.a.createElement("small",{className:"text-muted"},"\xb7 ",v[n].description)),c.a.createElement(Ie.a,{icon:v[n].icon,className:"mt-1",weight:v[n].iconWeight,fallbackWeight:v[n].iconFallbackWeight}))))))};var We,Be=({parent:e,index:t})=>c.a.createElement(c.a.Fragment,null,c.a.createElement(Me.a,{className:"mb-3"},O.map(a=>c.a.createElement(Le,{key:a,type:a,parent:e,index:t}))),c.a.createElement(He,{parent:e,index:t})),Ue=a(826),Ve=a(827),qe=a(828);const ze=null!==(We=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_FA:"free"}).REACT_APP_EXAMPLE_PATH)&&void 0!==We?We:"https://raw.githubusercontent.com/FelixHenninger/lab.js/master/tasks/",Ye=(e="",t,a,n)=>""===e?t:e+(a<n.length-1?", ":" & ")+t,Ge=({name:e,contributors:t,description:a,url:n,clickHandler:r})=>c.a.createElement(_e.a,{action:!0,style:{cursor:"pointer"},onClick:r},c.a.createElement("div",{className:"d-flex w-100 justify-content-between"},c.a.createElement("strong",null,e),c.a.createElement("span",{className:"text-muted"},(t||[""]).filter(e=>!e.includes("Felix Henninger")).reduce(Ye,""))));class Ke extends o.Component{constructor(e){super(e),this.state={state:"empty",tasks:[]}}componentDidMount(){var e=this;return Object(l.a)(r.a.mark((function t(){var a,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e.props.path+"metadata.json");case 3:return a=t.sent,t.next=6,a.json();case 6:n=t.sent,e.setState({state:"loaded",tasks:n}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),e.setState({state:"error"});case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}loadTask(e){var t=this;return Object(l.a)(r.a.mark((function a(){var n,l;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch(t.props.path+e);case 2:return n=a.sent,a.t0=L,a.next=6,n.json();case 6:a.t1=a.sent,l=(0,a.t0)(a.t1),t.props.loadHandler(l,t.context.store.dispatch);case 9:case"end":return a.stop()}}),a)})))()}render(){return"error"===this.state.state?c.a.createElement(Ae.a,{className:"list-group-flush"},c.a.createElement(_e.a,{className:"text-center text-muted"},c.a.createElement("i",{className:"fas fa-exclamation-circle fa-2x mt-3 mb-2"})," ",c.a.createElement("p",null,c.a.createElement("strong",null,"Sorry, I couldn't load the ",this.props.taskLabel),c.a.createElement("br",null),c.a.createElement("small",null,"This shouldn't happen. If it persists even though you're online, could you please"," ",c.a.createElement("a",{href:"http://labjs.readthedocs.io/en/latest/meta/contribute/help.html",target:"_blank",rel:"noopener noreferrer"},"let us know"),"?")))):0===this.state.tasks.length?c.a.createElement(Ae.a,{className:"list-group-flush"},c.a.createElement(_e.a,{className:"text-center"},c.a.createElement("i",{className:"fas fa-spinner-third fa-spin"}))):c.a.createElement(Ae.a,{className:"list-group-flush"},this.state.tasks.map((e,t)=>c.a.createElement(Ge,Object.assign({key:"task-".concat(t),clickHandler:()=>this.loadTask(e.path)},e))))}}Ke.contextType=m.ReactReduxContext,Ke.defaultProps={taskLabel:"tasks"};var Xe=()=>c.a.createElement(c.a.Fragment,null,c.a.createElement(he.a,null,c.a.createElement(Ue.a,{className:"h5 mt-2"},"Examples"),c.a.createElement(Ve.a,{className:"text-muted mb-3"},"Pre-made, ready-to-run studies"),c.a.createElement(qe.a,null,"These examples are made by researchers like you! If you're building a study, we'd love to add it here \u2014 please ",c.a.createElement("a",{href:"https://labjs.readthedocs.io/en/latest/meta/contribute/index.html",target:"_blank",rel:"noopener noreferrer"},"let us know"),"!"),c.a.createElement(qe.a,null,"Please click on any of the paradigms to open it; they're yours to try, demonstrate, replicate and extend.")),c.a.createElement(Ke,{path:ze,taskLabel:"examples",loadHandler:(e,t)=>t({type:"HYDRATE",state:e})}),c.a.createElement(he.a,null,c.a.createElement("small",{className:"text-muted"},"Missing a task? Something to improve? Please ",c.a.createElement("a",{href:"https://labjs.readthedocs.io/en/latest/meta/contribute/index.html",target:"_blank",rel:"noopener noreferrer"},"suggest or contribute"),"!"))),Qe=a(162);const Je=(e,t,a,n)=>{1===a.components.root.children.length?n.dispatch({type:"IMPORT_COMPONENT",parent:e,index:t,id:a.components.root.children[0],source:a.components}):(a.components.root.plugins=a.components.root.plugins.filter(e=>"lab.plugins.Metadata"!==e.type),a.components.root.title=a.components.root.metadata.title||"Unnamed task",n.dispatch({type:"IMPORT_COMPONENT",parent:e,index:t,id:"root",source:a.components})),n.dispatch({type:"MERGE_FILES",files:a.files.files}),n.dispatch({type:"SHOW_COMPONENT_DETAIL",id:n.getState().components[e].children[t]}),n.dispatch({type:"HIDE_MODAL"})};var $e,Ze=({parent:e,index:t})=>{const a=Object(m.useStore)();return(c.a.createElement(Qe.a,{accept:"application/json",multiple:!1,maxSize:55*Math.pow(1024,2),onUpload:([[n]])=>{try{const r=H(n);Je(e,t,r,a)}catch(r){alert("Couldn't load file, found error",r)}}},c.a.createElement("button",{className:"btn btn-outline-secondary btn-lg btn-block"},c.a.createElement("strong",null,"Import component")," from file")))};const et=null!==($e=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_FA:"free"}).REACT_APP_TEMPLATE_PATH)&&void 0!==$e?$e:"https://raw.githubusercontent.com/FelixHenninger/lab.js/master/templates/";var tt=({parent:e,index:t})=>{const a=Object(m.useStore)();return(c.a.createElement("div",null,c.a.createElement("h2",{className:"h5 mt-1"},c.a.createElement("span",null,"Templates")),c.a.createElement("p",null,"Click on any template to include it in your study; they're yours to use and extend. Please consider ",c.a.createElement("a",{href:"https://labjs.readthedocs.io/en/latest/meta/contribute/index.html"},"sharing your own favorites!")),c.a.createElement(be.a,{className:"card-flush"},c.a.createElement(Ke,{path:et,taskLabel:"templates",loadHandler:n=>{try{Je(e,t,n,a)}catch(r){alert("Couldn't load file, found error",r)}}})),c.a.createElement("div",{className:"mt-3"},c.a.createElement("small",{className:"text-muted"},"Missing something? Ideas for improving things? Please ",c.a.createElement("a",{href:"https://labjs.readthedocs.io/en/latest/meta/contribute/index.html",target:"_blank",rel:"noopener noreferrer"},"suggest or contribute"),"!"))))},at=a(829);a(583);var nt=({parent:e,index:t})=>{let a=c.a.createRef();const n=Object(m.useStore)();return(c.a.createElement("div",{className:"copy-component-tab"},c.a.createElement(at.a,{type:"select",bsSize:"lg",name:"copySelect",id:"copySelect",className:"custom-select",innerRef:a},Object(oe.b)(n.getState().components).map(([e,t,a],n)=>c.a.createElement("option",{value:e,key:n},t>0?Object(k.repeat)("\u2003",t-1)+"\u2219 ":"",a.title))),c.a.createElement(ae.a,null,c.a.createElement(te.a,{outline:!0,color:"secondary",onClick:()=>{""!==a.current.value&&(n.dispatch({type:"COPY_COMPONENT",id:a.current.value,parent:e,index:t}),n.dispatch({type:"HIDE_MODAL"}))}},"Copy"),c.a.createElement(te.a,{outline:!0,color:"secondary",onClick:()=>{if(""!==a.current.value){if([a.current.value,...Object(oe.a)(a.current.value,n.getState().components)].includes(e))return void alert("I'm sorry, I'm afraid I can't do that: Cloning a component inside itself would create an endless chain of nested components. Please use a regular copy instead.");n.dispatch({type:"CLONE_COMPONENT",id:a.current.value,parent:e,index:t}),n.dispatch({type:"HIDE_MODAL"})}}},"Clone"))))};const rt=e=>{let t=e.tab,a=Object(Te.a)(e,["tab"]);switch(t){case"new":return c.a.createElement(Be,a);case"template":return c.a.createElement(tt,a);case"copy":return c.a.createElement(nt,a);case"import":return c.a.createElement(Ze,a);default:return c.a.createElement("div",null,"Requested tab not found")}};var lt=a(27),ot=a(833),ct=a(834),st=a(835);const it=(e,t)=>({type:"UPDATE_COMPONENT",id:e,data:t}),mt={updateComponent:it};var dt=Object(m.connect)(e=>({data:e.components.root.metadata}),mt)(({data:e,updateComponent:t})=>c.a.createElement(lt.LocalForm,{initialState:e,onChange:e=>t("root",{metadata:e})},c.a.createElement("h4",{className:"mt-1"},"Study information"),c.a.createElement("p",{className:"text-muted"},"Please tell your fellow scientists a few things about your study."),c.a.createElement("hr",null),c.a.createElement(ot.a,{row:!0},c.a.createElement(ct.a,{for:"title",sm:2},"Title"),c.a.createElement(Z.a,{sm:10},c.a.createElement(lt.Control,{model:".title",id:"title",component:at.a,controlProps:{bsSize:"lg",className:"font-weight-bold"},style:{paddingLeft:"12px"}}))),c.a.createElement(ot.a,{row:!0},c.a.createElement(ct.a,{for:"description",sm:2},"Description"),c.a.createElement(Z.a,{sm:10},c.a.createElement(lt.Control,{id:"description",model:".description",component:at.a,controlProps:{type:"textarea",lines:3}}),c.a.createElement(st.a,{color:"muted"},"What does your study do?"))),c.a.createElement("hr",null),c.a.createElement(ot.a,{row:!0},c.a.createElement(ct.a,{for:"repository",size:"sm",sm:2},"Repository"),c.a.createElement(Z.a,{sm:10},c.a.createElement(lt.Control,{id:"repository",model:".repository",placeholder:"https://osf.io/... / https://github.com/...",component:at.a,controlProps:{bsSize:"sm"},style:{fontFamily:"Fira Code"}}),c.a.createElement(st.a,{color:"muted"},"Where can researchers find the canonical or latest version of your study?"))),c.a.createElement(ot.a,{row:!0},c.a.createElement(ct.a,{for:"contributors",size:"sm",sm:2},"Contributors"),c.a.createElement(Z.a,{sm:10},c.a.createElement(lt.Control,{id:"contributors",model:".contributors",component:at.a,controlProps:{type:"textarea",bsSize:"sm"},placeholder:"Rita Levi-Montalcini <rlm@nobel.example> (http://ibcn.cnr.it)",style:{fontFamily:"Fira Code"}}),c.a.createElement(st.a,{color:"muted"},c.a.createElement("em",null,"One line each, please!")," To keep things tidy, please enter full names (or secret pseudonyms) for everyone who helped build this study. You can also add an email address (in angle brackets) and a link (in round brackets)."))))),pt=a(837),ut=a(218);const ht=()=>c.a.createElement("colgroup",null,c.a.createElement("col",{style:{width:"60px"}}),c.a.createElement("col",{style:{width:"80%"}}),c.a.createElement("col",{style:{width:"20%"}}),c.a.createElement("col",{style:{width:"60px"}})),bt=()=>c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null),c.a.createElement("th",null,"Filename"),c.a.createElement("th",{className:"text-right"},"Size ",c.a.createElement("span",{className:"text-muted font-weight-normal"},"[KB]")),c.a.createElement("th",null))),Et=({path:e,content:t,onDelete:a})=>c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("div",{className:"text-muted text-center",style:{padding:"0.375rem 0.75rem",border:"1px solid transparent",lineHeight:"1.5"}},c.a.createElement(Ie.a,{icon:Object(ut.a)(t),fixedWidth:!0,style:{color:"var(--secondary)",position:"relative",top:"1px"}}))),c.a.createElement("td",{className:"text-monospace"},c.a.createElement("div",{style:{padding:"0.55rem 0 0.2rem"}},e)),c.a.createElement("td",{className:"text-monospace text-right"},c.a.createElement("div",{style:{padding:"0.55rem 0 0.2rem"}},Object(T.e)(t))),c.a.createElement("td",null,c.a.createElement(te.a,{block:!0,outline:!0,color:"muted",onClick:a},c.a.createElement(Ie.a,{icon:"trash",fixedWidth:!0})))),ft=Object(m.connect)(e=>({files:e.files.files}),{deleteFile:e=>({type:"DELETE_FILE",file:e})})(({files:e,sources:t=["embedded-global"],deleteFile:a})=>c.a.createElement("tbody",null,Object(k.sortBy)(Object.entries(e),([e,t])=>e).filter(([e,{source:a}])=>t.includes(a)).map(([e,{content:t}])=>c.a.createElement(Et,{key:e,path:e,content:t,onDelete:()=>a(e)}))));var gt=a(836);var yt=Object(m.connect)(e=>({space:Object.entries(e.files.files).reduce((e,[,{content:t}])=>e+Object(T.e)(t),0)}))(({space:e})=>c.a.createElement(gt.a,{value:e,max:51200,style:{height:"25px"}},c.a.createElement("span",{className:"pl-2"},(e/1024).toFixed(1)," / 50 MB")));const wt=()=>{const e=Object(m.useStore)();return(c.a.createElement(pt.a,{className:"grid border-top-0",style:{borderBottom:"2px solid #eceeef"}},c.a.createElement(ht,null),c.a.createElement(bt,null),c.a.createElement(ft,null),c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("td",null),c.a.createElement("td",{colSpan:"2"},c.a.createElement(Qe.a,{decodeAs:"dataURL",onUpload:t=>{try{Object(de.a)(e,t.map(([e,t])=>({poolPath:"static/".concat(t.name),data:{content:e,source:"embedded-global"}})))}catch(a){console.log("Error while adding file",a),alert("Encountered error while adding file:",a)}}},c.a.createElement(te.a,{size:"sm",block:!0,outline:!0,color:"muted",className:"hover-target"},c.a.createElement(Ie.a,{icon:"plus"})))),c.a.createElement("td",null)))))};var vt=()=>c.a.createElement(c.a.Fragment,null,c.a.createElement("h4",{className:"mt-1"},"Storage in use"),c.a.createElement(yt,null),c.a.createElement("small",{className:"text-muted d-block mt-2"},"While storage is not strictly limited, we strongly recommend that studies use substantially less than 50 MB overall, and ideally below 20MB. This is not because of technical limitations but to reduce loading time and network traffic. If larger media are required, for example videos, these should be hosted outside of the study."),c.a.createElement("hr",null),c.a.createElement("h5",{className:"h5 mt-1"},"Study-wide static files"),c.a.createElement("p",{className:"text-muted"},"The following files are available study-wide from the ",c.a.createElement("code",null,"static")," directory."),c.a.createElement(wt,null)),xt=a(430),Ot=a.n(xt);a(712);class kt extends c.a.Component{editorWillMount(e){e.editor.defineTheme("labjs",{base:"vs",inherit:!0,rules:[{token:"attribute.name",foreground:"0275d8"},{token:"attribute.value",foreground:"569cd6"},{token:"attribute.value.html",foreground:"569cd6"},{token:"comment",foreground:"999999"},{token:"comment.content",foreground:"999999"},{token:"comment.html",foreground:"999999"},{token:"comment.content.html",foreground:"999999"},{token:"keyword",foreground:"0275d8"},{token:"metatag.content",foreground:"0275d8"},{token:"metatag.content.html",foreground:"0275d8"},{token:"metatag.html",foreground:"999999"},{token:"property-name",foreground:"0275d8"},{token:"token.content",foreground:"0275d8"}],colors:{"editor.background":"#ffffff","editorIndentGuide.background":"#eceeef","editorLineNumber.foreground":"#818a91","editorRuler.foreground":"#eceeef"}})}editorDidMount(e,t){const n=e.getModel();n.updateOptions({tabSize:2}),"html"===this.props.language&&a.e(4).then(a.t.bind(null,990,7)).then(({default:e})=>{n.onDidChangeContent(Object(k.throttle)(()=>{const a=e.verify(n.getValue(),{"tagname-lowercase":!0,"attr-lowercase":!0,"attr-value-double-quotes":!0,"tag-pair":!0,"spec-char-escape":!0,"id-unique":!0,"src-not-empty":!0,"attr-no-duplication":!0,"attr-unsafe-chars":!0}).map(e=>({startLineNumber:e.line,startColumn:e.col,endLineNumber:e.line,endColumn:e.col+e.raw.length,message:e.message,severity:1}));t.editor.setModelMarkers(n,"custom-linter",a)},500))}).catch(e=>console.log("Couldn't load HTMLHint:",e))}render(){return c.a.createElement(Ot.a,Object.assign({width:"100%",language:"html",value:"",theme:"labjs",editorDidMount:this.editorDidMount.bind(this),editorWillMount:this.editorWillMount.bind(this)},this.props,{options:Object(h.a)({contextmenu:!1,cursorBlinking:"solid",lineNumbers:!0,lineNumbersMinChars:4,overviewRulerLanes:0,rulers:[80],scrollbar:{useShadows:!1},scrollBeyondLastLine:!1,tabSize:2,wordWrap:"wordWrapColumn",wordWrapColumn:80,wrappingIndent:"indent",fontFamily:"Fira Mono",fontSize:18,lineHeight:26},this.props.options)}))}}a(713);const Ct=({tab:e})=>{const t=Object(m.useStore)(),a=t.getState().files.files;switch(e){case"meta":return c.a.createElement(dt,null);case"files":return c.a.createElement(vt,null);case"html":return c.a.createElement("div",{className:"d-flex flex-column",style:{minHeight:"60vh"}},c.a.createElement(kt,{key:"html",value:Object(T.d)(a["index.html"].content).data,onChange:e=>t.dispatch({type:"UPDATE_FILE",file:"index.html",data:{content:Object(T.b)(e,"text/html")}})}));case"css":return c.a.createElement("div",{className:"d-flex flex-column",style:{minHeight:"60vh"}},c.a.createElement(kt,{key:"css",height:"400",language:"css",value:Object(T.d)(a["style.css"].content).data,onChange:e=>t.dispatch({type:"UPDATE_FILE",file:"style.css",data:{content:Object(T.b)(e,"text/css")}})}));default:return c.a.createElement("div",null,"Requested tab not found")}};var jt=({closeHandler:e})=>{const t=Object(o.useState)("meta"),a=Object(Q.a)(t,2),n=a[0],r=a[1];return(c.a.createElement("div",{className:"modal-content"},c.a.createElement(Pe.a,{tabs:!0},c.a.createElement(Fe.b,{id:"meta",activeId:n,setId:r},c.a.createElement(Ie.a,{icon:"info",weight:"s"})),c.a.createElement(Fe.b,{id:"files",activeId:n,setId:r},c.a.createElement(Ie.a,{icon:"folder"})),c.a.createElement(Fe.b,{id:"html",activeId:n,setId:r},"HTML"),c.a.createElement(Fe.b,{id:"css",activeId:n,setId:r},"CSS"),c.a.createElement(Fe.a,{onClick:e})),c.a.createElement(Se.a,null,c.a.createElement(Ct,{tab:n})),c.a.createElement(De.a,null,c.a.createElement(te.a,{outline:!0,color:"secondary",onClick:e},"Done"))))},Nt=a(838),Tt=({title:e,children:t,confirmLabel:a,confirmHandler:n,closeLabel:r,closeHandler:l})=>c.a.createElement("div",{className:"modal-content"},c.a.createElement(Nt.a,{toggle:l},e),c.a.createElement(Se.a,null,t),c.a.createElement(De.a,null,c.a.createElement(te.a,{outline:!0,color:n?"secondary":"primary",onClick:l},r||"Cancel"),n?c.a.createElement(te.a,{outline:!0,color:"primary",onClick:n},a||"Okay"):null));const Pt=[[Object(k.isNil)(navigator.serviceWorker),c.a.createElement("li",null,"Your browser does not support ",c.a.createElement("a",{href:"http://caniuse.com/#feat=serviceworkers"},"service workers"),", which are required for the study preview. This might be because you are browsing in private mode \u2014 if your browser is up to date, please check whether private mode is active.")],[[Array.from,Object.entries].some(k.isNil),c.a.createElement("li",null,"The browser you are using does not support JavaScript features required by the builder. Please update or switch to a modern browser!")],[Object(k.isNil)(window.localStorage),c.a.createElement("li",null,"Your browser does not offer ",c.a.createElement("a",{href:"https://caniuse.com/#search=localstorage"},"local storage")," capabilities, which we use to keep a backup of your data when you leave the site. You are missing one of our safety nets, please make sure that you save regularly!")]].filter(e=>e[0]).map(e=>e[1]),St=e=>{Pt.length>0&&e.dispatch({type:"SHOW_MODAL",modalType:"SYSTEM_COMPATIBILITY",modalProps:{large:!1}})};var Dt=a(298),It=a.n(Dt);const Ft={fullscreen:{title:"Fullscreen",description:"Enable fullscreen mode for portions of the study",version:"0.1.0",path:"lab.plugins.Fullscreen",files:{},headers:[],options:{message:{label:"Message",type:"text",placeholder:"This experiment requires full screen display"},hint:{label:"Help text",type:"text",placeholder:"Please click to continue in full screen mode"}}},mousetrap:{title:"Mousetrap",description:"Mouse-tracking data collection",version:"0.1.0",path:"global.MousetrapPlugin",files:{},headers:[["comment",{content:"MousetrapPlugin"}],["script",{src:"https://mousetrap.felixhenninger.com/0.1.0/mousetrap.js"}]],options:{mode:{label:"Data format",type:"select",options:[{label:"Mousetrap default",coding:"mousetrap"},{label:"Event stream",coding:"events"}],default:"mousetrap",help:"Standard moustrap output or raw event stream"}}}},At=e=>Ft[e],_t=e=>{const t=Object.entries(e.components).map(([e,t])=>t.plugins||[]).reduce((e,t)=>e.concat(t),[]),a=Object(k.uniqBy)(t,e=>e.type).map(e=>[e.type,At(e.type)]).filter(([,e])=>void 0!==e);return{pluginFiles:a.map(([e,t])=>((e={},t)=>Object(k.fromPairs)(Object.entries(e).map(([e,a])=>["".concat("lib/plugins","/").concat(t,"/").concat(e),a])))(t.files,e)).reduce((e,t)=>Object.assign(e,t),{}),pluginHeaders:a.map(([e,t])=>((e=[],t)=>e.map(([e,a])=>[e,Object(k.mapValues)(a,e=>"string"===typeof e?Object(k.template)(e)({pluginPath:"".concat("lib/plugins","/").concat(t)}):e)]))(t.headers,e)).reduce((e,t)=>e.concat(t),[]),pluginPaths:Object(k.fromPairs)(a.map(([e,t])=>[e,t.path]).filter(([,e])=>void 0!==e))}};var Mt=a(431),Rt=a.n(Mt);const Lt=(e,t)=>{if(void 0===t)return e;switch(t){case"string":return Object(k.toString)(e).trim();case"number":return""===e.trim()?null:Object(k.toNumber)(e);case"boolean":switch(e.trim()){case"true":return!0;case"false":return!1}default:return null}},Ht=/(^|[^\w])await\s+/m,Wt=new Function("return Object.getPrototypeOf(async function(){}).constructor")(),Bt=e=>e.match(Ht)?new Wt(e):new Function(e),Ut=(e,t=null,a)=>e.rows.filter(e=>!e.every(e=>""===e.trim())).map(e=>e.map((e,t)=>Lt(e,a?a[t]:void 0))).map(a=>Object(k.fromPairs)(Object(k.zip)(t||e.columns,a))),Vt=e=>["".concat(e.event)+"".concat(e.filter?"(".concat(e.filter.trim(),")"):"")+"".concat(e.target?" ".concat(e.target.trim()):""),e.label.trim()],qt=e=>{const t=Ut(e,["label","event","target","filter"]).map(Vt);return Object(k.fromPairs)(t)},zt=(e,t)=>{switch(e){case"lab.canvas.Screen":return t.map(e=>Object(k.pick)(e,["type","left","top","angle","width","height","stroke","strokeWidth","fill","text","fontStyle","fontWeight","fontSize","fontFamily","lineHeight","textAlign","textBaseline","src","autoScale","label"]));default:return t}},Yt=(e,t)=>{const a=(e=>{const t=["skipCondition"],a=Object.assign({},Object(k.pickBy)(e,(e,a)=>""!==e&&!(a.startsWith("_")||t.includes(a))),{content:zt(e.type,e.content),files:e.files?(s=e.files,Object(k.fromPairs)(s.rows.map(e=>e[0]).map(e=>[e.localPath.trim(),e.poolPath.trim()]))):{},messageHandlers:e.messageHandlers?(c=e.messageHandlers,Object(k.fromPairs)(c.rows.map(e=>e[0]).filter(e=>""!==e.message.trim()&&""!==e.code.trim()).map(e=>[e.message,Bt(e.code)]))):e.messageHandlers,parameters:e.parameters?(o=e.parameters,Object(k.fromPairs)(o.rows.map(e=>e[0]).filter(e=>""!==e.name.trim()&&""!==e.value.trim()).map(e=>[e.name.trim(),Lt(e.value,e.type)]))):{},items:e.items?(l=e.items,l.rows.map(e=>e[0]).filter(e=>""!==e.label).map(e=>["text","divider"].includes(e.type)?e:Object(h.a)({},e,{name:e.name||ie(e.label||"")}))):null,responses:e.responses?qt(e.responses):{},skip:e.skip||e.skipCondition||void 0,templateParameters:e.templateParameters?(r=e.templateParameters,Ut(r,r.columns.map(e=>e.name.trim()),r.columns.map(e=>e.type))):e.templateParameters,shuffleGroups:e.templateParameters?(n=e.templateParameters.columns||[],Object.values(Object(k.groupBy)(n.filter(e=>void 0!==e.shuffleGroup),"shuffleGroup")).map(e=>e.map(e=>e.name))):e.shuffleGroups});var n,r,l,o,c,s;return Object(k.pickBy)(a,k.identity)})(e[t]);if(a){const t=Object.assign({},a);if(a.children){switch(a.type){case"lab.flow.Sequence":t.content=a.children.map(t=>Yt(e,t));break;case"lab.flow.Loop":Object(k.isEmpty)(a.children)||(t.template=Yt(e,a.children[0]));break;case"lab.canvas.Frame":case"lab.html.Frame":Object(k.isEmpty)(a.children)||(t.content=Yt(e,a.children[0]))}delete t.children}return delete t.id,t}return{}},Gt=e=>(e=>"// Define study\nconst study = lab.util.fromObject(".concat(e,")\n\n// Let's go!\nstudy.run()"))((e=>{const t=Yt(e.components,"root");return Rt()(t,{space:2})})(e)),Kt=([e,t={}])=>{if("comment"===e)return"\x3c!-- ".concat(t.content," --\x3e");{const a=document.createElement(e);return Object.entries(t).forEach(([e,t])=>a.setAttribute(e,t)),a.outerHTML}},Xt=(e,{beforeHeader:t=[],libraryPath:a="lib",dev:n=!1}={})=>[...t,...[["comment",{content:"lab.js library code"}],["script",{src:"".concat(a,"/").concat(n?"lab.dev.js":"lab.js"),"data-labjs-script":"library"}],["script",{src:"".concat(a,"/lab.fallback.js"),"data-labjs-script":"fallback"}],["link",{rel:"stylesheet",href:"".concat(a,"/lab.css")}],["comment",{content:"study code and styles"}],["script",{src:"script.js",defer:!0}],["link",{rel:"stylesheet",href:"style.css"}]]].map(Kt).map((e,t)=>0===t?e:"  ".concat(e)).join("\n"),Qt=(e,t)=>{const a=Object(T.d)(e.files.files["index.html"].content).data;return Object(k.template)(a,{escape:"",evaluate:""})({header:Xt(0,t)})};var Jt=(e,t=(e=>e),{additionalFiles:a={},headerOptions:n={}}={})=>{const r=t(Object(k.cloneDeep)(e)),l=Object(de.b)(r.components),o=Object(k.pickBy)(r.files.files,(e,t)=>"embedded"!==e.source||l.includes(t)),c=_t(r),s=c.pluginFiles,i=c.pluginHeaders,m=c.pluginPaths,d=Object(h.a)({},n,{beforeHeader:[...n.beforeHeader||[],...i]});return r.components=Object(k.mapValues)(r.components,e=>Object(h.a)({},e,{plugins:e.plugins?e.plugins.map(e=>Object(h.a)({},e,{path:Object.keys(m).includes(e.type)?m[e.type]:e.path})):e.plugins})),{files:Object(h.a)({},o,{},s,{},a,{"script.js":{content:Object(T.b)(Gt(r),"application/javascript")},"index.html":{content:Object(T.b)(Qt(r,d),"text/html")}}),bundledFiles:Object(k.fromPairs)(Object.entries(r.files.bundledFiles).map(([e,t])=>[e,Object(h.a)({source:e},t)]))}},$t=a(432),Zt=a.n($t);const ea=function(){var e=Object(l.a)(r.a.mark((function e({files:t,bundledFiles:a}){var n,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Zt.a,l=([e,t])=>{const a=Object(T.d)(t.content),r=a.data,l=a.base64;n.file(e,r,{base64:l})},Object.entries(t).forEach(l),e.next=5,Promise.all(Object.entries(a).map(([e,t])=>fetch("".concat("","/api/_defaultStatic/").concat(t.source)).then(t=>n.file(e,t.blob()))));case 5:return e.next=7,n.generateAsync({type:"blob"});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ta=function(){var e=Object(l.a)(r.a.mark((function e(t,a="study_export.zip"){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ea(t,a);case 3:return n=e.sent,e.abrupt("return",Object(le.saveAs)(n,a));case 7:e.prev=7,e.t0=e.catch(0),X.b(t=>{t.setTag("scope","export"),X.a(e.t0)}),alert("Couldn't export bundle: ".concat(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),aa=(e,t=(e=>e),a)=>ta(Jt(e,t,a),me(e)+"-export.zip");function na(){const e=Object(b.a)(["\n    ","\n    ","\n\n    ","\n    Built by "," with [lab.js](https://lab.js.org)\n  "]);return na=function(){return e},e}let ra=(e,t,a,n)=>{switch(a){case 0:return t;case n.length-1:return 2===n.length?e+" and "+t:e+", and "+t;default:return e+", "+t}};const la=e=>{const t=e.components.root.metadata,a=t.contributors?t.contributors.split("\n").map(e=>It()(e)).map(e=>e.url?"[".concat(e.name,"](").concat(e.url,")"):"".concat(e.name)).reduce(ra):"excellent folks",n=Object(E.a)(na(),t.title||"Study",Object(k.repeat)("=",t.title?t.title.length:5),t.description?"\n    ".concat(t.description,"\n\n    ----\n\n    "):"",a);return Object(T.b)(n)},oa=e=>{const t=e.components.root.metadata,a={name:t.title,exp_id:me(e),url:t.repository,description:t.description,contributors:t.contributors.split("\n").map(e=>e.trim()),template:"lab.js",instructions:"",time:5};return Object(T.b)(JSON.stringify(a,null,2))},ca=e=>(e.components.root.plugins=[...e.components.root.plugins,{type:"lab.plugins.Transmit",url:"/save",encoding:"form",updates:{incremental:!1},callbacks:{setup:function(){this.headers["X-CSRFToken"]=window.csrf_token},full:function(e){e&&e.ok&&(window.location="/next")}}}],e);var sa=function(){var e=Object(l.a)(r.a.mark((function e(t,{container:a=!0}={}){var n,l,o,c,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=Jt(t,ca)).files["readme.md"]={content:la(t)},n.files["config.json"]={content:oa(t)},l=a?"experiments/":"",o=me(t),c=(e,t,a)=>(e["".concat(l).concat(o,"/").concat(a)]=t,e),n.bundledFiles=Object(k.transform)(n.bundledFiles,c,{}),n.files=Object(k.transform)(n.files,c,{}),!a){e.next=18;break}return e.next=11,fetch("https://raw.githubusercontent.com/expfactory/builder-labjs/master/.circleci/config.yml");case 11:return s=e.sent,e.t0=T.b,e.next=15,s.text();case 15:e.t1=e.sent,e.t2=(0,e.t0)(e.t1),n.files[".circleci/config.yml"]={content:e.t2};case 18:ta(n);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var ia=({closeHandler:e})=>{const t=Object(m.useStore)();return(c.a.createElement(Tt,{title:c.a.createElement("span",null,"Export to ",c.a.createElement("strong",null,"the Experiment Factory")),closeHandler:e},c.a.createElement("p",null,c.a.createElement("strong",null,"The Experiment Factory ")," creates reproducible, reusable, and modular study containers. ",c.a.createElement("span",{className:"text-muted"},"If you're getting started, you'll want to start with a new container; alternatively, you can export the study by itself.")),c.a.createElement(ae.a,{vertical:!0,size:"l",className:"w-100"},c.a.createElement(te.a,{block:!0,color:"primary",className:"p-3",onClick:Object(l.a)(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,sa(t.getState());case 2:e();case 3:case"end":return a.stop()}}),a)})))},"Export study in a ",c.a.createElement("strong",null,"new container")),c.a.createElement(te.a,{block:!0,outline:!0,color:"secondary",className:"p-3",onClick:Object(l.a)(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,sa(t.getState(),{container:!1});case 2:e();case 3:case"end":return a.stop()}}),a)})))},"Export study for use in an ",c.a.createElement("strong",null,"existing container")))))},ma=a(438),da=a(800);function pa(){const e=Object(b.a)(["\n  # Enforce HTTPS for subdomain url\n  http://","   https://","          301\n  http://","/* https://","/:splat   301\n\n  # Rewrite paths to create multi-site entries\n  /e/:entry   /e/:entry/index.html              302\n  /e/:entry/* /:splat                           200\n"]);return pa=function(){return e},e}const ua=e=>{const t=Object(T.d)(e.files.files["index.html"].content),a=t.data,n=t.mime;return e.files.files["index.html"].content=Object(T.b)(a.replace("</body>",'\n  <form name="labjs-data" netlify netlify-honeypot="bot-field" hidden>\n    <input name="bot-field">\n    <input type="text" name="dataRaw" />\n    <input type="file" name="dataFile" />\n  </form>\n</body>'),n),e.components.root.plugins=[...e.components.root.plugins,{type:"lab.plugins.Submit"}],e},ha=({site:e})=>Object(T.b)(Object(E.a)(pa(),e,e,e,e));var ba=(e,t)=>((e,t=(e=>e),a)=>ea(Jt(e,t,a)))(e,ua,{_redirects:{content:ha(t)}});const Ea=e=>e&&e.length,fa=Object(o.forwardRef)(({onSubmit:e},t)=>{return c.a.createElement(lt.LocalForm,{ref:t,onSubmit:e},c.a.createElement(ot.a,null,c.a.createElement(ct.a,{for:"site"},"Study domain/site"," ",c.a.createElement("small",{className:"text-muted"},"(optional)")),c.a.createElement(lt.Control,{model:".site",id:"site",component:at.a,placeholder:"random-domain-name.netlify.com",style:{fontFamily:"Fira Code"}}),c.a.createElement(st.a,{color:"muted"},"If you've previously created ",c.a.createElement("a",{href:"https://app.netlify.com/account/sites",target:"_blank",rel:"noopener noreferrer"},"a site for your study"),", you can enter the domain here. Leave empty to create a new site with a preliminary domain name.")),c.a.createElement(ot.a,null,c.a.createElement(ct.a,{for:"apiKey"},"API access code"),c.a.createElement(lt.Control,{model:".apiKey",id:"apiKey",component:at.a,style:{fontFamily:"Fira Code"},validators:{required:Ea,length:(a=64,e=>!e||e.length===a)},validateOn:"change"}),c.a.createElement(lt.Errors,{model:"local.apiKey",component:e=>c.a.createElement(st.a,{color:"danger"},e.children),messages:{required:"We'll need a API key to upload the study",length:"The keys are typically 64 characters long"},show:e=>e.touched||e.submitted}),c.a.createElement(st.a,{color:"muted"},"You'll need to ",c.a.createElement("a",{href:"https://app.netlify.com/account/applications",target:"_blank",rel:"noopener noreferrer"},"create an API token")," or enter an existing one. We don't save or share this information, so make sure to jot it down!")));var a});class ga extends o.Component{constructor(){super(),this.state={widgetState:"form"},this.formRef=Object(o.createRef)()}triggerSubmit(){Object(s.findDOMNode)(this.formRef.current).submit()}send(e){var t=this;return Object(l.a)(r.a.mark((function a(){var n,l,o,c;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.setState({widgetState:"submitting"}),n=e.site?"https://api.netlify.com/api/v1/sites/".concat(e.site,"/deploys"):"https://api.netlify.com/api/v1/sites",a.next=4,ba(t.context.store.getState(),{site:e.site});case 4:return l=a.sent,a.prev=5,a.next=8,fetch(n,{method:"post",headers:{"Content-Type":"application/zip",Authorization:"Bearer ".concat(e.apiKey)},body:l});case 8:if(!(o=a.sent).ok){a.next=16;break}return a.next=12,o.json();case 12:c=a.sent,t.setState({widgetState:"done",site_url:c.ssl_url||"https://".concat(c.subdomain,".netlify.com/"),admin_url:c.admin_url||"https://app.netlify.com/sites/".concat(c.subdomain,"/"),statusCode:o.status,statusText:o.statusText}),a.next=17;break;case 16:t.setState({widgetState:"error",statusCode:o.status,statusText:o.statusText});case 17:a.next=23;break;case 19:a.prev=19,a.t0=a.catch(5),t.setState({widgetState:"error_transmission",statusCode:void 0,statusText:void 0}),console.log("transmission error",a.t0);case 23:case"end":return a.stop()}}),a,null,[[5,19]])})))()}render(){switch(this.state.widgetState){case"submitting":return c.a.createElement("div",{className:"text-center"},c.a.createElement(Ie.a,{icon:"spinner-third",className:"fa-spin"}));case"done":return c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,c.a.createElement("strong",{className:"text-success"},"Uploaded study.")," The final deployment is now in the hands of Netlify, and may take a few moments to complete."),c.a.createElement(Pe.a,{vertical:!0},c.a.createElement(ma.a,null,c.a.createElement(da.a,{href:this.state.site_url,target:"_blank",rel:"noopener noreferrer"},"Open study")),c.a.createElement(ma.a,null,c.a.createElement(da.a,{href:this.state.admin_url,target:"_blank",rel:"noopener noreferrer"},"Site settings"))));case"error":return c.a.createElement("p",null,c.a.createElement("strong",{className:"text-warning"},"Something went wrong.")," We got an error ",c.a.createElement("code",null,this.state.statusCode),", which means ",this.state.statusText,". Please take a look at your ",c.a.createElement("a",{href:"https://app.netlify.com",target:"_blank",rel:"noopener noreferrer"},"Dashboard")," for more detailed information.");case"error_transmission":return c.a.createElement("p",null,c.a.createElement("strong",{className:"text-danger"},"Something went wrong.")," We can't tell exactly what happened, but the transfer of the study to Netlify was cancelled. Could you check your login credentials? Otherwise please take a look at your ",c.a.createElement("a",{href:"https://app.netlify.com",target:"_blank",rel:"noopener noreferrer"},"Dashboard")," for more detailed information.");default:return c.a.createElement(fa,{ref:this.formRef,onSubmit:e=>this.send(e)})}}}ga.contextType=m.ReactReduxContext;var ya=ga;var wa=({closeHandler:e})=>{let t=c.a.createRef();return(c.a.createElement(Tt,{title:c.a.createElement("span",null,"Upload to Netlify"),closeLabel:"Close",closeHandler:e,confirmLabel:"Upload",confirmHandler:()=>{t.current.triggerSubmit()}},c.a.createElement("p",null,c.a.createElement("strong",null,c.a.createElement("a",{href:"https://www.netlify.com/",target:"_blank",rel:"noopener noreferrer"},"Netlify")," will host your study for you and take care of data collection.")," Their service is very easy to use, free for basic studies, and inexpensive for large ones."),c.a.createElement("p",null,"To use Netlify, you'll need to ",c.a.createElement("a",{href:"https://app.netlify.com/signup",target:"_blank",rel:"noopener noreferrer"},"set up an account")," with them. Our documentation describes in more detail ",c.a.createElement("a",{href:"http://labjs.readthedocs.io/en/latest/learn/deploy/4-netlify.html",target:"_blank",rel:"noopener noreferrer"},"how to do that"),"."),c.a.createElement("hr",null),c.a.createElement(ya,{ref:t})))};class va extends o.Component{constructor(){super(),this.state={widgetState:"dormant"}}submit(){var e=this;return Object(l.a)(r.a.mark((function t(){var a,n,l,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({widgetState:"submitting"}),a=e.context.store.getState(),n=pe(a),(l=new window.FormData).append("script",new Blob([n],{type:"application/json;charset=utf-8"}),"labjs-study.json"),l.append("name",a.components.root.metadata.title||"Unnamed study"),l.append("description",a.components.root.metadata.description),t.prev=7,t.next=10,fetch("https://open-lab.online/tests/labjs",{method:"POST",body:l});case 10:(o=t.sent).ok?e.setState({widgetState:"done",site_url:o.url,statusCode:o.status,statusText:o.statusText}):e.setState({widgetState:"error",statusCode:o.status,statusText:o.statusText}),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(7),e.setState({widgetState:"error_transmission",statusCode:void 0,statusText:void 0}),console.log("transmission error",t.t0);case 18:case"end":return t.stop()}}),t,null,[[7,14]])})))()}render(){switch(this.state.widgetState){case"submitting":return c.a.createElement("div",{className:"text-center"},c.a.createElement(Ie.a,{icon:"spinner-third",className:"fa-spin"}));case"done":return c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,c.a.createElement("strong",{className:"text-success"},"Uploaded study.")," Please finalize the transfer by following the link below."),c.a.createElement("a",{className:"btn btn-outline-primary btn-lg btn-block",href:this.state.site_url,target:"_blank",rel:"noopener noreferrer"},"Manage study on Open Lab"));case"error":return c.a.createElement("p",null,c.a.createElement("strong",{className:"text-warning"},"Something went wrong during transmission.")," Open Lab sent us an error ",c.a.createElement("code",null,this.state.statusCode),", which means ",this.state.statusText,".");case"error_transmission":return c.a.createElement("p",null,c.a.createElement("strong",{className:"text-danger"},"Something went wrong.")," We can't tell exactly what happened, but the transfer of the study to Open Lab was cancelled. Could you check your connection?");default:return null}}}va.contextType=m.ReactReduxContext;var xa=va;var Oa=({closeHandler:e})=>{let t=c.a.createRef();return(c.a.createElement(Tt,{title:c.a.createElement("span",null,"Upload to Open Lab"),closeLabel:"Close",closeHandler:e,confirmLabel:"Upload",confirmHandler:()=>{t.current.submit()}},c.a.createElement("p",null,c.a.createElement("strong",null,c.a.createElement("a",{href:"https://www.open-lab.online/",target:"_blank",rel:"noopener noreferrer"},"Open Lab"))," takes care of running your experiment and collecting, storing and managing data. It supports collaboration in projects, customization of task parameters and invitation of participants. The basic version of the application is available for free. "),c.a.createElement(xa,{ref:t})))};const ka={"backend.php":{content:Object(T.b)("<?php\n\n// Define path for the database file\ndefine('DB_PATH', getcwd() . '/data/data.sqlite');\n\n// Establish a database connection\n$db = new PDO('sqlite:' . DB_PATH);\n\n// Throw exceptions when errors occur\n$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n\n// Create table, if necessary\n$db->exec(\n  'CREATE TABLE IF NOT EXISTS labjs (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    session TEXT,\n    timestamp TEXT,\n    url TEXT,\n    metadata TEXT,\n    data TEXT\n  )'\n);\n\n// Establish or continue session\nsession_start([\n  'cookie_lifetime' => 86400, // 24 hours\n  'cookie_httponly' => true,  // Not accessible via JavaScript\n  'read_and_close'  => true,  // Extract information and remove lock\n]);\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Decode transmitted data\n  $data = json_decode(file_get_contents('php://input'), true);\n\n  // (Cursory) validity check\n  if (is_array($data)) {\n    // Setup prepared statement\n    $insert =\n      'INSERT INTO labjs (session, timestamp, url, metadata, data)\n       VALUES (:session, :timestamp, :url, :metadata, :data)';\n    $stmt = $db->prepare($insert);\n\n    // Insert data\n    $stmt->execute(array(\n      ':session' => session_id() ?: 'unknown',\n      ':timestamp' => date('c'),\n      ':url' => isset($data['url']) ? $data['url'] : 'none',\n      ':metadata' => isset($data['metadata']) ? json_encode($data['metadata']) : 'none',\n      ':data' => isset($data['data']) ? json_encode($data['data']) : 'none'\n    ));\n\n    http_response_code(200);\n  } else {\n    http_response_code(400);\n  }\n\n} else {\n  http_response_code(405);\n}\n\n?>","application/php")},"data/.htaccess":{content:Object(T.b)("Deny from all","text/plain")}},Ca=e=>(e.components.root.plugins=[...e.components.root.plugins,{type:"lab.plugins.Transmit",url:"backend.php"}],e);const ja=e=>(e.components.root.plugins=[...e.components.root.plugins,{type:"lab.plugins.PostMessage"}],e);const Na=({url:e})=>{const t=Object(o.useState)({state:"empty",content:""}),a=Object(Q.a)(t,2),n=a[0],s=a[1],i=function(){var e=Object(l.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return a=e.sent,e.next=6,a.text();case 6:n=e.sent,s({state:"loaded",content:n}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),s({state:"error"});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(o.useEffect)(()=>{i(e)},[e]),c.a.createElement("div",{dangerouslySetInnerHTML:{__html:n.content}})};const Ta={ADD_COMPONENT:({parent:e,index:t,closeHandler:a})=>{const n=Object(o.useState)("new"),r=Object(Q.a)(n,2),l=r[0],s=r[1];return(c.a.createElement("div",{className:"modal-content"},c.a.createElement(Pe.a,{tabs:!0},c.a.createElement(Fe.b,{id:"new",activeId:l,setId:s},c.a.createElement(Ie.a,{icon:"plus",weight:"s"})),c.a.createElement(Fe.b,{id:"copy",activeId:l,setId:s},c.a.createElement(Ie.a,{icon:"clone",fallbackWeight:"r"})),c.a.createElement(Fe.b,{id:"template",activeId:l,setId:s},c.a.createElement(Ie.a,{icon:"box-open",fallbackWeight:"s"})),c.a.createElement(Fe.b,{id:"import",activeId:l,setId:s},c.a.createElement(Ie.a,{icon:"folder-open",fallbackWeight:"r"})),c.a.createElement(Fe.a,{onClick:a})),c.a.createElement(Se.a,null,c.a.createElement(rt,{tab:l,parent:e,index:t})),c.a.createElement(De.a,null,c.a.createElement(te.a,{outline:!0,color:"secondary",onClick:a},"Cancel"))))},OPTIONS:jt,SYSTEM_COMPATIBILITY:({closeHandler:e})=>c.a.createElement(Tt,{title:"You're missing out!",closeLabel:"Continue",closeHandler:e},c.a.createElement("p",null,c.a.createElement("strong",{className:"text-danger"},"For the ",c.a.createElement("code",null,"lab.js")," builder to work as it should, it needs functionality that is not available in your browser.")," You'll get the most out of the builder by using ",c.a.createElement("a",{href:"https://getfirefox.com",className:"font-weight-bold"},"Firefox")," or ",c.a.createElement("a",{href:"https://www.google.com/intl/en/chrome/",className:"font-weight-bold"},"Chrome"),"."),c.a.createElement("p",null,"Here's what we found:"),c.a.createElement("ul",{style:{paddingLeft:"1.5rem"}},Pt),c.a.createElement("p",null,c.a.createElement("strong",{className:"text-primary"},"The studies you design will work fine on a much larger range of systems")," \u2014 it's just the builder interface that requires more capabilities.")),EXPORT_EXPFACTORY:ia,EXPORT_NETLIFY:wa,EXPORT_OPENLAB:Oa,EXPORT_PHP:({closeHandler:e})=>{const t=Object(m.useStore)();return(c.a.createElement(Tt,{title:c.a.createElement("span",null,"Export with ",c.a.createElement("code",null,"PHP")," backend"),confirmLabel:"Continue to download",confirmHandler:()=>{var a;a=t.getState(),aa(a,Ca,{additionalFiles:ka}),e()},closeHandler:e},c.a.createElement("p",null,c.a.createElement("strong",null,"You are about to download the study with a ",c.a.createElement("code",null,"PHP")," backend.")," It contains code that will run on your server and collect the data as it accumulates."),c.a.createElement(ee.a,{color:"danger"},c.a.createElement("strong",null,"Though we do our best, we cannot take responsibility for code the runs on your server.")," Please make sure to ",c.a.createElement("a",{href:"http://labjs.readthedocs.io/en/latest/learn/deploy/",className:"alert-link font-weight-bold",target:"_blank",rel:"noopener noreferrer"},"consult the documentation on how to set up data collection correctly"),", and ask your friendly neighborhood IT staff if you're unsure.")))},EXPORT_PM:({closeHandler:e})=>{const t=Object(m.useStore)();return(c.a.createElement(Tt,{title:c.a.createElement("span",null,"Export for ",c.a.createElement("strong",null,"generic survey software")),confirmLabel:"Continue to download",confirmHandler:()=>{var a;a=t.getState(),aa(a,ja),e()},closeHandler:e},c.a.createElement("p",null,c.a.createElement("strong",null,"The copy you're about to download is set up to work with most third-party survey tools")," (e.g. ",c.a.createElement("a",{href:"https://www.limesurvey.org/",target:"_blank",rel:"noopener noreferrer"},"LimeSurvey"),", ",c.a.createElement("a",{href:"https://qualtrics.com/",target:"_blank",rel:"noopener noreferrer"},"Qualtrics")," or ",c.a.createElement("a",{href:"https://www.soscisurvey.com/",target:"_blank",rel:"noopener noreferrer"},"SoSci"),"). This is useful if you're planning to run the study you're building as part of a survey or a larger questionnaire."),c.a.createElement("p",null,"Please check out our documentation to ",c.a.createElement("a",{href:"https://labjs.readthedocs.io/en/latest/learn/deploy/3-third-party.html",target:"_blank",rel:"noopener noreferrer"},"find out how to use ",c.a.createElement("code",null,"lab.js")," in combination with third-party software"),".")))},LEGAL:({closeHandler:e})=>c.a.createElement(Tt,{title:c.a.createElement("span",null,"Legal"),closeLabel:"Done",closeHandler:e},c.a.createElement(Na,{url:"/content/legal.html"}))},Pa={OPTIONS:"xl"};var Sa=Object(m.connect)(e=>e.modal,{hideModal:()=>({type:"HIDE_MODAL"})})(({modalType:e,modalProps:t,hideModal:a})=>{const n=Ta[e];return(c.a.createElement(Ne.a,{isOpen:null!==e,onRequestClose:a,modalProps:Object(h.a)({size:Pa[e]||"md"},t)},void 0!==n?c.a.createElement(n,Object.assign({},t,{closeHandler:a})):""))});const Da=navigator.platform.startsWith("Mac")?"metaKey":"ctrlKey";class Ia extends o.Component{constructor(e){super(e),this.handleKeyDown=this.handleKeyDown.bind(this)}handleKeyDown(e){e[Da]&&"s"===e.key?(e.preventDefault(),e.repeat||ue(this.context.store.getState(),{removeInternals:e.shiftKey})):e[Da]&&"p"===e.key?(window.dispatchEvent(new Event("preview:preempt")),e.preventDefault(),window.dispatchEvent(new Event("preview:show"))):"Backspace"===e.key&&e.target===document.body&&e.preventDefault()}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}render(){return null}}Ia.contextType=m.ReactReduxContext;var Fa=Ia;const Aa=c.a.createContext({previewState:void 0}),_a=({value:e,children:t})=>c.a.createElement(Aa.Provider,{value:e},t),Ma=["lib/lab.css","lib/lab.dev.js","lib/lab.js","lib/lab.js.map","lib/lab.legacy.js","lib/lab.legacy.js.map","lib/lab.fallback.js","lib/loading.svg"],Ra=function(){var e=Object(l.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches.open("labjs-preview");case 2:return t=e.sent,e.next=5,t.addAll(Ma.map(e=>"".concat("","/api/_defaultStatic/").concat(e)));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),La=function(){var e=Object(l.a)(r.a.mark((function e(t,[a,{content:n,type:l}],o){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.put(new Request("/api/".concat(o,"/").concat(a)),new Response(Object(T.a)(n)));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),Ha=function(){var e=Object(l.a)(r.a.mark((function e(t,[a,n],l){var o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.match("/api/_defaultStatic/".concat(a));case 2:if(e.t1=o=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==o;case 6:if(!e.t0){e.next=10;break}e.t2=o,e.next=13;break;case 10:return e.next=12,fetch("/api/_defaultStatic/".concat(a));case 12:e.t2=e.sent;case 13:return c=e.t2,e.next=16,t.put(new Request("/api/".concat(l,"/").concat(a)),c);case 16:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),Wa=function(){var e=Object(l.a)(r.a.mark((function e(t,a,n={},l="labjs_preview"){var o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches.open("labjs-preview");case 2:return o=e.sent,e.next=5,o.keys().then(e=>Promise.all(e.map(e=>e.url.includes("_defaultStatic")?null:o.delete(e))));case 5:return e.prev=5,c=Jt(t,a,n),e.next=9,Promise.all([...Object.entries(c.files).map(e=>La(o,e,l)),...Object.entries(c.bundledFiles).map(e=>Ha(o,e,l)),Ha(o,["lib/lab.dev.js",{type:"application/javascript"}],l)]);case 9:console.log("Preview cache updated successfully"),e.next=20;break;case 12:if(e.prev=12,e.t0=e.catch(5),console.log("Error during preview cache update: ".concat(e.t0)),!W.some(t=>e.t0.message.includes(t))){e.next=18;break}e.next=20;break;case 18:throw X.b(t=>{t.setTag("scope","preview-cache"),X.a(e.t0)}),e.t0;case 20:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t,a){return e.apply(this,arguments)}}(),Ba=e=>(e.components.root.plugins=[...e.components.root.plugins,{type:"lab.plugins.Debug",filePrefix:"".concat(me(e),"-preview")}],e),Ua=e=>(e.components.root.plugins=[...e.components.root.plugins,{type:"lab.plugins.Download",filePrefix:me(e)}],e);class Va{constructor(e,t){this.url=e,this.stateChangeCallback=t,this.window=null,window.addEventListener("beforeunload",()=>{this.close()})}open(){this.window=window.open("".concat("","/api/_defaultStatic/empty.html"),"labjs_preview","menubar=no,location=no,resizable=yes,scrollbars=yes,status=no"),this.window.addEventListener("unload",()=>this.checkWindow(),{once:!0}),this.stateChangeCallback("opened")}close(){this.window&&this.window.close()}reload(e){this.window&&(this.window.location.href=e||this.url)}focus(){this.window.focus()}openOrFocus(){null===this.window||this.window.closed?this.open():this.focus()}checkWindow(){window.setTimeout(()=>{null===this.window||this.window.closed?(this.window=null,this.stateChangeCallback("closed")):this.window.addEventListener("unload",()=>this.checkWindow(),{once:!0})},25)}}class qa extends o.Component{constructor(e){super(e),this.state={windowState:"closed"},this.previewWindow=new Va("".concat("","/api/labjs_preview/index.html"),e=>this.setState({windowState:e})),this.button=c.a.createRef(),this.openPreview=this.openPreview.bind(this),this.simulateClick=this.simulateClick.bind(this)}componentDidMount(){window.addEventListener("preview:show",this.simulateClick)}componentWillUnmount(){window.removeEventListener("preview:show",this.simulateClick)}simulateClick(){this.button.current.onClick()}openPreview(e){var t=this;return Object(l.a)(r.a.mark((function a(){return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.previewWindow.openOrFocus(),a.prev=1,a.next=4,Wa(e.getState(),e=>Ua(Ba(e)),{headerOptions:{dev:!0}});case 4:t.previewWindow.reload(),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(1),t.previewWindow.close(),"QuotaExceededError"===a.t0.name?alert("Sorry, we couldn't generate the preview because the browser wouldn't allow us to use storage space. Could you check whether there's room on your hard drive?"):(console.log("Received error while generating preview: ".concat(a.t0)),X.b(e=>{e.setTag("scope","preview"),X.a(a.t0)}),alert("Sorry, an error occured while we were trying "+"to put together the study preview: ".concat(a.t0)));case 11:case"end":return a.stop()}}),a,null,[[1,7]])})))()}render(){const e=this.state.windowState;return(c.a.createElement(Aa.Consumer,null,({previewActive:t})=>c.a.createElement(m.ReactReduxContext.Consumer,null,({store:a})=>c.a.createElement(te.a,{color:"primary",ref:this.button,onClick:()=>this.openPreview(a),onMouseEnter:()=>{if(t){const e=new Event("preview:preempt");window.dispatchEvent(e)}},disabled:!t},c.a.createElement(Ie.a,{icon:"closed"===e?"play":"sync-alt",weight:"s"})))))}}var za=a(802),Ya=a(852),Ga=a(840),Ka=a(841),Xa=a(301),Qa=a.n(Xa);function Ja(){const e=Object(b.a)(["\n      var resultJson = study.options.datastore.exportJson();\n      jatos.submitResultData(resultJson, jatos.startNextComponent);\n    "]);return Ja=function(){return e},e}const $a=e=>{const t=e.components.root.metadata,a=me(e),n={version:"3",data:{uuid:Qa()(),title:t.title||"Unnamed study",description:t.description||"",groupStudy:!1,dirName:a,comments:"",jsonData:null,componentList:[{uuid:Qa()(),title:t.title||"Unamed study",htmlFilePath:"index.html",reloadable:!0,active:!0,comments:"",jsonData:null}],batchList:[{uuid:Qa()(),title:"Default",active:!0,maxActiveMembers:null,maxTotalMembers:null,maxTotalWorkers:null,allowedWorkerTypes:null,comments:null,jsonData:null}]}};return Object(T.b)(JSON.stringify(n,null,2))},Za=(e,t)=>e=(e=(e=(e=e.replace(/^(\s*)<script src="[\d\w\/\.]+" data-labjs-script="library"><\/script>/gm,'$&\n$1<script src="/assets/javascripts/jatos.js"><\/script>')).replace(/lib\/lab/g,"/study_assets/".concat(t,"/lib/lab"))).replace("script.js","/study_assets/".concat(t,"/script.js"))).replace("style.css","/study_assets/".concat(t,"/style.css")),en=e=>e.replace("study.run()","jatos.onLoad(() => study.run())"),tn=e=>(e.components.root.messageHandlers=e.components.root.messageHandlers||{rows:[]},e.components.root.messageHandlers.rows.push([{title:"JATOS integration",message:"epilogue",code:Object(E.a)(Ja())}]),e);const an=e=>(e.components.root.plugins=[...e.components.root.plugins,{type:"global.Pavlovia"}],e),nn={beforeHeader:[["comment",{content:"pavlovia.org dependencies"}],["script",{type:"text/javascript",src:"lib/vendors/jquery-2.2.0.min.js"}],["script",{type:"text/javascript",src:"lib/labjs-pavlovia-3.0.0.js"}]],libraryPath:"lab.js"};const rn=e=>e.contributors.split("\n").map(e=>It()(e)).filter(e=>e.name&&""!==e.name).map(e=>Object(h.a)({"@type":"Person"},e)),ln=[{"@type":"PropertyValue",name:"sender",description:"Name of component or screen in the study that generated the current data row"},{"@type":"PropertyValue",name:"sender_type",description:"Type of component that generated the current data row"},{"@type":"PropertyValue",name:"sender_id",description:"Position of component in the study hierarchy"},{"@type":"PropertyValue",name:"timestamp",description:"Time and date of data storage"},{"@type":"PropertyValue",name:"meta",description:"Technical browser metadata"},{"@type":"PropertyValue",name:"correct",description:"Response veracity"},{"@type":"PropertyValue",name:"duration",description:"Component presentation duration",unitCode:"C26",unitText:"milliseconds",minValue:0},{"@type":"PropertyValue",name:"ended_on",description:"Reason for component end",levels:["response","timeout","skipped"]},{"@type":"PropertyValue",name:"response",description:"Participant response"},{"@type":"PropertyValue",name:"time_commit",description:"Timestamp of data logging",unitCode:"C26",unitText:"milliseconds",minValue:0},{"@type":"PropertyValue",name:"time_end",description:"Frame timestamp at which component presentation ended",unitCode:"C26",unitText:"milliseconds",minValue:0},{"@type":"PropertyValue",name:"time_render",description:"Frame timestamp at which component was rendered",unitCode:"C26",unitText:"milliseconds",minValue:0},{"@type":"PropertyValue",name:"time_run",description:"Timestamp at which component was initialized",unitCode:"C26",unitText:"milliseconds",minValue:0},{"@type":"PropertyValue",name:"time_show",description:"Frame timestamp at which component was shown on screen",unitCode:"C26",unitText:"milliseconds",minValue:0},{"@type":"PropertyValue",name:"time_switch",description:"Frame timestamp at which the next component was shown",unitCode:"C26",unitText:"milliseconds",minValue:0},{"@type":"PropertyValue",name:"url",description:"Page URL from which study was loaded"}],on=e=>JSON.stringify((e=>{const t=e.components.root.metadata;return{"@context":"http://schema.org","@type":"Dataset",schemaVersion:"Psych-DS 0.1.0",name:"".concat(t.title||"Study"," dataset"),description:t.description,creator:rn(t),variableMeasured:ln}})(e),null,2);var cn=()=>{const e=Object(o.useState)(!1),t=Object(Q.a)(e,2),a=t[0],n=t[1],r=Object(m.useStore)();return c.a.createElement(za.a,{isOpen:a,toggle:()=>n(!a)},c.a.createElement(te.a,{id:"caret",outline:!0,color:"secondary",onClick:e=>ue(r.getState(),{removeInternals:e.shiftKey})},c.a.createElement(Ie.a,{icon:"save",weight:"l",fallbackWeight:"r"})),c.a.createElement(Ya.a,{caret:!0,split:!0,outline:!0,color:"secondary"}),c.a.createElement(Ga.a,null,c.a.createElement(Ka.a,{header:!0},"Study"),c.a.createElement(Ka.a,{onClick:()=>{window.confirm("Are you sure you want to reset the study?")&&r.dispatch({type:"RESET_STATE"})}},"New"),c.a.createElement(Qe.a,{accept:"application/json",multiple:!1,maxSize:255*Math.pow(1024,2),onUpload:([[e]])=>{try{const t=H(e);r.dispatch({type:"HYDRATE",state:t})}catch(t){alert("Couldn't load file, found error",t)}finally{n(!1)}},className:"dropdown-item"},"Open"),c.a.createElement(Ka.a,{onClick:e=>ue(r.getState(),{removeInternals:e.shiftKey})},"Save"),c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"Export for local use"),c.a.createElement(Ka.a,{onClick:()=>{return e=r.getState(),aa(e,Ua);var e}},"Offline data collection"),c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"Deploy study online"),c.a.createElement(Ka.a,{onClick:()=>r.dispatch({type:"SHOW_MODAL",modalType:"EXPORT_PHP",modalProps:{}})},"Generic web host\u2026 ",c.a.createElement("span",{className:"text-muted"},"(PHP backend)")),c.a.createElement(Ka.a,{onClick:()=>r.dispatch({type:"SHOW_MODAL",modalType:"EXPORT_NETLIFY",modalProps:{}})},"Upload to Netlify\u2026 ",c.a.createElement("span",{className:"text-muted"},"(cloud provider)")),c.a.createElement(Ka.a,{onClick:()=>r.dispatch({type:"SHOW_MODAL",modalType:"EXPORT_OPENLAB",modalProps:{}})},"Upload to Open Lab\u2026"),c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"Export as integration"),c.a.createElement(Ka.a,{onClick:()=>r.dispatch({type:"SHOW_MODAL",modalType:"EXPORT_PM",modalProps:{}})},"Generic survey tools\u2026 ",c.a.createElement("span",{className:"text-muted"},"(Qualtrics, etc.)")),c.a.createElement(Ka.a,{onClick:()=>(e=>{const t=Jt(e,tn),a=me(e);t.files["index.html"].content=Object(T.f)(t.files["index.html"].content,Za,a),t.files["script.js"].content=Object(T.f)(t.files["script.js"].content,en);const n=(e,t,n)=>(e["".concat(a,"/").concat(n)]=t,e);t.bundledFiles=Object(k.transform)(t.bundledFiles,n,{}),t.files=Object(k.transform)(t.files,n,{}),t.files["".concat(a,".jas")]={content:$a(e)},ta(t)})(r.getState())},"JATOS ",c.a.createElement("span",{className:"text-muted"},"(Just Another Tool for Online Studies)")),c.a.createElement(Ka.a,{onClick:()=>(e=>{const t=Jt(e,an,{headerOptions:nn}),a=me(e)+"-pavlovia.zip";return t.bundledFiles=Object(k.transform)(t.bundledFiles,(e,t,a)=>(e[a.replace(/^lib/,nn.libraryPath)]=t,e),{}),ta(t,a)})(r.getState())},"Pavlovia"),c.a.createElement(Ka.a,{onClick:()=>r.dispatch({type:"SHOW_MODAL",modalType:"EXPORT_EXPFACTORY",modalProps:{}})},"The Experiment Factory\u2026 ",c.a.createElement("span",{className:"text-muted"},"(v3)")),c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"Generate metadata"),c.a.createElement(Ka.a,{onClick:()=>(e=>{const t=new Blob([on(e)],{type:"application/ld+json;charset=utf-8"});return Object(le.saveAs)(t,"dataset_description.json")})(r.getState())},"Psych-DS sidecar template"," ",c.a.createElement("span",{className:"text-muted"},"(JSON-LD)"))))};a(768);var sn=Object(m.connect)(null,{showModal:e=>({type:"SHOW_MODAL",modalType:e})})(({showModal:e})=>c.a.createElement("div",{className:"toolbar"},c.a.createElement(ae.a,null,c.a.createElement(qa,null))," ",c.a.createElement(ae.a,null,c.a.createElement(cn,null))," ",c.a.createElement(ae.a,null,c.a.createElement(te.a,{outline:!0,color:"secondary",onClick:()=>e("OPTIONS")},c.a.createElement(Ie.a,{icon:"sliders-h",weight:"l"}))))),mn=a(43),dn=a.n(mn);class pn extends o.Component{getChildContext(){return{onNodeClick:this.props.onNodeClick,onNodeAdd:this.props.onNodeAdd,onNodeDelete:this.props.onNodeDelete,onNodeDuplicate:this.props.onNodeDuplicate}}render(){const e=this.props,t=e.Node,a=e.rootId;return(c.a.createElement(t,{id:a,renderBody:!1,parentId:null}))}}pn.childContextTypes={onNodeClick:dn.a.func,onNodeAdd:dn.a.func,onNodeDelete:dn.a.func,onNodeDuplicate:dn.a.func};var un=pn,hn=(a(771),({pinned:e,onClick:t})=>c.a.createElement("div",{className:"addButton ".concat(e?"addButton-pinned":""),onClick:t},c.a.createElement(Ie.a,{icon:"plus"})));a(772);var bn=Object(k.flow)(Object(Y.DropTarget)("node",{drop:(e,t,a)=>{const n=t.getItem(),r=n.id,l=n.parentId,o=n.index,c=e.id,s=e.index;e.dispatch({type:"MOVE_COMPONENT",id:r,oldParent:l,oldIndex:o,newParent:c,newIndex:s})},canDrop:(e,t)=>{const a=t.getItem();return!(a.parentId===e.id&&(a.index===e.index||a.index===e.index-1)||[e.id,...e.parentIds].includes(a.id))}},(e,t)=>({connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),validTarget:t.canDrop()&&t.isOver({shallow:!0})})),Object(m.connect)((e,t)=>({parentIds:Object(oe.c)(t.id,e.components)})))(e=>e.connectDropTarget(c.a.createElement("div",{className:ye()({dropTarget:!0,"dropTarget-available":e.canDrop,"dropTarget-hover":e.validTarget&e.canDrop,"dropTarget-children":e.children})},e.children||c.a.createElement("div",{className:"dropTargetButton"})))),En=a(842);a(773);var fn=Object(m.connect)(null,{collapseComponent:e=>({type:"COLLAPSE_COMPONENT",id:e})})(({id:e,parent:t,index:a,collapsed:n,hasChildren:r,onDelete:l,onDuplicate:o,collapseComponent:s})=>{const i=Object(m.useStore)();return(c.a.createElement(En.a,null,c.a.createElement(Ya.a,{caret:!0,size:"sm",outline:!0,color:"secondary"}),c.a.createElement(Ga.a,{right:!0},c.a.createElement(Ka.a,{header:!0},"Actions"),c.a.createElement(Ka.a,{onClick:()=>ue(i.getState(),{exportedComponent:e})},"Export"),c.a.createElement(Ka.a,{onClick:()=>o(e,t,a)},"Duplicate"),c.a.createElement(Ka.a,{onClick:()=>l(e,t,a)},"Delete"),r?c.a.createElement("div",null,c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"View"),c.a.createElement(Ka.a,{onClick:()=>s(e)},n?"Expand":"Collapse")):null)))});a(774);const gn=({id:e,parent:t,index:a,children:n,active:r,collapsed:l,skipped:o,tardy:s,isDragging:i,hasChildren:m},{onNodeClick:d,onNodeDelete:p,onNodeDuplicate:u})=>c.a.createElement(da.a,{href:"#",active:r,className:ye()({isDragging:i,"text-muted":o})},c.a.createElement("div",{className:"nav-link-main",onClick:t=>d(t,e)},n,l?c.a.createElement(Ie.a,{icon:"plus"}):null,o?c.a.createElement(Ie.a,{icon:"minus-circle"}):null,s?c.a.createElement(Ie.a,{icon:"alarm-clock"}):null),c.a.createElement("div",{className:"nav-link-tools"},c.a.createElement(fn,{id:e,parent:t,index:a,collapsed:l,hasChildren:m,onDelete:p,onDuplicate:u})));gn.contextTypes={onNodeClick:dn.a.func,onNodeDelete:dn.a.func,onNodeDuplicate:dn.a.func};const yn=({id:e,index:t,onNodeAdd:a,pinned:n})=>c.a.createElement("div",{className:"nodeGap"},n?c.a.createElement(bn,{id:e,index:t},c.a.createElement(hn,{id:e,index:t,onClick:()=>a(e,t),pinned:n})):c.a.createElement("div",null,c.a.createElement(bn,{id:e,index:t}),c.a.createElement(hn,{id:e,index:t,onClick:()=>a(e,t)}))),wn=({id:e,children:t,pinned:a,vacancies:n},{onNodeAdd:r})=>c.a.createElement(Pe.a,{pills:!0,className:"flex-column"},n?c.a.createElement(yn,{id:e,index:0,pinned:a,onNodeAdd:r}):null,t.map((t,a)=>c.a.createElement(ma.a,{key:"".concat(e,"_").concat(a,"_").concat(t)},c.a.createElement(On,{id:t,parentId:e,index:a}),n?c.a.createElement(yn,{id:e,index:a+1,onNodeAdd:r}):null)));wn.contextTypes={onNodeAdd:dn.a.func};const vn=Object(m.connect)((e,t)=>({data:e.components[t.id],active:t.id===e.componentDetail.viewProps.id}))(({id:e,parentId:t,index:a,data:n,active:r,renderBody:l,isDragging:o,connectDragSource:s})=>{const i=n.type,m=n._collapsed,d=n._template,p=v[i],u=p.minChildren,h=p.maxChildren,b=n.children||[],E=b.length<u&&b.length<h,f=b.length<h;return c.a.createElement("div",{className:"tree-node"},!1!==l?s(c.a.createElement("div",null,c.a.createElement(gn,{id:e,parent:t,index:a,hasChildren:(b||[]).length>0,active:r,collapsed:m,skipped:n.skip,tardy:n.tardy,isDragging:o},n.title))):null,m||d?null:c.a.createElement(wn,{id:e,children:b||[],pinned:E,vacancies:f}))}),xn={beginDrag:e=>({id:e.id,parentId:e.parentId,index:e.index})};const On=Object(Y.DragSource)("node",xn,(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))(vn);var kn=On;var Cn=Object(m.connect)(null,{collapseComponent:e=>({type:"COLLAPSE_COMPONENT",id:e}),deleteComponent:(e,t,a)=>({type:"DELETE_COMPONENT",id:e,parent:t,index:a}),duplicateComponent:(e,t,a)=>({type:"COPY_COMPONENT",id:e,parent:t,index:a+1}),showComponentDetail:e=>({type:"SHOW_COMPONENT_DETAIL",id:e}),showAddModal:(e,t)=>({type:"SHOW_MODAL",modalType:"ADD_COMPONENT",modalProps:{parent:e,index:t}})})(({collapseComponent:e,deleteComponent:t,duplicateComponent:a,showComponentDetail:n,showAddModal:r})=>c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{style:{textAlign:"center"}},c.a.createElement(sn,null)),c.a.createElement("hr",{style:{marginBottom:"14px"}}),c.a.createElement(un,{Node:kn,rootId:"root",onNodeClick:(t,a)=>{t.shiftKey?e(a):n(a)},onNodeDelete:(e,a,n)=>{window.confirm("Do you really want to delete this component?")&&t(e,a,n)},onNodeDuplicate:a,onNodeAdd:r}))),jn=a(843),Nn=a(844),Tn=a(845);a(775);const Pn=({id:e,onClick:t})=>c.a.createElement("span",{id:e,onClick:t},c.a.createElement(Ie.a,{icon:"info-circle",className:"hint-icon",title:"More information"}),c.a.createElement("span",{className:"sr-only"},"More information"));class Sn extends o.Component{constructor(e){super(e),this.id=this.props.id||Object(k.uniqueId)("hint_"),this.target=this.props.target||Pn,this.toggle=this.toggle.bind(this),this.state={isOpen:!1}}toggle(e){e&&e.preventDefault(),this.setState({isOpen:!this.state.isOpen})}render(){const e=this.target;return(c.a.createElement("span",{className:this.props.className,style:this.props.style}," ",c.a.createElement(e,{id:this.id,onClick:this.toggle}),c.a.createElement(jn.a,{target:this.id,placement:this.props.placement||"bottom",trigger:"legacy",delay:0,isOpen:this.state.isOpen,toggle:this.toggle},c.a.createElement(Nn.a,null,this.props.title),c.a.createElement(Tn.a,null,this.props.children))))}}const Dn=()=>c.a.createElement(Sn,{target:({id:e,onClick:t})=>c.a.createElement("span",{id:e,onClick:t,style:{cursor:"pointer"}},"Help"),title:"Finding help"},c.a.createElement("p",{className:"mt-1"},c.a.createElement("strong",null,"We would love to help you build your research!")," ","Here are some resources to get you started and assist you while you're using ",c.a.createElement("code",null,"lab.js"),":"),c.a.createElement("p",null,"The ",c.a.createElement("a",{className:"font-weight-bold",target:"_blank",rel:"noopener noreferrer",href:"https://labjs.readthedocs.io"},"online documentation")," provides tutorials, useful tricks, and detailed technical reference. It is probably the best place to gain an overview."),c.a.createElement("p",null,"You're always welcome to ",c.a.createElement("a",{className:"font-weight-bold",target:"_blank",rel:"noopener noreferrer",href:"https://slackin-nmbrcrnchrs.herokuapp.com/"},"join the project chat"),", where fellow users will answer questions and help you get unstuck. If you can, please pay it forward by helping in turn."),c.a.createElement("p",null,"You've probably already spotted the ",c.a.createElement(Ie.a,{icon:"info-circle",className:"text-muted"})," symbols in the interface; they provide further ",c.a.createElement("strong",null,"contextual information"),", which you can access by clicking on them."),c.a.createElement("p",null,"As always, if something isn't working as you'd expect, please ",c.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://labjs.readthedocs.io/en/latest/meta/contribute/ways.html"},"let us know"),"!")),In=Object(m.connect)(null,{showModal:(e,t)=>({type:"SHOW_MODAL",modalType:e,modalProps:t})})(({showModal:e})=>c.a.createElement(Sn,{target:({id:e,onClick:t})=>c.a.createElement("span",{id:e,onClick:t,style:{cursor:"pointer"}},"Imprint"),title:"Imprint"},c.a.createElement("p",null,c.a.createElement("strong",null,"Thank you for using ",c.a.createElement("a",{href:"https://felixhenninger.github.io/lab.js",className:"font-weight-bold",target:"_blank",rel:"noopener noreferrer"},c.a.createElement("code",null,"lab.js"))," \u2014 ",c.a.createElement("br",null),"It's a pleasure to have you around!"),c.a.createElement("br",null),"Here's some information to help keep our lawyers happy, too."),c.a.createElement("h6",null,"Authors"),c.a.createElement("p",null,"This software is developed by ",c.a.createElement("a",{href:"http://felixhenninger.com",target:"_blank",rel:"noopener noreferrer"},"Felix Henninger"),", with help from many awesome ",c.a.createElement("a",{href:"https://github.com/felixhenninger/lab.js#contributors",target:"_blank",rel:"noopener noreferrer"},"contributors"),". Felix is a member of the ",c.a.createElement("a",{href:"https://www.cognition.uni-landau.de/",target:"_blank",rel:"noopener noreferrer"},"University of Landau Cognition Lab")," and a student at the ",c.a.createElement("a",{href:"http://gess.uni-mannheim.de/"},"University of Mannheim"),"."),c.a.createElement(te.a,{size:"sm",block:!0,color:"primary",outline:!0,className:"mb-2",onClick:()=>e("LEGAL",{large:"true"})},"Legal"))),Fn=()=>c.a.createElement("small",{className:"text-muted"},c.a.createElement(Dn,null)," \xb7"," ",c.a.createElement(In,null));a(776);var An=a(435),_n=a.n(An);const Mn=Object(k.sample)(["built with \u2665\ufe0e"]);var Rn=()=>c.a.createElement("footer",null,c.a.createElement("hr",null),c.a.createElement("div",{className:"d-flex justify-content-between"},c.a.createElement("a",{className:"text-muted text-decoration-none logo",href:"https://lab.js.org/",target:"_blank",rel:"noopener noreferrer"},c.a.createElement("img",{alt:"lab.js logo",src:_n.a})," ",c.a.createElement("small",null,Mn)),c.a.createElement(Fn,null))),Ln=a(846),Hn=a(847),Wn=a(853);const Bn={Files:"folder",Parameters:"box-open",Plugins:"plug",More:"ellipsis-h"},Un=({title:e,typeCategory:t,typeName:a,template:n,icon:r,iconWeight:l,iconFallbackWeight:o,onChange:s})=>c.a.createElement(lt.LocalForm,{initialState:{title:e},onChange:e=>s(e),style:{width:"40%"}},c.a.createElement(ot.a,{className:"mr-sm-2"},c.a.createElement(Ln.a,null,c.a.createElement(lt.Control,{model:"local.title",placeholder:"Title",className:"form-control form-control-lg font-weight-bold",style:{padding:"0.5rem 0.75rem",height:"42px"},debounce:250}),c.a.createElement(Hn.a,{addonType:"append"},c.a.createElement("span",{className:"input-group-text"},c.a.createElement(Ie.a,{id:"typeIcon",icon:r,fixedWidth:!0,weight:l,fallbackWeight:o})),c.a.createElement(Wn.a,{placement:"right",target:"typeIcon"},n?"Template":c.a.createElement("span",null,a,c.a.createElement("span",{className:"text-muted"}," \xb7 ",t))))))),Vn=({tabs:e,tab:t,onChange:a})=>c.a.createElement(Pe.a,{pills:!0}," ",e.map(e=>c.a.createElement(ma.a,{key:e},c.a.createElement(da.a,{href:"#",className:ye()({active:t===e}),style:{height:"42px",padding:"9px 16px 7px",minWidth:"2.8rem",textAlign:"center"},onClick:()=>a(e)},Bn[e]?c.a.createElement(Ie.a,{icon:Bn[e],weight:"s",fixedWidth:!0}):e)))," "),qn={updateComponent:it};var zn=Object(m.connect)(e=>{const t=e.componentDetail.viewProps.id;if(e.components[t]){const a=e.components[t],n=a.type,r=a.title,l=a._tab;return{key:t,id:t,type:n,title:r,template:a._template,tab:x(l,n)}}return{id:void 0}},qn)(({id:e,type:t,title:a,tab:n,template:r,updateComponent:l})=>{if(e){const o=v[t].tabs.filter(e=>!r||e===n||["Parameters","More"].includes(e));return(c.a.createElement("div",{className:"d-flex justify-content-between"},c.a.createElement(Un,{id:e,title:a,typeName:v[t].name,typeCategory:v[t].category,template:r,icon:r?"box-open":v[t].icon,iconWeight:v[t].iconWeight,iconFallbackWeight:v[t].iconFallbackWeight,onChange:t=>l(e,t)}),c.a.createElement(Vn,{tabs:o,tab:n,onChange:t=>l(e,{_tab:t})})))}return null}),Yn=a(848);a(777);const Gn=()=>c.a.createElement(he.a,{style:{textAlign:"center"}},c.a.createElement("h2",{style:{margin:"2rem 0 1rem"}},"Welcome!"),c.a.createElement(qe.a,{className:"mb-3"},c.a.createElement("strong",null,"Thank you for using ",c.a.createElement("code",null,"lab.js"),"!"),c.a.createElement("br",null),"We hope you find it useful, and that",c.a.createElement("br",null),"you enjoy using it as much as we did building it.")),Kn=({icon:e,children:t,active:a,borderRight:n,borderBottom:r,onClick:l})=>c.a.createElement(Z.a,{className:ye()("splash-tab-icon","pt-4 pb-3",{active:a,"border-right":n,"border-bottom":r}),style:{cursor:a?"default":"pointer"},onClick:a?void 0:l},c.a.createElement(Ie.a,{icon:e,className:"fa-2x d-block mt-2 mb-3"}),t,c.a.createElement(Ie.a,{icon:"angle-down",className:ye()("d-block",a?"visible":"invisible","text-muted","mt-1")})),Xn=({icon:e,onClick:t,children:a})=>c.a.createElement(Z.a,{className:"pt-3 pb-4",style:{cursor:"pointer"},onClick:t},c.a.createElement(Ie.a,{icon:e,className:"fa-2x d-block mt-2 mb-3"}),a),Qn={start:{title:c.a.createElement("p",{className:"mb-1"},c.a.createElement("strong",null,"Get started")),icon:"map",content:e=>c.a.createElement(J.a,null,c.a.createElement($.a,{className:"text-center pt-3 pb-2"},c.a.createElement(Xn,{icon:"shoe-prints",onClick:()=>alert("Sorry, but this isn't quite ready yet. Please join us on Slack and we'd be happy to give you a personal tour!")},c.a.createElement("p",{className:"mb-1"},"Take a ",c.a.createElement("strong",null,"tour")),c.a.createElement("p",{className:"mb-0 text-muted"},c.a.createElement("small",null,"We'd love to",c.a.createElement("br",null),"show you around!")),c.a.createElement(fe.a,null,"Alpha")),c.a.createElement(Xn,{icon:"book-open",onClick:()=>window.open("https://lab.js.org/docs/en/latest/learn/builder/","_blank")},c.a.createElement("p",{className:"mb-1"},"Watch the",c.a.createElement("br",null),c.a.createElement("strong",null,"tutorial")),c.a.createElement("p",{className:"mb-0 text-muted"},c.a.createElement("small",null,"... and build a study step by step"))),c.a.createElement(Xn,{icon:"rocket",onClick:()=>e("examples")},c.a.createElement("p",{className:"mb-1"},"Browse some",c.a.createElement("br",null),c.a.createElement("strong",null,"examples")))))},learn:{title:c.a.createElement("p",{className:"mb-1"},c.a.createElement("strong",null,"Learn")," more"),icon:"graduation-cap",content:e=>c.a.createElement(J.a,{className:"py-4"},c.a.createElement("p",null,c.a.createElement("strong",null,"Wow, it's cool that you're interested!")," Here are some things we hope you'll find helpful:"),c.a.createElement("ul",null,c.a.createElement("li",null,"We've collected ",c.a.createElement("a",{href:"https://lab.js.org/docs/en/latest/recipes/",target:"_blank",rel:"noopener noreferrer"},"tips, tricks and recipes")," for common use cases."),c.a.createElement("li",null,"Maybe the paradigm you're looking for is already among the"," ",c.a.createElement("a",{href:"#example-tab",onClick:t=>{t.preventDefault(),e("examples")}},"examples"),"?"),c.a.createElement("li",null,"The ",c.a.createElement("a",{href:"https://lab.js.org/docs/en/latest/reference/",target:"_blank",rel:"noopener noreferrer"},"reference documentation")," covers the nitty-gritty library internals.")))},support:{title:c.a.createElement("p",{className:"mb-1"},"Find ",c.a.createElement("strong",null,"support")),icon:"life-ring",content:()=>c.a.createElement(J.a,{className:"py-4"},c.a.createElement("p",null,c.a.createElement("strong",null,"We'd love to support you!")," Please don't hesitate to reach out if there's anything we can do to help, we'd be glad to."),c.a.createElement("p",null,"The easiest way to find help is our ",c.a.createElement("a",{href:"https://lab.js.org/resources/support/",target:"_blank",rel:"noopener noreferrer"},c.a.createElement("strong",null,"support channel")),", where there's usually someone around to chat and provide information. You can ",c.a.createElement("a",{href:"https://lab.js.org/resources/support/",target:"_blank",rel:"noopener noreferrer"},"join by providing your email address")," \u2014 you'll receive access in seconds."),c.a.createElement("div",{className:"text-center"},c.a.createElement(Ie.a,{icon:"heart-circle"})))}},Jn=({switchTab:e})=>{const t=Object(o.useState)(void 0),a=Object(Q.a)(t,2),n=a[0],r=a[1];return(c.a.createElement(c.a.Fragment,null,c.a.createElement(J.a,{className:"border-top text-center"},c.a.createElement($.a,null,Object.entries(Qn).map(([e,t],a)=>c.a.createElement(Kn,{key:"splash-tab-".concat(e),icon:t.icon,onClick:()=>r(e),active:n===e,borderRight:a!==Object.entries(Qn).length-1,borderBottom:void 0!==n&&n!==e},t.title)))),c.a.createElement(Yn.a,{isOpen:void 0!==n},void 0!==n?Qn[n].content(e):"")))};var $n=({switchTab:e})=>c.a.createElement(c.a.Fragment,null,c.a.createElement(Gn,null),c.a.createElement(Jn,{switchTab:e}));const Zn=({tab:e,setTab:t})=>{switch(e){case"splash":return c.a.createElement($n,{switchTab:e=>t(e)});case"examples":return c.a.createElement(Xe,null);default:return c.a.createElement("div",null,"Requested tab not found")}};var er=()=>{const e=Object(o.useState)("splash"),t=Object(Q.a)(e,2),a=t[0],n=t[1];return(c.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},c.a.createElement(be.a,{style:{width:"500px"}},c.a.createElement(Ee.a,null,c.a.createElement(Pe.a,{tabs:!0,className:"card-header-tabs justify-content-center"},c.a.createElement(Fe.b,{id:"splash",activeId:a,setId:n},c.a.createElement(Ie.a,{icon:"heart"})),c.a.createElement(ma.a,null,c.a.createElement(da.a,{id:"splash-tab-examples",className:ye()({active:"examples"===a}),onClick:()=>n("examples")},c.a.createElement(Ie.a,{icon:"rocket"})),c.a.createElement(Wn.a,{target:"splash-tab-examples",placement:"bottom",delay:{show:0,hide:100}},"Examples")))),c.a.createElement(Zn,{tab:a,setTab:n}))))},tr=()=>c.a.createElement("div",{style:{textAlign:"center"}},c.a.createElement(Ie.a,{icon:"exclamation-circle",weight:"s",style:{fontSize:"5rem",color:"var(--gray)",marginTop:"3rem"}}),c.a.createElement("h2",{style:{margin:"2rem 0 1rem"}},"No component selected"),c.a.createElement("p",null,c.a.createElement("strong",null,"Please select a component on the left to get started"),",",c.a.createElement("br",null),"or add a new one via the plus button if you haven't already.")),ar=()=>c.a.createElement("div",{className:"text-center"},c.a.createElement("i",{className:"fas fa-spinner-third fa-spin my-3"})),nr=a(284);const rr=Object(o.lazy)(()=>Promise.all([a.e(3),a.e(6)]).then(a.bind(null,991)));var lr=({formDispatch:e,data:t})=>c.a.createElement(ve,{title:"Timeline",badge:"Beta",wrapContent:!1},c.a.createElement(o.Suspense,{fallback:c.a.createElement(ar,null)},c.a.createElement(rr,{data:t,formDispatch:e})),c.a.createElement("hr",null),c.a.createElement(he.a,null,c.a.createElement(ot.a,{row:!0},c.a.createElement(ct.a,{for:"timeout",xs:"2"},"Timeout",c.a.createElement(Sn,{title:"Timeout",className:"float-right"},c.a.createElement("p",{className:"font-weight-bold"},"End component automatically after a given number of milliseconds."),c.a.createElement("p",{className:"text-muted"},"If responses are defined alongside a timeout, whichever comes first will end the component."))),c.a.createElement(Z.a,{xs:"10"},c.a.createElement(Ln.a,null,c.a.createElement(lt.Control,{model:".timeout",placeholder:"Never",pattern:nr.b,component:at.a,id:"timeout",style:{fontFamily:"Fira Mono"},debounce:300}),c.a.createElement(Hn.a,{addonType:"append"},c.a.createElement("span",{className:"input-group-text text-muted"},"ms"))))))),or=({icon:e,onClick:t,style:a,disabled:n=!1,type:r})=>{const l=r||"td";return(c.a.createElement(l,null,c.a.createElement(te.a,{block:!0,outline:!0,color:"muted",onClick:t,style:a,disabled:n},c.a.createElement(Ie.a,{icon:e}))))};const cr=({columnWidths:e},{uniqueId:t})=>c.a.createElement("colgroup",null,c.a.createElement("col",{style:{width:"5%"}}),e.map((e,a)=>c.a.createElement("col",{key:"grid_".concat(t,"_colgroup_").concat(a),style:{width:"".concat(e,"%")}})),c.a.createElement("col",{style:{width:"5%"}}));cr.contextTypes={uniqueId:dn.a.string};var sr=cr;const ir=({columns:e,addColumns:t,maxColumns:a,HeaderContent:n},{uniqueId:r,gridDispatch:l})=>c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null),e.length>0?e.map((e,t)=>c.a.createElement("th",{key:"grid_".concat(r,"_column_").concat(t)},c.a.createElement(n,{columnData:e,index:t}))):c.a.createElement("th",null),t&&e.length<a?c.a.createElement(or,{type:"th",icon:"plus",style:{height:"42px"},onClick:()=>l("addColumn")}):c.a.createElement("th",null)));ir.contextTypes={gridDispatch:dn.a.func,uniqueId:dn.a.string};var mr=ir;const dr=({cellData:e,cellProps:t,rowIndex:a,colIndex:n,colData:r,BodyContent:l})=>c.a.createElement("td",null,c.a.createElement(l,Object.assign({cellData:e,rowIndex:a,colIndex:n,colData:r},t))),pr=({data:e,rowData:t,rowIndex:a,BodyContent:n,LeftColumn:r,RightColumn:l,columns:o,cellProps:s,isFirstRow:i,isLastRow:m},{uniqueId:d})=>c.a.createElement("tr",null,c.a.createElement(r,{data:e,rowData:t,rowIndex:a,isFirstRow:i,isLastRow:m}),t.length>0?t.map((e,t)=>c.a.createElement(dr,{key:"grid_".concat(d,"_cell_").concat(a,"_").concat(t),cellData:e,cellProps:s,rowIndex:a,colIndex:t,colName:o[t],BodyContent:n})):c.a.createElement("td",null),c.a.createElement(l,{data:e,rowData:t,rowIndex:a,isFirstRow:i,isLastRow:m}));pr.contextTypes={uniqueId:dn.a.string};const ur=(e,{uniqueId:t})=>c.a.createElement("tbody",null,e.data.map((a,n)=>c.a.createElement(pr,Object.assign({key:"grid_".concat(t,"_row_").concat(n),rowData:a,rowIndex:n,isFirstRow:0===n,isLastRow:n===e.data.length-1},e))));ur.contextTypes={uniqueId:dn.a.string};var hr=ur;const br=({columns:e},{gridDispatch:t})=>c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("td",null),c.a.createElement("td",{colSpan:e.length},c.a.createElement(te.a,{block:!0,size:"sm",outline:!0,color:"muted",className:"hover-target",onClick:()=>t("addRow"),onMouseUp:e=>e.target.blur()},c.a.createElement(Ie.a,{icon:"plus"}))),c.a.createElement("td",null)));br.contextTypes={gridDispatch:dn.a.func};var Er=br;a(778);const fr=(e,{readOnly:t})=>c.a.createElement(or,{icon:"bars",onClick:()=>null,disabled:t});fr.contextTypes={readOnly:dn.a.bool};const gr=({rowIndex:e},{readOnly:t,gridDispatch:a})=>c.a.createElement(or,{icon:"trash",onClick:()=>a("deleteRow",e),disabled:t});gr.contextTypes={gridDispatch:dn.a.func,readOnly:dn.a.bool};class yr extends o.Component{constructor(e){super(e),this.uniqueId=Object(k.uniqueId)("grid_"),this.dispatch=this.dispatch.bind(this)}getChildContext(){return{gridDispatch:this.dispatch,formDispatch:this.props.formDispatch,readOnly:this.props.readOnly,uniqueId:this.uniqueId}}dispatch(e,t){switch(e){case"change":return this.handleChange(t.model,t.value);case"addColumn":return this.handleColumnAdd();case"deleteColumn":return this.handleColumnDelete(t);case"fillColumn":return this.handleColumnFill(t);case"clearColumn":return this.handleColumnClear(t);case"addRow":case"addRows":return this.handleRowAdd(t);case"deleteRow":return this.handleRowDelete(t);case"moveRow":return this.handleRowMove(t.from,t.to);case"overwrite":return this.handleOverwrite(t);case"reload":return this.handleReload();default:return}}handleChange(e,t){this.props.formDispatch(lt.actions.change(e,t))}handleColumnAdd(){this.handleChange("local".concat(this.props.model),{columns:[...this.props.columns,this.props.defaultColumn],rows:this.props.data.map(e=>[...e,""])})}handleColumnDelete(e){this.handleChange("local".concat(this.props.model),{columns:this.props.columns.filter((t,a)=>a!==e),rows:this.props.data.map(t=>t.filter((t,a)=>a!==e))})}handleColumnFill(e){const t=this.props.data.map(t=>t[e]).filter(e=>""!==e);t.length>0&&this.handleChange("local".concat(this.props.model),{columns:this.props.columns,rows:this.props.data.map((a,n)=>{const r=[...a];return r[e]=r[e]||t[n%t.length],r})})}handleColumnClear(e){this.handleChange("local".concat(this.props.model),{columns:this.props.columns,rows:this.props.data.map(t=>{const a=[...t];return a[e]="",a})})}handleRowAdd(e){const t=e||(this.props.defaultRow?[this.props.defaultRow]:[Object(k.fill)(Array(this.props.data[0]?this.props.data[0].length:this.props.columns.length),"")]);this.handleChange("local".concat(this.props.model,".rows"),[...this.props.data,...t])}handleRowDelete(e){this.handleChange("local".concat(this.props.model,".rows"),this.props.data.filter((t,a)=>a!==e))}handleRowMove(e,t){this.props.formDispatch(lt.actions.move("local".concat(this.props.model,".rows"),e,t))}handleOverwrite({columns:e,rows:t}){this.handleChange("local".concat(this.props.model),{columns:e,rows:t})}handleReload(){this.props.formDispatch(lt.actions.load("local".concat(this.props.model,".rows"),this.props.data))}render(){const e=this.props,t=e.columns,a=e.Footer,n=this.props.columnWidths||t.length>0?t.map(()=>90/t.length):[90];return c.a.createElement(lt.Fieldset,{model:this.props.model},c.a.createElement("table",{className:ye()({table:!0,grid:!0,"grid-slim":t.length>5,"no-header":!1===this.props.showHeader},this.props.className)},c.a.createElement(sr,{columnWidths:n}),c.a.createElement(mr,{columns:t,addColumns:this.props.addColumns,maxColumns:this.props.maxColumns,HeaderContent:this.props.HeaderContent}),c.a.createElement(hr,{data:this.props.data,columns:t,BodyContent:this.props.BodyContent,LeftColumn:this.props.LeftColumn,RightColumn:this.props.RightColumn,cellProps:this.props.cellProps}),this.props.readOnly?null:c.a.createElement(a,{data:this.props.data,columns:t})))}}yr.childContextTypes={gridDispatch:dn.a.func,formDispatch:dn.a.func,readOnly:dn.a.bool,uniqueId:dn.a.string},yr.defaultProps={data:[],addColumns:!1,maxColumns:1/0,defaultColumn:"",cellProps:{},LeftColumn:fr,RightColumn:gr,HeaderContent:e=>e,BodyContent:e=>e,Footer:Er};var wr=yr;const vr=({cellData:e,rowIndex:t,colIndex:a,colName:n})=>{if(1===a)return c.a.createElement(lt.Control.select,{model:".rows[".concat(t,"][").concat(a,"]"),className:"form-control custom-select",style:{fontFamily:"Fira Mono",color:""===e?"var(--gray)":"inherit"}},c.a.createElement("option",{value:""},"none (inactive)"),c.a.createElement("option",{value:"keypress"},"keypress"),c.a.createElement("option",{value:"keydown"},"keydown"),c.a.createElement("option",{value:"keyup"},"keyup"),c.a.createElement("option",{value:"click"},"click"),c.a.createElement("option",{value:"mousedown"},"mousedown"),c.a.createElement("option",{value:"mouseup"},"mouseup"));{const e={2:"window",3:"any"}[a]||"";return(c.a.createElement(lt.Control.text,{model:".rows[".concat(t,"][").concat(a,"]"),placeholder:e,className:"form-control",style:{fontFamily:"Fira Mono"},debounce:300}))}},xr=({columnData:e})=>c.a.createElement("span",{style:{paddingLeft:"0.25rem"}},e);var Or=({data:e,formDispatch:t})=>{var a;return(c.a.createElement(ve,{title:"Responses",wrapContent:!1,className:"mt-4"},c.a.createElement(wr,{model:".responses",className:"border-top-0",data:(null===(a=e.responses)||void 0===a?void 0:a.rows)||[],columns:[c.a.createElement("span",null,"label",c.a.createElement(Sn,{className:"ml-2"},c.a.createElement("p",{className:"font-weight-bold"},c.a.createElement("code",null,"label")," assigned to a particular response action on part of the participant."),c.a.createElement("p",{className:"text-muted"},"The label reflects the ",c.a.createElement("em",null,"meaning")," of participants' responses. We save the label corresponding to the recorded action in the data."),c.a.createElement("p",{className:"text-muted"},"It is possible to have multiple alternative response actions with the same label, for example if participants can use one of several response modalities to indicate their response."))),c.a.createElement("span",null,"action",c.a.createElement("span",{className:"text-muted font-weight-normal"}," \xb7 event"),c.a.createElement(Sn,{className:"ml-2"},c.a.createElement("p",{className:"font-weight-bold"},"Type of ",c.a.createElement("code",null,"action")," participants can take to indicate a response. This corresponds to browser events."),c.a.createElement("dl",{className:"text-muted"},c.a.createElement("dt",null,"keypress"),c.a.createElement("dd",null,"Pushing a key on the keyboard and releasing it."),c.a.createElement("dt",null,"keydown"),c.a.createElement("dd",null,"Holding down a key."),c.a.createElement("dt",null,"keyup"),c.a.createElement("dd",null,"Releasing a key."),c.a.createElement("dt",null,"click"),c.a.createElement("dd",null,"Pressing and releasing a mouse button."),c.a.createElement("dt",null,"mousedown"),c.a.createElement("dd",null,"Holding down a mouse button."),c.a.createElement("dt",null,"mouseup"),c.a.createElement("dd",null,"Releasing a mouse button.")))),c.a.createElement("span",null,"target",c.a.createElement(Sn,{className:"ml-2"},c.a.createElement("p",{className:"font-weight-bold"},"The ",c.a.createElement("code",null,"target")," of the action. This limits a response to certain parts of the screen \u2013 leave blank to record responses for the entire window."),c.a.createElement("p",null,"The best example for this is if you're looking for clicks on a specific part of the screen rather than anywhere."),c.a.createElement("p",{className:"text-muted"},"On ",c.a.createElement("strong",null,"canvas-based screens"),", ",c.a.createElement("code",null,"AOIs")," can be used as target areas. To do so, please enter the ",c.a.createElement("code",null,"@")," sign followed by the ",c.a.createElement("code",null,"AOI")," label, for example ",c.a.createElement("code",null,"@label"),"."),c.a.createElement("p",{className:"text-muted"},"On ",c.a.createElement("strong",null,c.a.createElement("code",null,"HTML"),"-based screens"),", the target areas are defined by ",c.a.createElement("code",null,"CSS")," selectors, e.g. ",c.a.createElement("code",null,"button#option_a")," corresponds to a ",c.a.createElement("code",null,'<button id="option_a" />')," element on screen."))),c.a.createElement("span",null,"filter",c.a.createElement("span",{className:"text-muted font-weight-normal"}," \xb7 key/button"),c.a.createElement(Sn,{className:"ml-2"},c.a.createElement("p",{className:"font-weight-bold"},"Additional ",c.a.createElement("code",null,"filter")," applied to the action."),c.a.createElement("p",null,"For the most part, this specifies the key or button corresponding to the response. Leave empty to count any key or button as the corresponding response."),c.a.createElement("p",null,"Multiple options are allowed if seperated by a comma."),c.a.createElement("dl",{className:"text-muted"},c.a.createElement("dt",null,"Keyboard events"),c.a.createElement("dd",null,"Label of the key pressed, e.g. ",c.a.createElement("code",null,"s"),", ",c.a.createElement("code",null,"l"),", ",c.a.createElement("code",null,"Space")," etc. (upper case is available for letters)"),c.a.createElement("dt",null,"Mouse events"),c.a.createElement("dd",null,"Number corresponding to the mouse button, where ",c.a.createElement("code",null,"0")," is the innermost button (to the left on a right-handed mouse and vice-versa)."))))],columnWidths:[30,20,20,20],HeaderContent:xr,BodyContent:vr,formDispatch:t}),c.a.createElement(he.a,null,c.a.createElement(ot.a,{row:!0},c.a.createElement(ct.a,{for:"correctResponse",xs:"2"},"Correct response",c.a.createElement(Sn,{title:"Correct response",className:"float-right"},c.a.createElement("p",{className:"font-weight-bold"},"Label of the response classified as correct."),c.a.createElement("p",{className:"text-muted"},"The entry here should correspond to one of the labels assigned to responses in the first column above (placeholders can also be used for varying correct responses)."))),c.a.createElement(Z.a,{xs:"10"},c.a.createElement(lt.Control,{model:".correctResponse",placeholder:"Undefined",type:"text",component:at.a,id:"correctResponse",style:{fontFamily:"Fira Mono"},debounce:300}))))))},kr=a(436),Cr=a(854),jr=({data:e})=>c.a.createElement(ve,{title:"Meta",className:"mt-4"},c.a.createElement(ot.a,{row:!0},c.a.createElement(ct.a,{for:"skip",xs:"2"},"Skip",c.a.createElement(Sn,{title:"Skip",className:"float-right"},c.a.createElement("p",{className:"font-weight-bold"},"Don't run the component during the study."),c.a.createElement("p",{className:"text-muted"},"This will cause any component to be prepared, but not run."))),c.a.createElement(Z.a,{xs:"10"},c.a.createElement(Ln.a,null,c.a.createElement(Hn.a,{addonType:"prepend"},c.a.createElement(kr.a,null,c.a.createElement(lt.Control.checkbox,{model:".skip",component:Cr.a,controlProps:{addon:"true",id:"skip",type:"checkbox"}}))),c.a.createElement(lt.Control,{model:".skipCondition",component:at.a,controlProps:{disabled:e.skip},placeholder:"${ optional condition }",type:"text",id:"skipCondition",style:{fontFamily:"Fira Mono"},debounce:300})))),c.a.createElement(ot.a,{row:!0},c.a.createElement(ct.a,{for:"tardy",xs:"2"},"Tardy",c.a.createElement(Sn,{title:"Tardiness",className:"float-right"},c.a.createElement("p",{className:"font-weight-bold"},"Prepare the component at the last possible moment, just before it is run."),c.a.createElement("p",{className:"text-muted"},"This is useful if the component depends on information that becomes available only during the study, for example if a screen's content depends on participant behavior."),c.a.createElement("p",{className:"text-muted"},"Ordinarily, a component is prepared when the page is loaded."))),c.a.createElement(Z.a,{xs:"10",className:"pt-2"},c.a.createElement(lt.Control.checkbox,{model:".tardy",component:Cr.a,controlProps:{id:"tardy",type:"checkbox"}}))));const Nr={updateComponent:it};var Tr=Object(m.connect)(null,Nr)(({id:e,data:t,keys:a,validators:n,updateComponent:r,getDispatch:l,postProcess:o=(e=>e),children:s,className:i,style:m})=>c.a.createElement(lt.LocalForm,{initialState:Object(k.pick)(t,a),onChange:t=>r(e,o(t)),getDispatch:l,className:i,style:m,validators:n},s)),Pr=class extends o.Component{constructor(e){super(e),this.formDispatch=()=>console.log("invalid dispatch")}render(){const e=this.props,t=e.id,a=e.data;return(c.a.createElement(Tr,{id:t,data:a,keys:["responses","correctResponse","skip","skipCondition","tardy","timeline","timeout"],getDispatch:e=>this.formDispatch=e},c.a.createElement(lr,{id:t,data:a,formDispatch:e=>this.formDispatch(e)}),c.a.createElement(Or,{id:t,data:a,formDispatch:e=>this.formDispatch(e)}),c.a.createElement(jr,{data:a})))}},Sr=a(849);a(779);const Dr=e=>c.a.createElement(be.a,{outline:!0,color:!1===e.errors.syntax?"secondary":"warning",className:"editor-field"},c.a.createElement(kt,{height:600,language:"javascript",value:e.value,onChange:e.onChange}),!1===e.errors.syntax?null:c.a.createElement(Sr.a,null,c.a.createElement("strong",null,e.errors.syntax&&e.errors.syntax.name,":"),"\xa0",e.errors.syntax&&e.errors.syntax.message)),Ir=()=>null,Fr=({cellData:e,rowIndex:t,colIndex:a})=>c.a.createElement(c.a.Fragment,null,c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,{xs:"6"},c.a.createElement(lt.Control.text,{model:".rows[".concat(t,"][").concat(a,"]['title']"),className:"form-control",placeholder:"title",style:{fontFamily:"Fira Mono"},debounce:300})),c.a.createElement(Z.a,{xs:"6"},c.a.createElement(lt.Control.select,{model:".rows[".concat(t,"][").concat(a,"].message"),className:"form-control custom-select",style:{fontFamily:"Fira Mono",color:""===e.message?"var(--gray)":"inherit"}},c.a.createElement("option",{value:""},"event"),c.a.createElement("option",{value:"before:prepare"},"before:prepare"),c.a.createElement("option",{value:"after:prepare"},"after:prepare"),c.a.createElement("option",{value:"run"},"run"),c.a.createElement("option",{value:"end"},"end"),c.a.createElement("option",{value:"after:end"},"after:end"),c.a.createElement("option",{value:"commit"},"commit")))),c.a.createElement(lt.Control.textarea,{model:".rows[".concat(t,"][").concat(a,"].code"),component:Dr,errors:{syntax:e=>(e=>{try{return Bt(e),!1}catch(t){return{name:t.name,message:t.message}}})(e)},mapProps:{errors:e=>e.fieldValue.errors},debounce:300}));var Ar=class extends o.Component{constructor(e){super(e),this.formDispatch=()=>console.log("invalid dispatch")}render(){var e;const t=this.props,a=t.id,n=t.data;return(c.a.createElement(ve,{title:"Scripts",wrapContent:!1},c.a.createElement(Tr,{id:a,data:n,keys:["messageHandlers"],getDispatch:e=>this.formDispatch=e},c.a.createElement(wr,{model:".messageHandlers",HeaderContent:Ir,BodyContent:Fr,showHeader:!1,columnWidths:[90],columns:["label"],defaultRow:[{title:"",message:"",code:""}],data:(null===(e=n.messageHandlers)||void 0===e?void 0:e.rows)||[],formDispatch:e=>this.formDispatch(e)}))))}},_r=a(258);const Mr=({columns:e},{id:t,gridDispatch:a})=>{let n=c.a.createRef();return(c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("td",null),c.a.createElement("td",{colSpan:e.length},c.a.createElement(_r.a,{ref:n,component:t}),c.a.createElement(te.a,{size:"sm",block:!0,outline:!0,color:"muted",className:"hover-target",onClick:Object(l.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.current.select();case 3:a("reload"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("Error while adding file",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),onMouseUp:e=>e.target.blur()},c.a.createElement(Ie.a,{icon:"plus"}))),c.a.createElement("td",null))))};Mr.contextTypes={gridDispatch:dn.a.func,id:dn.a.oneOfType([dn.a.string,dn.a.number])};var Rr=Mr;const Lr=({cellData:e,rowIndex:t,colIndex:a,colName:n})=>c.a.createElement(lt.Control.text,{model:".rows[".concat(t,"][").concat(a,"]['localPath']"),className:"form-control",placeholder:"path",style:{fontFamily:"Fira Mono"},debounce:300}),Hr=()=>c.a.createElement(c.a.Fragment,null,"Path"),Wr=Object(m.connect)((e,t)=>{const a=e.files.files[t.rowData[0].poolPath];return{icon:a?Object(ut.a)(a.content):"file-exclamation"}})(({icon:e})=>c.a.createElement(or,{icon:e,onClick:()=>null}));class Br extends o.Component{render(){var e;const t=this.props,a=t.id,n=t.data;return(c.a.createElement(ve,{title:"Files",wrapContent:!1},c.a.createElement(Tr,{id:a,data:n,keys:["files"],getDispatch:e=>this.dispatch=e},c.a.createElement(wr,{className:"border-top-0",model:".files",BodyContent:Lr,HeaderContent:Hr,LeftColumn:Wr,Footer:Rr,columnWidths:[90],columns:["path"],defaultRow:[{localPath:"",poolPath:""}],data:(null===(e=n.files)||void 0===e?void 0:e.rows)||[],formDispatch:e=>this.dispatch(e)}))))}}const Ur=({index:e,metaData:t,formDispatch:a})=>c.a.createElement(c.a.Fragment,null,c.a.createElement("h3",{className:"h5"},t.title,t.description&&c.a.createElement("small",{className:"text-muted"}," \xb7 ",t.description)),c.a.createElement("hr",null)),Vr=({option:e,value:t,type:a,options:n,defaultValue:r,placeholder:l})=>{switch(a){case"select":return c.a.createElement(lt.Control.select,{defaultValue:t||r,model:".".concat(e),className:"form-control custom-select",style:{fontFamily:"Fira Mono"},debounce:300},n.map(e=>c.a.createElement("option",{value:e.coding},e.label)));default:return c.a.createElement(lt.Control.text,{defaultValue:t||r,model:".".concat(e),component:at.a,placeholder:l,style:{fontFamily:"Fira Mono"},debounce:300})}},qr=e=>c.a.createElement(ot.a,{row:!0},c.a.createElement(ct.a,{for:e.option,sm:3},e.label),c.a.createElement(Z.a,{sm:9},c.a.createElement(Vr,e),e.help&&c.a.createElement("small",{className:"form-text text-muted"},e.help))),zr=({index:e,data:t,metaData:a})=>c.a.createElement(lt.Fieldset,{model:".plugins[".concat(e,"]")},Object.entries(a.options).map(([a,{label:n,type:r,options:l=[],default:o,placeholder:s,help:i}])=>c.a.createElement(qr,{key:"plugin-".concat(e,"-").concat(a),option:a,value:t[a],options:l,label:n,type:r,defaultValue:o,placeholder:s,help:i}))),Yr=({isOpen:e,onRequestClose:t,onAdd:a})=>c.a.createElement(Ne.a,{isOpen:e,onRequestClose:t},c.a.createElement(Tt,{title:"Plugins",closeHandler:t},c.a.createElement("p",null,c.a.createElement("strong",null,"Plugins change the behavior of a component"),", and can add further functionality. Please select one to include it."),c.a.createElement(be.a,{className:"card-flush"},c.a.createElement(Ae.a,{className:"list-group-flush"},Object.entries(Ft).map(([e,n],r)=>c.a.createElement(_e.a,{key:"plugin-available-".concat(r),action:!0,style:{cursor:"pointer"},onClick:()=>{a(e),t()}},c.a.createElement("strong",null,n.title))))),c.a.createElement("div",{className:"mt-3"},c.a.createElement("small",{className:"text-muted"},"Missing something? Ideas for improving things? Please ",c.a.createElement("a",{href:"https://labjs.readthedocs.io/en/latest/meta/contribute/index.html",target:"_blank",rel:"noopener noreferrer"},"suggest or contribute"),"!")))),Gr=({muted:e,addPlugin:t},{id:a})=>{const n=Object(o.useState)(!1),r=Object(Q.a)(n,2),l=r[0],s=r[1];return(c.a.createElement(he.a,null,c.a.createElement(Yr,{isOpen:l,onRequestClose:()=>s(!1),onAdd:e=>t(a,e)}),c.a.createElement(te.a,{size:"sm",block:!0,outline:!0,color:e?"muted":"secondary",className:"hover-target",onClick:()=>s(!0),onMouseUp:e=>e.target.blur()},c.a.createElement(Ie.a,{icon:"plus"}))))};Gr.contextTypes={id:dn.a.oneOfType([dn.a.string,dn.a.number])};const Kr=Object(m.connect)(null,{addPlugin:(e,t)=>({type:"ADD_PLUGIN",id:e,pluginType:t})})(Gr),Xr=({index:e,data:t,metaData:a,formDispatch:n})=>c.a.createElement(he.a,{className:"border-bottom"},c.a.createElement(lt.Control.text,{model:".plugins[".concat(e,"].type"),defaultValue:t.type,hidden:!0}),c.a.createElement(Ur,{index:e,data:t,metaData:a,formDispatch:n}),c.a.createElement(zr,{index:e,data:t,metaData:a})),Qr=({visible:e})=>e?c.a.createElement("div",{className:"text-center p-5 pb-2"},c.a.createElement(Ie.a,{icon:"plug",className:"d-block text-muted p-3",style:{fontSize:"3.5rem"}}),c.a.createElement("div",{className:"text-muted"},c.a.createElement("strong",null,"Plugins extend components' functionality"),c.a.createElement("br",null),c.a.createElement("small",null,"Please click below to add one."))):null;var Jr=class extends o.Component{constructor(e){super(e),this.formDispatch=()=>console.log("invalid dispatch")}render(){const e=this.props,t=e.id,a=e.data;return(c.a.createElement(ve,{title:"Plugins",badge:"Beta",wrapContent:!1},c.a.createElement(Qr,{visible:0===(a.plugins||[]).length}),c.a.createElement(Tr,{id:t,data:a,keys:["plugins"],postProcess:e=>Object(h.a)({},e,{plugins:Array.isArray(e.plugins)?e.plugins:Object.values(e.plugins)}),getDispatch:e=>this.formDispatch=e},(a.plugins||[]).map(e=>({pluginData:e,metaData:At(e.type)})).filter(({metaData:e})=>void 0!==e).map(({pluginData:e,metaData:t},a)=>c.a.createElement(Xr,{key:"plugin-".concat(a),index:a,data:e,metaData:t,formDispatch:e=>this.formDispatch(e)}))),c.a.createElement(Kr,{muted:(a.plugins||[]).length>0})))}},$r=(a(780),a(850));const Zr=({cellData:e,rowIndex:t,colIndex:a,colName:n})=>c.a.createElement(lt.Control.text,{model:".rows[".concat(t,"][").concat(a,"]"),className:"form-control",style:{fontFamily:"Fira Mono"},debounce:300}),el=({type:e,setType:t,actions:a,disabled:n=!1})=>{const r=Object(o.useState)(!1),l=Object(Q.a)(r,2),s=l[0],i=l[1];return(c.a.createElement($r.a,{addonType:"append",disabled:n,isOpen:s,toggle:()=>i(!s)},c.a.createElement(Ya.a,{caret:!n,disabled:n,outline:!0,color:"secondary",className:"rounded-right"},c.a.createElement(Ie.a,{icon:{string:"font",number:"tachometer",boolean:"adjust"}[e],fixedWidth:!0})),c.a.createElement(Ga.a,{right:!0},c.a.createElement(Ka.a,{header:!0},"Data type"),c.a.createElement(Ka.a,{className:ye()({"dropdown-item-active":"string"===e}),onClick:()=>t("string")},"Text ",c.a.createElement("span",{className:"text-muted"},"(categorical)")),c.a.createElement(Ka.a,{className:ye()({"dropdown-item-active":"number"===e}),onClick:()=>t("number")},"Numerical ",c.a.createElement("span",{className:"text-muted"},"(continuous)")),c.a.createElement(Ka.a,{className:ye()({"dropdown-item-active":"boolean"===e}),onClick:()=>t("boolean")},"Boolean ",c.a.createElement("span",{className:"text-muted"},"(binary)")),a?c.a.createElement("div",null,c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"Actions"),Object.entries(a).map(([e,t],a)=>c.a.createElement(Ka.a,{onClick:t,key:a},e))):c.a.createElement("div",null))))},tl=({columnData:e,index:t},{gridDispatch:a})=>c.a.createElement(Ln.a,null,c.a.createElement(lt.Control.text,{model:".columns[".concat(t,"]['name']"),placeholder:"parameter".concat(t),className:"form-control",style:{fontFamily:"Fira Mono",fontWeight:"bold",height:"42px"},debounce:300}),c.a.createElement(el,{type:e.type,setType:e=>a("change",{model:"local.templateParameters.columns[".concat(t,"]['type']"),value:e}),actions:{Fill:()=>{a("fillColumn",t)},Clear:()=>{a("clearColumn",t)},Delete:()=>{window.confirm("Are you sure you want to delete this column?")&&a("deleteColumn",t)}}}));tl.contextTypes={gridDispatch:dn.a.func};const al=()=>null,nl=({cellData:e,rowIndex:t,colIndex:a,readOnly:n},{gridDispatch:r})=>c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,{xs:"6"},c.a.createElement(lt.Control.text,{model:".rows[".concat(t,"][").concat(a,"]['name']"),placeholder:"parameter",style:{fontFamily:"Fira Mono"},debounce:300,component:at.a,controlProps:{disabled:n}})),c.a.createElement(Z.a,{xs:"6"},c.a.createElement(Ln.a,null,c.a.createElement(lt.Control.text,{model:".rows[".concat(t,"][").concat(a,"]['value']"),className:"form-control",placeholder:"value",style:{fontFamily:"Fira Mono"},debounce:300}),c.a.createElement(el,{type:e.type,setType:e=>r("change",{model:"local.parameters.rows[".concat(t,"][").concat(a,"]['type']"),value:e}),disabled:n}))));nl.contextTypes={gridDispatch:dn.a.func};var rl=class extends o.Component{constructor(e){super(e),this.formDispatch=()=>console.log("invalid dispatch")}render(){const e=this.props,t=e.id,a=e.data;return(c.a.createElement(ve,{title:"Template",wrapContent:!1},c.a.createElement(Tr,{id:t,data:a,keys:["notes","parameters"],getDispatch:e=>this.formDispatch=e},c.a.createElement(he.a,{className:"border-bottom"},c.a.createElement(ot.a,null,c.a.createElement(lt.Control.textarea,{model:".notes",className:"form-control form-control-sm",placeholder:"Notes",rows:"5",style:{padding:"0.5rem 0.75rem"},debounce:300}))),c.a.createElement(wr,{model:".parameters",HeaderContent:al,showHeader:!1,defaultRow:[{name:"",value:"",type:"string"}],BodyContent:nl,columns:["Parameters"],data:a.parameters?a.parameters.rows:[],formDispatch:e=>this.formDispatch(e),readOnly:a._template,cellProps:{readOnly:a._template}}))))}},ll=({id:e,data:t})=>c.a.createElement(ve,{title:"Advanced options"},c.a.createElement(Tr,{id:e,data:t,keys:["scrollTop","_template"]},c.a.createElement(ot.a,{row:!0},c.a.createElement(Z.a,{xs:2},c.a.createElement(ct.a,null,"Run")),c.a.createElement(Z.a,{xs:10},c.a.createElement(ot.a,{check:!0},c.a.createElement(lt.Control.checkbox,{model:".scrollTop",component:Cr.a,controlProps:{id:"scrollTop",type:"checkbox",inline:!0,label:"Scroll to top before running"}}),c.a.createElement(Sn,{title:"Scroll to Top",style:{marginLeft:"1rem"}},c.a.createElement("p",{className:"font-weight-bold"},"Reset scroll position to the top of the page when showing content"),c.a.createElement("p",{className:"text-muted"},"This is useful if the preceding and current screen both occupy a lot of vertical space, as it saves participants from having to scroll back upwards manually between pages."))))),c.a.createElement(ot.a,{row:!0},c.a.createElement(Z.a,{xs:2},c.a.createElement(ct.a,null,"Display")),c.a.createElement(Z.a,{xs:10},c.a.createElement(ot.a,{check:!0},c.a.createElement(lt.Control.checkbox,{model:"._template",component:Cr.a,controlProps:{id:"_template",type:"checkbox",inline:!0,label:"Template"}}),c.a.createElement(Sn,{title:"Template",style:{marginLeft:"1rem"}},c.a.createElement("p",{className:"font-weight-bold"},"Reduce visible settings so that only parameters can be changed."),c.a.createElement("p",{className:"text-muted"},"Making a component a template simplifies complex components and bundle nested hierarchies into a single module. This creates reusable components that are defined only by their parameters."),c.a.createElement("p",{className:"text-muted"},"Making a component a template prevents direct modification of all component details, and hides nested components.")))))));const ol=Object(o.lazy)(()=>Promise.all([a.e(11),a.e(5)]).then(a.bind(null,992))),cl={updateComponent:it};var sl=Object(m.connect)(null,cl)(({id:e,data:t,updateComponent:a})=>c.a.createElement(ve,{title:"Content"},c.a.createElement(o.Suspense,{fallback:c.a.createElement(ar,null)},c.a.createElement(ol,{id:e,data:t.content,onChange:t=>a(e,{content:t})})))),il=({id:e,data:t})=>c.a.createElement(ve,{title:"Content",className:"flex-grow-1",wrapContent:!1},c.a.createElement(he.a,{className:"h-100 d-flex flex-column"},c.a.createElement(Tr,{id:e,data:t,keys:["content"],className:"flex-grow-1 d-flex flex-column"},c.a.createElement(lt.Control.textarea,{model:".content",component:kt,controlProps:{language:"html"},debounce:300})))),ml=({id:e,data:t})=>c.a.createElement(ve,{title:"Content",wrapContent:!1,className:"flex-grow-1 d-flex flex-column"},c.a.createElement(Tr,{id:e,data:t,keys:["context","contextSelector"],className:"flex-grow-1 d-flex flex-column"},c.a.createElement(he.a,{className:"flex-grow-1 d-flex flex-column"},c.a.createElement(lt.Control.textarea,{model:".context",component:kt,controlProps:{language:"html"},debounce:300})),c.a.createElement(he.a,{className:"flex-grow-0",style:{borderTop:"1px solid rgba(0, 0, 0, 0.125)"}},c.a.createElement(ot.a,null,c.a.createElement(ct.a,{for:"contextSelector"},"Context selector"),c.a.createElement(lt.Control,{model:".contextSelector",id:"contextSelector",component:at.a,style:{fontFamily:"Fira Code"}}),c.a.createElement(st.a,{color:"muted"},"This CSS selector defines where nested components get to insert their content.")))));const dl=r.a.mark((function e(...t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.map(e=>Math.max(e.length,1)).reverse().reduce((e,t,a)=>e.concat([(e[a-1]||1)*t]),[]).reverse(),n=0;case 2:if(!(n<a[0])){e.next=8;break}return e.next=5,t.map((e,t)=>e[Math.floor(n/(a[t+1]||1))%e.length]);case 5:n++,e.next=2;break;case 8:case"end":return e.stop()}}),e)})),pl=["Factor","Levels"],ul=({index:e})=>c.a.createElement("div",null,pl[e]),hl=({cellData:e,rowIndex:t,colIndex:a,colName:n})=>{const r=(e||"").split("\n").length;return(c.a.createElement(lt.Control.textarea,{model:".rows[".concat(t,"][").concat(a,"]"),className:"form-control",style:{fontFamily:"Fira Mono",paddingTop:"7px",height:"".concat(1.6*(r+1.5),"em"),minHeight:"80px",maxHeight:"150px",transition:"height 0.05s ease-in-out"}}))},bl=e=>0===e.colIndex?c.a.createElement(Zr,e):c.a.createElement(hl,e);class El extends o.Component{constructor(e){super(e),this.state={open:!1,formData:{factors:{rows:[["Factor A","Level A1\nLevel A2"],["Factor B","Level B1\nLevel B2"]]}}},this.promiseHandlers={}}toggle(){this.setState(e=>(e.active&&this.promiseHandlers.reject&&this.promiseHandlers.reject("FileSelector hidden"),{open:!e.open}))}show(){var e=this;return Object(l.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.toggle(),t.abrupt("return",new Promise((t,a)=>{e.promiseHandlers={resolve:a=>(e.setState({open:!1}),t(a)),reject:a}}));case 2:case"end":return t.stop()}}),t)})))()}generate(){const e=this.state.formData.factors.rows.map(e=>e[0]),t=this.state.formData.factors.rows.map(e=>e[1].split("\n").filter(e=>""!==e)),a={columns:e.map(e=>({name:e,type:"string"})),rows:Array.from(dl(...t))};return this.promiseHandlers.resolve&&this.promiseHandlers.resolve(a),a}render(){return c.a.createElement(Ne.a,{isOpen:this.state.open,modalProps:{size:"lg"}},c.a.createElement(lt.LocalForm,{initialState:this.state.formData,onChange:e=>this.setState({formData:e}),getDispatch:e=>this.formDispatch=e},c.a.createElement("div",{className:"modal-content"},c.a.createElement(Nt.a,{toggle:()=>this.toggle()},"Generate factorial design"),c.a.createElement(Se.a,null,c.a.createElement("p",null,c.a.createElement("strong",null,"Please specify the factors in your design, as well as their levels.")," ",c.a.createElement("span",{className:"text-muted"},"The resulting design is fully crossed, meaning that in the loop, every level of a factor is combined with every level of every other factor.")),c.a.createElement("hr",{style:{marginBottom:"0"}})),c.a.createElement(wr,{model:".factors",data:this.state.formData.factors.rows,HeaderContent:ul,BodyContent:bl,columns:["factor","levels"],defaultRow:["",""],formDispatch:e=>this.formDispatch(e),className:"border-top-0"}),c.a.createElement(De.a,null,c.a.createElement(te.a,{outline:!0,color:"secondary",onClick:()=>this.toggle()},"Close"),c.a.createElement(te.a,{outline:!0,color:"primary",onClick:()=>this.generate()},"Generate")))))}}var fl=El,gl=a(347);const yl=({columns:e,data:t},{gridDispatch:a})=>{const n=Object(o.useState)(!1),r=Object(Q.a)(n,2),l=r[0],s=r[1],i=Object(o.createRef)();return c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("td",null),c.a.createElement("td",{colSpan:e.length},c.a.createElement(fl,{ref:i}),c.a.createElement(za.a,{size:"sm",className:"w-100",isOpen:l,toggle:()=>s(!l)},c.a.createElement(te.a,{block:!0,size:"sm",outline:!0,color:"muted",className:"hover-target",onClick:()=>a("addRow"),onMouseUp:e=>e.target.blur(),style:{paddingLeft:"32px"}},c.a.createElement(Ie.a,{icon:"plus"})),c.a.createElement(Ya.a,{caret:!0,split:!0,size:"sm",outline:!0,color:"muted",className:"hover-target",style:{width:"24px"}}),c.a.createElement(Ga.a,{right:!0},c.a.createElement(Ka.a,{header:!0},"Generate"),c.a.createElement(Ka.a,{onClick:()=>i.current.show().then(e=>{a("overwrite",e)})},"Factorial design"),c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"Repeat"),c.a.createElement(Ka.a,{onClick:()=>{const n=window.prompt("How many times?");n&&a("overwrite",{columns:e,rows:t.flatMap(e=>Object(k.range)(n).map(()=>e))})}},"Each row"),c.a.createElement(Ka.a,{onClick:()=>{const n=window.prompt("How many times?");n&&a("overwrite",{columns:e,rows:Object(k.range)(n).flatMap(()=>t)})}},"Entire grid"),c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"CSV / TSV"),c.a.createElement(Qe.a,{accept:"text/csv,text/tab-separated-values,.csv,.tsv",multiple:!1,onUpload:([[e]])=>{s(!1);const t=Object(gl.parse)(e.trim(),{header:!0});0===t.errors.length||t.data&&1===t.errors.length&&"UndetectableDelimiter"===t.errors[0].code?a("overwrite",{columns:Object.keys(t.data[0]).map(e=>({name:e,type:"string"})),rows:t.data.map(e=>Object.values(e))}):(console.log("CSV import found errors: ",t.errors),alert("Sorry, I couldn't parse that CSV file. There seems to be an error. Could you check it, please?"))}},c.a.createElement("div",{className:"dropdown-item"},"Import")),c.a.createElement(Ka.a,{onClick:()=>((e,t)=>{const a=Object(gl.unparse)({fields:t.map(e=>e.name),data:e});return Object(le.saveAs)(new Blob([a],{type:"text/csv;charset=utf-8"}),"loop.csv")})(t,e)},"Export")))),c.a.createElement("td",null)))};yl.contextTypes={gridDispatch:dn.a.func};var wl=Object(Y.DragSource)("item",{beginDrag:({column:e})=>({column:e})},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))(({name:e,connectDragSource:t,isDragging:a})=>t(c.a.createElement("div",{className:"d-inline-block m-1 mr-2 p-2 px-4 border rounded-pill",style:{opacity:a?.4:1,transform:"translate(0, 0)",cursor:a?"grabbing":"grab"}},c.a.createElement("span",{style:{position:"relative",top:"1px"}},e))));var vl=Object(Y.DropTarget)("item",{drop:(e,t)=>{const a=t.getItem().column;e.move(a,e.groupId)}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))(({columns:e=[],title:t,connectDropTarget:a,isOver:n,children:r})=>a(c.a.createElement("tr",{className:ye()({"bg-light":n})},c.a.createElement("td",{style:{padding:"0.75rem 1.25rem",width:"8rem"}},c.a.createElement("small",{className:"text-muted"},t)),c.a.createElement("td",{className:"text-center",style:{padding:"0.75rem 1.25rem"}},r||e.map((e,t)=>c.a.createElement(wl,{key:t,column:e.id,name:e.name}))),c.a.createElement("td",{style:{padding:"0.75rem 1.25rem",width:"8rem"}})))),xl=({groups:e,moveHandler:t,globalShuffle:a})=>{const n=Math.max(...Object.keys(e).map(Number).filter(e=>!isNaN(e)),0)+1,r=Object.entries(e);return c.a.createElement(pt.a,{className:"border-top-0"},c.a.createElement("tbody",null,c.a.createElement(vl,{title:a?"Default":"Not shuffled",groupId:void 0,key:-1,columns:e[void 0],move:t,children:r.length>0?void 0:c.a.createElement("small",{className:"text-muted font-italic"},"(no columns yet)")}),r.filter(([e])=>"undefined"!==e).map(([e,a])=>c.a.createElement(vl,{groupId:e,key:e,columns:a,move:t})),c.a.createElement(vl,{groupId:n,key:n,move:t},c.a.createElement("small",{className:"text-muted"},c.a.createElement("span",{className:"text-right d-inline d-lg-inline-block",style:{width:"45%"}},"Drag columns into rows"),c.a.createElement(Ie.a,{icon:"ellipsis-v",className:"text-muted m-2"}),c.a.createElement("span",{className:"text-left d-inline d-lg-inline-block",style:{width:"45%"}},"to create independently shuffled groups")))))};const Ol=({data:e})=>c.a.createElement(ot.a,{row:!0},c.a.createElement(ct.a,{xs:2,for:"sampleN"},"Sample",c.a.createElement(Sn,{title:"Sampling",className:"float-right",placement:"left"},c.a.createElement("p",{className:"font-weight-bold"},"Control how many, and which of the above parameter sets are used."),c.a.createElement("p",{className:"text-muted"},"The ",c.a.createElement("strong",null,"sample size")," defines the number of loop iterations. The ",c.a.createElement("strong",null,"mode")," determines how the iterations are drawn from the entries above."),c.a.createElement("dl",{className:"text-muted"},c.a.createElement("dt",null,"Sequential"),c.a.createElement("dd",null,"Proceed in order, starting from the top. If more samples are requested than entries are available, start over."),c.a.createElement("dt",null,"Random order"),c.a.createElement("dd",null,"Present entries in shuffled order",c.a.createElement("br",null)," (only available without sampling)."),c.a.createElement("dt",null,"Sample without replacement"),c.a.createElement("dd",null,"Draw entries at random, starting over when all are exhausted. Shuffles the result for a completely random order."),c.a.createElement("dt",null,"Sample w/o replacement (in blocks)"),c.a.createElement("dd",null,"As above, but without shuffling.",c.a.createElement("br",null)," If the number of samples exceeds the number of entries, this results in blocks of all entries in random order."),c.a.createElement("dt",null,"Sample with replacement"),c.a.createElement("dd",null,"Draw entries without regard to which have been selected before.")))),c.a.createElement(Z.a,{xs:10},c.a.createElement(Ln.a,null,c.a.createElement(lt.Control,{id:"sampleN",model:".sample.n",placeholder:"draw-replace"===(e.sample||{}).mode?"As many as rows above":"Use all",pattern:nr.a,style:{fontFamily:"Fira Mono"},component:at.a,debounce:300}),c.a.createElement(lt.Control.select,{id:"sampleMode",model:".sample.mode",component:Cr.a,controlProps:{type:"select"},style:{fontFamily:"Fira Mono"}},c.a.createElement("option",{value:"sequential"},"In sequence"),c.a.createElement("option",{value:"draw-shuffle"},(({templateParameters:e={rows:[]},sample:t={n:void 0}},a)=>{const n=parseInt(t.n),r=e.rows.length;return n<r?a[0]:isNaN(n)||n===r?a[1]:a[2]})(e,["Sampled without replacement","In random order","Sampled without replacement (then shuffled)"])),c.a.createElement("option",{value:"draw"},"Sampled without replacement (in blocks)"),c.a.createElement("option",{value:"draw-replace"},"Sampled with replacement")))));var kl=class extends o.Component{constructor(e){super(e),this.formDispatch=()=>console.log("invalid dispatch")}render(){const e=this.props,t=e.id,a=e.data,n=a.templateParameters||{},r=n.columns,l=void 0===r?[]:r,o=n.rows,s=void 0===o?[]:o;return c.a.createElement(c.a.Fragment,null,c.a.createElement(ve,{title:"Loop",wrapContent:!1},c.a.createElement(Tr,{id:t,data:a,keys:["templateParameters","shuffle","sample"],getDispatch:e=>this.formDispatch=e},c.a.createElement(wr,{model:".templateParameters",className:"border-top-0",addColumns:!0,maxColumns:12,defaultColumn:{name:"",type:"string"},BodyContent:Zr,HeaderContent:tl,Footer:yl,columns:l,data:s,formDispatch:e=>this.formDispatch(e)}),c.a.createElement(he.a,null,c.a.createElement(Ol,{data:a})))),c.a.createElement(ve,{title:"Further options",open:Object(k.uniqBy)(l,e=>e.shuffleGroup).length>1,collapsable:!0,wrapContent:!1,className:"mt-4"},c.a.createElement(he.a,{className:"pb-0"},c.a.createElement("h2",{className:"h6"},"Parameter groups")),c.a.createElement(xl,{id:t,groups:Object(k.groupBy)(l.filter(e=>""!==e.name).map((e,t)=>Object(h.a)({},e,{id:t})),"shuffleGroup"),moveHandler:(e,t)=>this.formDispatch(lt.actions.change("local.templateParameters.columns[".concat(e,"]['shuffleGroup']"),t)),globalShuffle:"sequential"!==a.sample.mode})))}},Cl=({id:e,data:t})=>c.a.createElement(ve,{title:"Content"},c.a.createElement(Tr,{id:e,data:t,keys:["shuffle","localParameters"]},c.a.createElement(ot.a,{row:!0},c.a.createElement(Z.a,{xs:2},c.a.createElement(ct.a,{style:{paddingTop:"0"}},"Order")),c.a.createElement(Z.a,{xs:10},c.a.createElement(ot.a,{check:!0},c.a.createElement(lt.Control.checkbox,{model:".shuffle",component:Cr.a,controlProps:{id:"shuffle",type:"checkbox",label:"Shuffle nested components"}})))))),jl=()=>c.a.createElement(c.a.Fragment,null,c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(lt.Control,{model:".title",placeholder:"Title",component:at.a,className:"font-weight-bold",debounce:300}))),c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(lt.Control.textarea,{model:".content",placeholder:"Text",component:at.a,controlProps:{type:"textarea"},className:"mt-2",debounce:300}))));const Nl=e=>{let t=e.rowIndex;Object(Te.a)(e,["rowIndex"]);const a=Object(o.useContext)($l).openItem;return(c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(Yn.a,{isOpen:a===t},c.a.createElement(Ln.a,{className:"mt-2"},c.a.createElement(Hn.a,{addonType:"prepend"},c.a.createElement(kr.a,null,c.a.createElement(Ie.a,{icon:"arrows-h",fixedWidth:!0}))),c.a.createElement(lt.Control,{model:".width",defaultValue:"",placeholder:"width",debounce:300,className:"form-control",style:{fontFamily:"Fira Mono"}}),c.a.createElement(Hn.a,{addonType:"prepend"},c.a.createElement(kr.a,null,c.a.createElement(Ie.a,{icon:"arrows-v",fixedWidth:!0}))),c.a.createElement(lt.Control,{model:".height",defaultValue:"",placeholder:"height",debounce:300,className:"form-control",style:{fontFamily:"Fira Mono"}}))))))},Tl=({rowIndex:e},{id:t,gridDispatch:a})=>{const n=Object(o.createRef)();return(c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(_r.a,{accept:"image/*",component:t,ref:n}),c.a.createElement(Ln.a,null,c.a.createElement(lt.Control,{model:".src",placeholder:"source",component:at.a,style:{fontFamily:"Fira Mono"},debounce:300}),c.a.createElement(Hn.a,{addonType:"append"},c.a.createElement(te.a,{outline:!0,color:"secondary",style:{minWidth:"3rem"},onClick:Object(l.a)(r.a.mark((function t(){var l;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.current.select();case 3:l=t.sent,a("change",{model:"local.items.rows[".concat(e,"][0].src"),value:'${ this.files["'.concat(l[0].localPath,'"] }')}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log("Error while selecting image",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))},c.a.createElement(Ie.a,{fixedWidth:!0,icon:"folder"})))))))};Tl.contextTypes={id:dn.a.oneOfType([dn.a.string,dn.a.number]),gridDispatch:dn.a.func};var Pl=({rowIndex:e})=>c.a.createElement(c.a.Fragment,null,c.a.createElement(Tl,{rowIndex:e}),c.a.createElement(Nl,{rowIndex:e})),Sl=()=>c.a.createElement("hr",{style:{position:"relative",top:"2px"}}),Dl=()=>c.a.createElement(c.a.Fragment,null,c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement("div",{className:"border rounded py-2 pr-2",style:{height:"220px"}},c.a.createElement(lt.Control.textarea,{model:".content",component:kt,controlProps:{language:"html",height:"100%",options:{folding:!1,fontSize:16,glyphMargin:!1,lineHeight:24,lineNumbers:"off",minimap:{enabled:!1}}},debounce:300})))));const Il=({children:e,rowIndex:t,validation:a,shuffle:n=!1,borderTop:r=!0})=>c.a.createElement(c.a.Fragment,null,e&&r&&c.a.createElement("hr",null),e,n&&c.a.createElement(c.a.Fragment,null,c.a.createElement("hr",null),"Display",c.a.createElement(ot.a,{className:"my-2"},c.a.createElement(st.a,{color:"muted",className:"mb-2"},"Randomize item order"),c.a.createElement(lt.Control.checkbox,{model:".shuffle",component:Cr.a,controlProps:{type:"checkbox",label:"Shuffle items",id:"item-shuffle-".concat(t),style:{fontFamily:"Fira Mono"}},debounce:300}))),c.a.createElement("hr",null),c.a.createElement(ot.a,{className:"my-2"},c.a.createElement(ct.a,{for:"page-item-".concat(t,"-help"),className:"mb-0"},"Help & further instructions"),c.a.createElement(st.a,{color:"muted"},"Tell your participants more about the question."),c.a.createElement(lt.Control.textarea,{model:".help",component:at.a,controlProps:{id:"page-item-".concat(t,"-help"),type:"textarea",bsSize:"sm",rows:3},className:"mt-2 text-muted",debounce:300})),c.a.createElement("hr",null),c.a.createElement(ot.a,{className:"my-2"},c.a.createElement(ct.a,{for:"page-item-".concat(t,"-name"),className:"mb-0"},"Name"),c.a.createElement(st.a,{color:"muted",className:"mb-2"},"The column in which to save the data"),c.a.createElement(lt.Control,{model:".name",placeholder:"(auto-generate from question)",component:at.a,className:"font-weight-bold",controlProps:{id:"page-item-".concat(t,"-name"),style:{fontFamily:"Fira Mono"}},debounce:300})),c.a.createElement("hr",null),"Validation",c.a.createElement(ot.a,{className:"my-2"},c.a.createElement(st.a,{color:"muted",className:"mb-2"},"Checks to run before accepting data"),c.a.createElement(lt.Control.checkbox,{model:".required",component:Cr.a,controlProps:{type:"checkbox",label:"Require answer",id:"item-required-".concat(t),style:{fontFamily:"Fira Mono"}},debounce:300})),a),Fl=e=>{let t=e.rowIndex,a=Object(Te.a)(e,["rowIndex"]);const n=Object(o.useContext)($l).openItem;return(c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(Yn.a,{isOpen:n===t},c.a.createElement(Il,Object.assign({rowIndex:t},a))))))},Al=({type:e})=>{switch(e){case"number":return c.a.createElement(c.a.Fragment,null,c.a.createElement(ot.a,null,c.a.createElement(Ln.a,null,c.a.createElement(Hn.a,{addonType:"prepend"},c.a.createElement(kr.a,null,c.a.createElement(Ie.a,{icon:"arrow-to-bottom",fallback:"arrow-down"}))),c.a.createElement(lt.Control,{model:".attributes.min",placeholder:"No lower limit",component:at.a,style:{fontFamily:"Fira Mono"}}),c.a.createElement(Hn.a,{addonType:"prepend"},c.a.createElement(kr.a,null,c.a.createElement(Ie.a,{icon:"arrow-to-top",fallback:"arrow-up"}))),c.a.createElement(lt.Control,{model:".attributes.max",placeholder:"No upper limit",component:at.a,style:{fontFamily:"Fira Mono"}}),c.a.createElement(Hn.a,{addonType:"prepend"},c.a.createElement(kr.a,null,c.a.createElement(Ie.a,{icon:"shoe-prints"}))),c.a.createElement(lt.Control,{model:".attributes.step",placeholder:"Default step (1)",component:at.a,style:{fontFamily:"Fira Mono"}}))));case"date":return c.a.createElement(c.a.Fragment,null,c.a.createElement(ot.a,null,c.a.createElement(Ln.a,null,c.a.createElement(Hn.a,{addonType:"prepend"},c.a.createElement(kr.a,null,c.a.createElement(Ie.a,{icon:"arrow-to-bottom",fallback:"arrow-down"}))),c.a.createElement(lt.Control,{model:".attributes.min",placeholder:"No earliest date (yyyy-mm-dd)",component:at.a,style:{fontFamily:"Fira Mono"}}),c.a.createElement(Hn.a,{addonType:"prepend"},c.a.createElement(kr.a,null,c.a.createElement(Ie.a,{icon:"arrow-to-top",fallback:"arrow-up"}))),c.a.createElement(lt.Control,{model:".attributes.max",placeholder:"No latest date (yyyy-mm-dd)",component:at.a,style:{fontFamily:"Fira Mono"}}))));default:return null}};var _l=({rowIndex:e,type:t,data:a})=>c.a.createElement(c.a.Fragment,null,c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(lt.Control,{model:".label",placeholder:"Question",component:at.a,debounce:300}))),c.a.createElement(Fl,{rowIndex:e},"input"===t&&c.a.createElement(c.a.Fragment,null,c.a.createElement(ot.a,{className:"my-2"},c.a.createElement(ct.a,{for:"page-item-".concat(e,"-attrs-type"),className:"mb-1"},"Data type"),c.a.createElement(st.a,{color:"muted",className:"mb-2"},"Check input format, and restrict input"),c.a.createElement(lt.Control.select,{model:".attributes.type",className:"form-control custom-select",style:{fontFamily:"Fira Mono"},controlProps:{id:"page-item-".concat(e,"-attrs-type")}},c.a.createElement("option",{value:"text"},"Text"),c.a.createElement("option",{value:"number"},"Number"),c.a.createElement("option",{value:"email"},"Email"),c.a.createElement("option",{value:"date"},"Date"))),c.a.createElement(Al,{type:a.attributes&&a.attributes.type}))));const Ml=({icon:e,iconFallbackWeight:t="r",model:a,index:n,itemModel:r,totalPairs:l},{formDispatch:s})=>{const i=Object(o.useState)(!1),m=Object(Q.a)(i,2),d=m[0],p=m[1];return(c.a.createElement(Ln.a,null,c.a.createElement(Hn.a,{addonType:"prepend"},c.a.createElement(kr.a,null,c.a.createElement(Ie.a,{icon:e,fixedWidth:!0,fallbackWeight:t,className:"text-muted"}))),c.a.createElement(lt.Control,{model:"".concat(a,"[").concat(n,"].label"),placeholder:"label",component:at.a,debounce:300}),c.a.createElement(lt.Control,{model:"".concat(a,"[").concat(n,"].coding"),placeholder:"coding",component:at.a,controlProps:{style:{fontFamily:"Fira Mono"}},debounce:300}),c.a.createElement($r.a,{addonType:"append",isOpen:d,toggle:()=>p(!d)},c.a.createElement(Ya.a,{outline:!0,caret:!0,split:!0,color:"secondary",className:"rounded-right"}),c.a.createElement(Ga.a,{right:!0},c.a.createElement(Ka.a,{header:!0},"Add and delete"),c.a.createElement(Ka.a,{onClick:()=>s(lt.actions.change("local.items".concat(r).concat(a),e=>[...e.slice(0,n+1),{},...e.slice(n+1,e.length)]))},"Add below"),c.a.createElement(Ka.a,{onClick:()=>s(lt.actions.remove("local.items".concat(r).concat(a),n))},"Delete"),c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"Move"),c.a.createElement(Ka.a,{onClick:()=>s(lt.actions.move("local.items".concat(r).concat(a),n,n-1)),disabled:0===n},"Up"),c.a.createElement(Ka.a,{onClick:()=>s(lt.actions.move("local.items".concat(r).concat(a),n,n+1)),disabled:n>=l-1},"Down")))))};Ml.contextTypes={formDispatch:dn.a.func};const Rl=({data:e=[],model:t,itemModel:a,icon:n,iconFallbackWeight:r})=>c.a.createElement("div",{className:"pt-1"},[...e,{}].map((l,o)=>c.a.createElement($.a,{form:!0,key:"coding-".concat(t,"-").concat(o)},c.a.createElement(Z.a,{className:"pt-1"},c.a.createElement(Ml,{icon:n,iconFallbackWeight:r,model:"".concat(t),itemModel:a,index:o,totalPairs:e.length})))));var Ll=({data:e,rowIndex:t})=>c.a.createElement(c.a.Fragment,null,c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(lt.Control,{model:".label",placeholder:"Question",component:at.a,debounce:300}))),c.a.createElement(Rl,{data:e.options,model:".options",itemModel:".rows[".concat(t,"][0]"),icon:"circle"}),c.a.createElement(Fl,{rowIndex:t,shuffle:!0})),Hl=({data:e,rowIndex:t})=>c.a.createElement(c.a.Fragment,null,c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(lt.Control,{model:".label",placeholder:"Question",component:at.a,debounce:300}))),c.a.createElement(Rl,{data:e.options,model:".options",itemModel:".rows[".concat(t,"][0]"),icon:"square"}),c.a.createElement(Fl,{rowIndex:t,shuffle:!0})),Wl=({rowIndex:e})=>c.a.createElement(c.a.Fragment,null,c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(lt.Control,{model:".label",placeholder:"Question",component:at.a,debounce:300}))),c.a.createElement(Fl,{rowIndex:e,borderTop:!1},c.a.createElement("div",{className:"mt-2"},c.a.createElement(Al,{type:"number"})))),Bl=({data:e,rowIndex:t})=>c.a.createElement(c.a.Fragment,null,c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(lt.Control,{model:".label",placeholder:"Question",component:at.a,debounce:300}))),c.a.createElement(Rl,{data:e.items,model:".items",itemModel:".rows[".concat(t,"][0]"),icon:"ellipsis-h-alt",iconFallbackWeight:"s"}),c.a.createElement(Fl,{rowIndex:t,shuffle:!0},c.a.createElement($.a,null,c.a.createElement(Z.a,null,c.a.createElement(ot.a,{className:"my-2"},c.a.createElement(ct.a,{for:"page-item-".concat(t,"-width"),className:"mb-0"},"Scale width"),c.a.createElement(st.a,{color:"muted"},"How many points to offer"),c.a.createElement(lt.Field,{model:".width",className:"mt-1"},c.a.createElement(ot.a,null,[5,7,9,11].map(e=>c.a.createElement("div",{key:"page-item-".concat(t,"-width-").concat(e),className:"custom-radio custom-control"},c.a.createElement("input",{type:"radio",value:"".concat(e),id:"page-item-".concat(t,"-width-").concat(e),className:"custom-control-input"}),c.a.createElement("label",{htmlFor:"page-item-".concat(t,"-width-").concat(e),className:"custom-control-label"},e))))))),c.a.createElement(Z.a,null,c.a.createElement(ot.a,{className:"my-2"},c.a.createElement(ct.a,{for:"page-item-".concat(t,"-anchors"),className:"mb-0"},"Anchors"),c.a.createElement(st.a,{color:"muted"},"Scale anchors"),c.a.createElement("div",{className:"mt-2"},Object(k.range)(e.width).map(e=>c.a.createElement($.a,{form:!0,className:"my-1",key:"page-item-".concat(t,"-anchors-").concat(e)},c.a.createElement(Z.a,null,c.a.createElement(Ln.a,null,c.a.createElement(Hn.a,{addonType:"prepend"},c.a.createElement(kr.a,null,c.a.createElement("small",{className:"text-monospace text-muted"},e+1))),c.a.createElement(lt.Control,{model:".anchors[".concat(e,"]"),component:at.a,debounce:300})))))))))));var Ul=e=>{const t=(e=>{switch(e){case"text":return jl;case"image":return Pl;case"divider":return Sl;case"html":return Dl;case"input":case"textarea":return _l;case"radio":return Ll;case"checkbox":return Hl;case"slider":return Wl;case"likert":return Bl;default:return null}})(e.type);return(c.a.createElement(t,e))};const Vl={text:"info",image:"image",divider:"horizontal-rule",html:"code",input:"comment-alt-minus",textarea:"comment-alt-lines",radio:"list-ul",checkbox:"tasks",slider:"sliders-h",likert:"grip-horizontal"},ql=({rowData:[{type:e}],rowIndex:t,isFirstRow:a,isLastRow:n},{gridDispatch:r})=>{const l=Object(o.useContext)($l),s=l.openItem,i=l.setOpenItem;return(c.a.createElement("td",null,c.a.createElement("div",{className:"text-center text-black-50",style:{padding:"6px 12px",border:"1px solid transparent",position:"relative",top:"1px"}},c.a.createElement(Ie.a,{icon:Vl[e]||"question"})),c.a.createElement(Yn.a,{isOpen:s===t&&"divider"!==e},c.a.createElement(te.a,{block:!0,outline:!0,color:"muted",className:"mt-2"},c.a.createElement(Ie.a,{icon:"bars"})),c.a.createElement(te.a,{block:!0,outline:!0,color:"muted",className:"mt-2",onClick:()=>{const e=s;i(void 0),r("moveRow",{from:t,to:t-1}),i(e-1)},disabled:a},c.a.createElement(Ie.a,{icon:"arrow-up"})),c.a.createElement(te.a,{block:!0,outline:!0,color:"muted",className:"mt-2",onClick:()=>{const e=s;i(void 0),r("moveRow",{from:t,to:t+1}),i(e+1)},disabled:n},c.a.createElement(Ie.a,{icon:"arrow-down"})))))};ql.contextTypes={gridDispatch:dn.a.func};const zl=({rowIndex:e,rowData:[{type:t}],onClickOptions:a},{gridDispatch:n})=>{const r=Object(o.useContext)($l),l=r.openItem,s=r.setOpenItem;return(c.a.createElement("td",null,"divider"!==t?c.a.createElement(te.a,{block:!0,outline:!0,color:"muted",onClick:()=>{s(l===e?void 0:e)}},c.a.createElement(Ie.a,{icon:"cog"})):null,c.a.createElement(Yn.a,{isOpen:"divider"===t||l===e},c.a.createElement(te.a,{block:!0,outline:!0,color:"muted",className:"divider"!==t?"mt-2":"",onClick:()=>n("deleteRow",e)},c.a.createElement(Ie.a,{icon:"trash"})))))};zl.contextTypes={gridDispatch:dn.a.func};const Yl=({data:e,children:t},{gridDispatch:a})=>c.a.createElement(Ka.a,{onClick:()=>a("addRows",[[Object(h.a)({required:!0},e)]]),disabled:void 0===e},t);Yl.contextTypes={gridDispatch:dn.a.func};const Gl=()=>{const e=Object(o.useState)(!1),t=Object(Q.a)(e,2),a=t[0],n=t[1];return(c.a.createElement(za.a,{direction:"down",isOpen:a,toggle:()=>n(!a),className:"w-100"},c.a.createElement(Ya.a,{outline:!0,color:"muted",size:"sm",className:"hover-target"},c.a.createElement(Ie.a,{icon:"plus",fixedWidth:!0}),c.a.createElement(Ie.a,{icon:"caret-down",className:"float-right",weight:"s",style:{position:"relative",top:"3px"}})),c.a.createElement(Ga.a,{className:"p-0 w-100"},c.a.createElement($.a,{noGutters:!0},c.a.createElement(Z.a,{className:"border-right pt-2 pb-3"},c.a.createElement(Ka.a,{header:!0},"Content"),c.a.createElement(Yl,{data:{type:"text"}},"Text ",c.a.createElement("span",{className:"text-muted"},"/ Instructions")),c.a.createElement(Yl,{data:{type:"image"}},"Image"),c.a.createElement(Yl,{data:{type:"divider"}},"Divider"),c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"Advanced"),c.a.createElement(Yl,{data:{type:"html"}},"Raw ",c.a.createElement("code",{className:"text-body"},"HTML"))),c.a.createElement(Z.a,{className:"border-right pt-2 pb-3"},c.a.createElement(Ka.a,{header:!0},"Free-form input"),c.a.createElement(Yl,{data:{type:"input"}},"Single-line"),c.a.createElement(Yl,{data:{type:"textarea"}},"Multi-line"),c.a.createElement(Ka.a,{divider:!0}),c.a.createElement(Ka.a,{header:!0},"Structured input"),c.a.createElement(Yl,{data:{type:"radio",options:[]}},"Multiple choice"),c.a.createElement(Yl,{data:{type:"checkbox",options:[]}},"Check all that apply")),c.a.createElement(Z.a,{className:"pt-2 pb-3"},c.a.createElement(Ka.a,{header:!0},"Ranges"),c.a.createElement(Yl,{data:{type:"slider"}},"Slider"),c.a.createElement(Yl,null,"Visual analogue scale"),c.a.createElement(Yl,{data:{type:"likert",items:[],width:5,anchors:[]}},"Likert scale"))))))};var Kl=({columns:e})=>c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("td",null),c.a.createElement("td",{colSpan:e.length},c.a.createElement(Gl,null)),c.a.createElement("td",null)));const Xl=()=>null,Ql=e=>{let t=e.cellData,a=e.rowIndex,n=Object(Te.a)(e,["cellData","rowIndex"]);return(c.a.createElement(lt.Fieldset,{model:".rows[".concat(a,"][0]")},c.a.createElement(Ul,Object.assign({type:t.type,data:t,rowIndex:a},n))))},Jl=({data:e={}})=>{const t=Object(o.useState)(!1),a=Object(Q.a)(t,2),n=a[0],r=a[1];return(c.a.createElement(Sr.a,{className:"px-0"},c.a.createElement("table",{className:"table grid no-header border-bottom-0 my-0"},c.a.createElement("colgroup",null,c.a.createElement("col",{style:{width:"5%"}}),c.a.createElement("col",{style:{width:"90%"}}),c.a.createElement("col",{style:{width:"5%"}})),c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("div",{style:{width:"40px"}})),c.a.createElement("td",null,c.a.createElement($.a,{form:!0},c.a.createElement(Z.a,null,c.a.createElement(Ln.a,null,c.a.createElement(lt.Control,{model:".submitButtonText",component:at.a,controlProps:{disabled:"hidden"===e.submitButtonPosition},placeholder:"Submit button text",default:"Continue \u2192",type:"text",debounce:300}),c.a.createElement(lt.Control.select,{model:".submitButtonPosition",component:Cr.a,controlProps:{id:"submitButtonPosition",type:"select"}},c.a.createElement("option",{value:"right"},"Show submit button"),c.a.createElement("option",{value:"hidden"},"Hide submit button"))))),c.a.createElement(Yn.a,{isOpen:n},c.a.createElement("hr",null),c.a.createElement("h3",{className:"h6"},"Presentation"),c.a.createElement(ot.a,{row:!0,className:"mt-2"},c.a.createElement(ct.a,{xs:3,for:"width"},"Page width"),c.a.createElement(Z.a,{xs:9},c.a.createElement(Ln.a,null,c.a.createElement(lt.Control.select,{id:"width",model:".width",component:Cr.a,controlProps:{id:"width",type:"select"}},c.a.createElement("option",{value:"m"},"Medium"),c.a.createElement("option",{value:"s"},"Small"),c.a.createElement("option",{value:"l"},"Large"))))))),c.a.createElement("td",null,c.a.createElement(te.a,{block:!0,outline:!0,color:"muted",onClick:()=>r(!n)},c.a.createElement(Ie.a,{icon:"cog"}))))))))},$l=Object(o.createContext)({}),Zl=e=>{const t=Object(o.useState)(void 0),a=Object(Q.a)(t,2),n=a[0],r=a[1];return(c.a.createElement($l.Provider,Object.assign({value:{openItem:n,setOpenItem:r}},e)))};var eo=class extends o.Component{constructor(e){super(e),this.formDispatch=()=>console.log("invalid dispatch"),this.state={openItem:void 0},this.setOpenItem=this.setOpenItem.bind(this),this.renderGridCell=this.renderGridCell.bind(this),this.renderRightColumn=this.renderRightColumn.bind(this)}setOpenItem(e){this.state.openItem===e?this.setState({openItem:void 0}):this.setState({openItem:e})}renderGridCell(e){return c.a.createElement(Ql,Object.assign({isExpanded:e.rowIndex===this.state.openItem},e))}renderRightColumn(e){return c.a.createElement(zl,Object.assign({onClickOptions:this.setOpenItem},e))}render(){var e;const t=this.props,a=t.id,n=t.data;return(c.a.createElement(ve,{title:"Content",wrapContent:!1},c.a.createElement(Tr,{id:a,data:n,keys:["items","submitButtonText","submitButtonPosition","width"],getDispatch:e=>this.formDispatch=e},c.a.createElement(Zl,null,c.a.createElement(wr,{model:".items",HeaderContent:Xl,BodyContent:this.renderGridCell,LeftColumn:ql,RightColumn:this.renderRightColumn,Footer:Kl,columnWidths:[90],columns:["items"],showHeader:!1,defaultRow:[{type:""}],data:(null===(e=n.items)||void 0===e?void 0:e.rows)||[],formDispatch:e=>this.formDispatch(e),className:"mb-0 border-bottom-0"})),c.a.createElement(Jl,{data:n}))))}};class to extends o.Component{getChildContext(){return{id:this.props.id,type:this.props.type}}render(){const e=this.props,t=e.id,a=e.type,n=e.tab,r=e.data;if("welcome"===t)return c.a.createElement(er,null);if(void 0===a)return c.a.createElement(tr,null);const l=((e,t)=>{switch(t){case"Content":switch(e){case"lab.canvas.Screen":return sl;case"lab.html.Screen":case"lab.html.Form":return il;case"lab.canvas.Frame":case"lab.html.Frame":return ml;case"lab.html.Questionnaire":case"lab.html.Page":return eo;case"lab.flow.Loop":return kl;case"lab.flow.Sequence":return Cl;default:throw new Error("Unknown component type, can't show content")}case"Behavior":return Pr;case"Scripts":return Ar;case"Files":return Br;case"Plugins":return Jr;case"Parameters":return rl;case"More":return ll;default:return({id:e,data:t})=>c.a.createElement("div",null,"id: ",e,", type: ",t.type,", tab: ",t._tab)}})(a,n);return(c.a.createElement(l,{id:t,data:r}))}}to.childContextTypes={id:dn.a.oneOfType([dn.a.string,dn.a.number]),type:dn.a.string};var ao=Object(m.connect)(e=>{const t=e.componentDetail.viewProps.id,a=e.components[t]?e.components[t].type:void 0,n=e.components[t]?x(e.components[t]._tab,a):void 0,r=e.components[t]?e.components[t]:{};return{key:"".concat(t,"-").concat(n),id:t,type:a,tab:n,data:r}})(to);class no extends o.Component{constructor(e){super(e),this.defaultState={error:null,errorInfo:{}},this.state=Object(h.a)({},this.defaultState)}componentDidCatch(e,t){X.b(a=>{a.setExtras(t),a.setTag("scope","crash"),a.setLevel("fatal");const n=X.a(e);this.setState({error:e,errorInfo:t,eventId:n})})}resetError(){this.setState(Object(h.a)({},this.defaultState))}render(){return this.state.error?c.a.createElement(Ce,{error:this.state.error,errorInfo:this.state.errorInfo,eventId:this.state.eventId,reset:()=>this.resetError()}):c.a.createElement(c.a.Fragment,null,c.a.createElement(Fa,null),c.a.createElement(Sa,null),c.a.createElement(je,{sidebar:c.a.createElement(Cn,null),footer:c.a.createElement(Rn,null)},c.a.createElement(zn,null),c.a.createElement(ao,null)))}}var ro=no,lo=(a(781),a(851)),oo=function(){var e=Object(l.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("serviceWorker"in navigator)){e.next=20;break}return a=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1)+"api/",e.next=4,navigator.serviceWorker.getRegistrations();case 4:return n=e.sent,e.next=7,Promise.all(n.map(e=>e.unregister()));case 7:return e.prev=7,e.next=10,navigator.serviceWorker.register("/api/worker.js",{scope:a});case 10:return console.log("Preview worker registered successfully at ".concat(a)),e.next=13,Ra();case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(7),e.t0;case 18:e.next=21;break;case 20:throw new Error("Service workers not available");case 21:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t){return e.apply(this,arguments)}}();const co=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function so(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="".concat("","/service-worker.js");co?(!function(e,t){fetch(e).then(a=>{const n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):io(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):io(t,e)})}}function io(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_FA:"free"}).REACT_APP_SENTRY_DSN&&lo.a({dsn:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_FA:"free"}).REACT_APP_SENTRY_DSN,release:"@lab.js/builder@".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_FA:"free"}).REACT_APP_SENTRY_RELEASE)}),Object(l.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:return t=e.sent,St(t),e.next=6,U(t);case 6:return e.prev=6,e.next=9,oo(t);case 9:a=!0,e.next=17;break;case 12:e.prev=12,e.t0=e.catch(6),console.log("Error during preview worker registration:",e.t0),a=!1,"Service workers not available"!==e.t0.message&&X.b(t=>{t.setTag("scope","worker"),X.a(e.t0)});case 17:return e.prev=17,n=Object(Y.DragDropContext)(K.a)(ro),i.a.render(c.a.createElement(_a,{value:{previewActive:a}},c.a.createElement(m.Provider,{store:t},c.a.createElement(n,null))),document.getElementById("root")),so(),e.finish(17);case 22:case"end":return e.stop()}}),e,null,[[6,12,17,22]])})))()}},[[439,1,2]]]);
//# sourceMappingURL=main.8e3fa3d3.chunk.js.map